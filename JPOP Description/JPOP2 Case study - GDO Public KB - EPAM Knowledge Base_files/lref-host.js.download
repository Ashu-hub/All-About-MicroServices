!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";var i=Object.prototype.hasOwnProperty,r=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),a=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(n[i]=e[i]);return n};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],i=0;i<t.length;++i)for(var o=t[i],a=o.obj[o.prop],s=Object.keys(a),d=0;d<s.length;++d){var c=s[d],l=a[c];"object"==typeof l&&null!==l&&-1===n.indexOf(l)&&(t.push({obj:a,prop:c}),n.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),n=t.obj[t.prop];if(r(n)){for(var i=[],o=0;o<n.length;++o)void 0!==n[o]&&i.push(n[o]);t.obj[t.prop]=i}}}(t),e},decode:function(e,t,n){var i=e.replace(/\+/g," ");if("iso-8859-1"===n)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(e){return i}},encode:function(e,t,n){if(0===e.length)return e;var i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var r="",a=0;a<i.length;++a){var s=i.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?r+=i.charAt(a):s<128?r+=o[s]:s<2048?r+=o[192|s>>6]+o[128|63&s]:s<55296||s>=57344?r+=o[224|s>>12]+o[128|s>>6&63]+o[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&i.charCodeAt(a)),r+=o[240|s>>18]+o[128|s>>12&63]+o[128|s>>6&63]+o[128|63&s])}return r},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,n,o){if(!n)return t;if("object"!=typeof n){if(r(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(o&&(o.plainObjects||o.allowPrototypes)||!i.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);var s=t;return r(t)&&!r(n)&&(s=a(t,o)),r(t)&&r(n)?(n.forEach((function(n,r){if(i.call(t,r)){var a=t[r];a&&"object"==typeof a&&n&&"object"==typeof n?t[r]=e(a,n,o):t.push(n)}else t[r]=n})),t):Object.keys(n).reduce((function(t,r){var a=n[r];return i.call(t,r)?t[r]=e(t[r],a,o):t[r]=a,t}),s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17);t.ValueUtils=i.ValueUtils},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=n(4),a=function(){function e(){}return e.getVersion=function(){return AJS.Meta.get("version-number")},e.renderContext=function(e,t){return e.replace(/{([a-zA-Z._]+)}/gi,(function(e,n){return t[n]||""}))},e.getPlatform=function(){var e=AJS.$("body").attr("id");switch(e){case"com-atlassian-confluence":return o.Platform.CONFLUENCE;case"jira":return o.Platform.JIRA;default:return void console.error("Unsupported platform id "+e)}},e.getContextPath=function(){return AJS.Meta.get("context-path")},e.getBaseUrl=function(){var t=r.UrlUtil.parse(window.location.href);return t.path=e.getContextPath(),t.query={},t.hash="",r.UrlUtil.stringify(t)},e.resolveDescriptorUrls=function(t){var n=t.modules||{},r=(n.webPanels||[]).map((function(n){return e.resolveModuleUrl(n,t)})),o=(n.adminPages||[]).map((function(n){return e.resolveModuleUrl(n,t)})),a=(n.dialogs||[]).map((function(n){return e.resolveModuleUrl(n,t)})),s=(n.dynamicContentMacros||[]).map((function(n){var i=e.resolveModuleUrl(n,t);return n.editor&&(i.editor=e.resolveModuleUrl(n.editor,t)),i}));return i(i({},t),{modules:{adminPages:o,webPanels:r,dynamicContentMacros:s,dialogs:a}})},e.resolveModuleUrl=function(t,n){if(!t.url)throw new Error("Module url must be provided");if(!r.UrlUtil.isPathRelative(t.url))return t;if(!n||!n.baseUrl||null===r.UrlUtil.isPathRelative(n.baseUrl))return i(i({},t),{url:e.getBaseUrl()+"/"+r.UrlUtil.removeLeadingSlash(t.url)});if(r.UrlUtil.isPathRelative(n.baseUrl)){var o=r.UrlUtil.join(n.baseUrl,t.url);return i(i({},t),{url:e.getBaseUrl()+"/"+r.UrlUtil.removeLeadingSlash(o)})}return i(i({},t),{url:r.UrlUtil.removeTrailingSlash(n.baseUrl)+"/"+r.UrlUtil.removeLeadingSlash(t.url)})},e.resolveModuleContext=function(t,n){if(!t)return t;var r=Object.keys(n).reduce((function(e,t){var r;return i(i({},e),((r={})[t]="url"===t&&n[t].indexOf(" ")>-1?encodeURIComponent(encodeURI(n[t])):encodeURIComponent(n[t]),r))}),{});return i(i({},t),{url:e.renderContext(t.url,r)})},e}();t.HostUtils=a},function(e,t,n){"use strict";var i=String.prototype.replace,r=/%20/g,o=n(0),a={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports=o.assign({default:a.RFC3986,formatters:{RFC1738:function(e){return i.call(e,r,"+")},RFC3986:function(e){return String(e)}}},a)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.JIRA="JIRA",e.CONFLUENCE="CONFLUENCE"}(t.Platform||(t.Platform={}))},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(a=i,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(d," */")),o=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot).concat(e," */")}));return[n].concat(o).concat([r]).join("\n")}var a,s,d;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i=0;i<e.length;i++){var r=[].concat(e[i]);n&&(r[2]?r[2]="".concat(n," and ").concat(r[2]):r[2]=n),t.push(r)}},t}},function(e,t,n){"use strict";var i,r={},o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}();function s(e,t){for(var n=[],i={},r=0;r<e.length;r++){var o=e[r],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}function d(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=r[i.id],a=0;if(o){for(o.refs++;a<o.parts.length;a++)o.parts[a](i.parts[a]);for(;a<i.parts.length;a++)o.parts.push(m(i.parts[a],t))}else{for(var s=[];a<i.parts.length;a++)s.push(m(i.parts[a],t));r[i.id]={id:i.id,refs:1,parts:s}}}}function c(e){var t=document.createElement("style");if(void 0===e.attributes.nonce){var i=n.nc;i&&(e.attributes.nonce=i)}if(Object.keys(e.attributes).forEach((function(n){t.setAttribute(n,e.attributes[n])})),"function"==typeof e.insert)e.insert(t);else{var r=a(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var l,u=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function f(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function p(e,t,n){var i=n.css,r=n.media,o=n.sourceMap;if(r&&e.setAttribute("media",r),o&&btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var g=null,h=0;function m(e,t){var n,i,r;if(t.singleton){var o=h++;n=g||(g=c(t)),i=f.bind(null,n,o,!1),r=f.bind(null,n,o,!0)}else n=c(t),i=p.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=s(e,t);return d(n,t),function(e){for(var i=[],o=0;o<n.length;o++){var a=n[o],c=r[a.id];c&&(c.refs--,i.push(c))}e&&d(s(e,t),t);for(var l=0;l<i.length;l++){var u=i[l];if(0===u.refs){for(var f=0;f<u.parts.length;f++)u.parts[f]();delete r[u.id]}}}}},function(e,t,n){"use strict";n(8).LrefAddon.initialize("onedrive-confluence")},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(18),a=function(){function e(){}return e.initialize=function(t){if(window._AP||(window._AP={}),window._AP.dialogModules||(window._AP.dialogModules={}),window.lrefDescriptor&&window.lrefDescriptor[t]){n(21),n(23),e.connectHost=n(25),e.connectHost.defineModule("confluence",e.getConfluenceModule());var i=function(){var n=r.HostUtils.getPlatform();return void 0===n?void 0:e.documentReadyHandler(n,t)};AJS.$(document).ready(i),AJS.bind("init.rte",(function(){var n=r.HostUtils.getPlatform();return void 0===n?void 0:e.initRichTextEditorHandler(n,t)})),window.JIRA&&window.JIRA.bind&&window.JIRA.Events&&window.JIRA.bind(window.JIRA.Events.NEW_CONTENT_ADDED,i)}else console.error("Descriptor for '"+t+"' not found.")},e.resolveDescriptor=function(t,n){if(!e.descriptor){if(!window.lrefDescriptor||!window.lrefDescriptor[n])throw new Error("Descriptor for '"+n+"' not found.");var i=r.HostUtils.resolveDescriptorUrls(window.lrefDescriptor[n]);e.descriptor=o.getResolvedDescriptorForNewConfluenceVersions(t,i)}},e.documentReadyHandler=function(t,n){if(e.resolveDescriptor(t,n),!e.descriptor.modules)throw new Error("'Modules' section not found.");if(!window._AP||!window._AP.dialogModules)throw new Error("_AP.dialogModules improperly configured.");window._AP.dialogModules[e.descriptor.key]={};var i=e.descriptor.modules;i.dialogs&&i.dialogs.forEach((function(t){return e.initializeDialog(t)})),i.webPanels&&i.webPanels.forEach((function(t){return e.initializeModule(t)})),i.adminPages&&i.adminPages.forEach((function(t){return e.initializeModule(t)})),i.dynamicContentMacros&&i.dynamicContentMacros.forEach((function(t){e.initDynamicContentMacroEditor(t),e.initializeModule(t)})),e.connectHost.registerContentResolver.resolveByExtension((function(e){return AJS.$.Deferred((function(t){var n=window._AP.dialogModules[e.addon_key][e.key];return t.resolve(n)})).promise()}))},e.initRichTextEditorHandler=function(t,n){(e.resolveDescriptor(t,n),e.descriptor.modules)&&(e.descriptor.modules.dynamicContentMacros||[]).forEach((function(t){return e.initDynamicContentMacro(t)}))},e.initializeDialog=function(t){if(e.descriptor){if(!window._AP||!window._AP.dialogModules)throw new Error("_AP.dialogModules improperly configured.");if(!window._AP.dialogModules[e.descriptor.key][t.key]){var n=r.HostUtils.resolveModuleUrl(t,e.descriptor);window._AP.dialogModules[e.descriptor.key][t.key]=n}}},e.initDynamicContentMacroEditor=function(t){if(t.editor){var n={url:t.editor.url,options:{width:t.editor.width,height:t.editor.height,chrome:!0,cancelText:"Cancel",submitText:"Select"}};e.initializeDialog(i(i({},n),{key:e.getCreateEditorDialogKey(t),options:i(i({},n.options),{header:t.editor.insertTitle})})),e.initializeDialog(i(i({},n),{key:e.getEditEditorDialogKey(t),options:i(i({},n.options),{header:t.editor.editTitle})}))}},e.initializeModule=function(t){e.descriptor&&e.getUninitializedModuleElements(t).each((function(n,i){var o=window.AJS.$(i),a=o.data("context"),s=r.HostUtils.resolveModuleContext(t,a),d={addon_key:e.descriptor.key,key:s.key,url:s.url,options:{hostFrameOffset:1}},c=e.connectHost.create(d,(function(){return{}}));o.append(c),o.removeClass("uninitialized_lref_module")}))},e.initDynamicContentMacro=function(t){window.AJS.MacroBrowser.setMacroJsOverride(t.key,{opener:function(n){if(!t.editor)throw new Error("Editor not found in '"+e.descriptor.key+"-"+t.key+"'.");e.macroParams=n.params,e.macroName=t.key;var i={key:void 0===e.macroParams?e.getCreateEditorDialogKey(t):e.getEditEditorDialogKey(t),addon_key:e.descriptor.key};e.connectHost.dialog.create(i)}})},e.getUninitializedModuleElements=function(t){var n='[data-addon-key="'+e.descriptor.key+'"]',i='[data-module-key="'+t.key+'"]';return AJS.$(".uninitialized_lref_module"+n+i)},e.getConfluenceModule=function(){return{saveMacro:function(t){return window.tinyMCE.confluence.macrobrowser.macroBrowserComplete({name:e.macroName,params:t})},closeMacroEditor:function(){return e.connectHost.dialog.close()},getMacroData:function(t){return t(e.macroParams)}}},e.getCreateEditorDialogKey=function(e){return"create_"+e.key},e.getEditEditorDialogKey=function(e){return"edit_"+e.key},e}();t.LrefAddon=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2);t.HostUtils=i.HostUtils},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11);t.UrlUtil=i.UrlUtil},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(12)),o=i(n(15)),a=n(1),s=function(){function e(){}return e.qsParse=function(e){return r.default.parse(e)},e.qsStringify=function(e,t){return r.default.stringify(e,t)},e.getFixedHost=function(e){return a.ValueUtils.endsWith(e,":80")?e.slice(0,-3):a.ValueUtils.endsWith(e,":443")?e.slice(0,-4):e},e.parse=function(t){if(!t)return null;var n=document.createElement("a");return n.href=t,n.host?{host:e.getFixedHost(n.host),search:n.search,protocol:n.protocol,query:e.qsParse(n.search.substr(1)),hash:a.ValueUtils.removeLeadingChar(n.hash,"#"),path:n.pathname,url:t}:null},e.stringify=function(t){var n=t.protocol+"//"+t.host+"/"+e.removeLeadingSlash(t.path);return t.query&&Object.keys(t.query).length&&(n=n+"?"+r.default.stringify(t.query)),t.hash&&(n=n+"#"+a.ValueUtils.removeLeadingChar(t.hash,"#")),n},e.join=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.join.apply(o.default,e)},e.removeTrailingSlash=function(e){return a.ValueUtils.removeTrailingChar(e,"/")},e.removeLeadingSlash=function(e){return a.ValueUtils.removeLeadingChar(e,"/")},e.isDomainValid=function(t,n){var i=e.parse(t);return!!i&&new RegExp("^(\\S+\\.)*"+n.split(".").join("\\.")+"$").test(i.host)},e.isPathRelative=function(e){return e?!e.match("^https?://.*")&&(!!e.match("^/.*")||null):null},e.removeLastUrlPart=function(t){var n=e.removeTrailingSlash(t).lastIndexOf("/");return-1===n?t:t.substring(0,n+1)},e.encodeURIComponent=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return("%"+e.charCodeAt(0).toString(16)).toUpperCase()}))},e.decodeURIComponent=function(e){return decodeURIComponent(e)},e}();t.UrlUtil=s},function(e,t,n){"use strict";var i=n(13),r=n(14),o=n(3);e.exports={formats:o,parse:r,stringify:i}},function(e,t,n){"use strict";var i=n(0),r=n(3),o=Object.prototype.hasOwnProperty,a={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},s=Array.isArray,d=Array.prototype.push,c=function(e,t){d.apply(e,s(t)?t:[t])},l=Date.prototype.toISOString,u=r.default,f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:u,formatter:r.formatters[u],indices:!1,serializeDate:function(e){return l.call(e)},skipNulls:!1,strictNullHandling:!1},p=function e(t,n,r,o,a,d,l,u,p,g,h,m,v){var y,b=t;if("function"==typeof l?b=l(n,b):b instanceof Date?b=g(b):"comma"===r&&s(b)&&(b=b.join(",")),null===b){if(o)return d&&!m?d(n,f.encoder,v,"key"):n;b=""}if("string"==typeof(y=b)||"number"==typeof y||"boolean"==typeof y||"symbol"==typeof y||"bigint"==typeof y||i.isBuffer(b))return d?[h(m?n:d(n,f.encoder,v,"key"))+"="+h(d(b,f.encoder,v,"value"))]:[h(n)+"="+h(String(b))];var x,w=[];if(void 0===b)return w;if(s(l))x=l;else{var _=Object.keys(b);x=u?_.sort(u):_}for(var k=0;k<x.length;++k){var E=x[k];a&&null===b[E]||(s(b)?c(w,e(b[E],"function"==typeof r?r(n,E):n,r,o,a,d,l,u,p,g,h,m,v)):c(w,e(b[E],n+(p?"."+E:"["+E+"]"),r,o,a,d,l,u,p,g,h,m,v)))}return w};e.exports=function(e,t){var n,i=e,d=function(e){if(!e)return f;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=r.default;if(void 0!==e.format){if(!o.call(r.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var i=r.formatters[n],a=f.filter;return("function"==typeof e.filter||s(e.filter))&&(a=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:void 0===e.allowDots?f.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,delimiter:void 0===e.delimiter?f.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:f.encode,encoder:"function"==typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:a,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}}(t);"function"==typeof d.filter?i=(0,d.filter)("",i):s(d.filter)&&(n=d.filter);var l,u=[];if("object"!=typeof i||null===i)return"";l=t&&t.arrayFormat in a?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var g=a[l];n||(n=Object.keys(i)),d.sort&&n.sort(d.sort);for(var h=0;h<n.length;++h){var m=n[h];d.skipNulls&&null===i[m]||c(u,p(i[m],m,g,d.strictNullHandling,d.skipNulls,d.encode?d.encoder:null,d.filter,d.sort,d.allowDots,d.serializeDate,d.formatter,d.encodeValuesOnly,d.charset))}var v=u.join(d.delimiter),y=!0===d.addQueryPrefix?"?":"";return d.charsetSentinel&&("iso-8859-1"===d.charset?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),v.length>0?y+v:""}},function(e,t,n){"use strict";var i=n(0),r=Object.prototype.hasOwnProperty,o=Array.isArray,a={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},d=function(e,t,n){if(e){var i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,a=n.depth>0&&/(\[[^[\]]*])/.exec(i),s=a?i.slice(0,a.index):i,d=[];if(s){if(!n.plainObjects&&r.call(Object.prototype,s)&&!n.allowPrototypes)return;d.push(s)}for(var c=0;n.depth>0&&null!==(a=o.exec(i))&&c<n.depth;){if(c+=1,!n.plainObjects&&r.call(Object.prototype,a[1].slice(1,-1))&&!n.allowPrototypes)return;d.push(a[1])}return a&&d.push("["+i.slice(a.index)+"]"),function(e,t,n){for(var i=t,r=e.length-1;r>=0;--r){var o,a=e[r];if("[]"===a&&n.parseArrays)o=[].concat(i);else{o=n.plainObjects?Object.create(null):{};var s="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,d=parseInt(s,10);n.parseArrays||""!==s?!isNaN(d)&&a!==s&&String(d)===s&&d>=0&&n.parseArrays&&d<=n.arrayLimit?(o=[])[d]=i:o[s]=i:o={0:i}}i=o}return i}(d,t,n)}};e.exports=function(e,t){var n=function(e){if(!e)return a;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new Error("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset;return{allowDots:void 0===e.allowDots?a.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||i.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return n.plainObjects?Object.create(null):{};for(var c="string"==typeof e?function(e,t){var n,d={},c=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,u=c.split(t.delimiter,l),f=-1,p=t.charset;if(t.charsetSentinel)for(n=0;n<u.length;++n)0===u[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[n]?p="utf-8":"utf8=%26%2310003%3B"===u[n]&&(p="iso-8859-1"),f=n,n=u.length);for(n=0;n<u.length;++n)if(n!==f){var g,h,m=u[n],v=m.indexOf("]="),y=-1===v?m.indexOf("="):v+1;-1===y?(g=t.decoder(m,a.decoder,p,"key"),h=t.strictNullHandling?null:""):(g=t.decoder(m.slice(0,y),a.decoder,p,"key"),h=t.decoder(m.slice(y+1),a.decoder,p,"value")),h&&t.interpretNumericEntities&&"iso-8859-1"===p&&(h=s(h)),h&&"string"==typeof h&&t.comma&&h.indexOf(",")>-1&&(h=h.split(",")),m.indexOf("[]=")>-1&&(h=o(h)?[h]:h),r.call(d,g)?d[g]=i.combine(d[g],h):d[g]=h}return d}(e,n):e,l=n.plainObjects?Object.create(null):{},u=Object.keys(c),f=0;f<u.length;++f){var p=u[f],g=d(p,c[p],n);l=i.merge(l,g,n)}return i.compact(l)}},function(e,t,n){(function(e){function n(e,t){for(var n=0,i=e.length-1;i>=0;i--){var r=e[i];"."===r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,r="/"===a.charAt(0))}return(r?"/":"")+(t=n(i(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var o=t.isAbsolute(e),a="/"===r(e,-1);return(e=n(i(e.split("/"),(function(e){return!!e})),!o).join("/"))||o||(e="."),e&&a&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var r=i(e.split("/")),o=i(n.split("/")),a=Math.min(r.length,o.length),s=a,d=0;d<a;d++)if(r[d]!==o[d]){s=d;break}var c=[];for(d=s;d<r.length;d++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,i=-1,r=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!r){i=o;break}}else r=!1;return-1===i?n?"/":".":n&&1===i?"/":e.slice(0,i)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,i=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){n=t+1;break}}else-1===i&&(r=!1,i=t+1);return-1===i?"":e.slice(n,i)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,i=-1,r=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===i&&(r=!1,i=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!r){n=a+1;break}}return-1===t||-1===i||0===o||1===o&&t===i-1&&t===n+1?"":e.slice(t,i)};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(16))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var d,c=[],l=!1,u=-1;function f(){l&&d&&(l=!1,d.length?c=d.concat(c):u=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(d=c,c=[];++u<t;)d&&d[u].run();u=-1,t=c.length}d=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new g(e,t)),1!==c.length||l||s(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.parseIntOrUndefined=function(e,t){var n=parseInt(e,t);return Number.isNaN(n)?void 0:n},e.startsWith=function(e,t){return e.substring(0,t.length)===t},e.endsWith=function(e,t){return e.substring(e.length-t.length,e.length)===t},e.removeTrailingChar=function(t,n){var i=e.escapeForRegExp(n);return t.replace(new RegExp(i+"$","g"),"")},e.removeLeadingChar=function(t,n){var i=e.escapeForRegExp(n);return t.replace(new RegExp("^"+i+"+","g"),"")},e.escapeForRegExp=function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},e.getBooleanValue=function(e,t){return void 0===t?e:t},e}();t.ValueUtils=i},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(19),a=n(2),s=n(4);t.getResolvedDescriptorForNewConfluenceVersions=function(e,t){var n=a.HostUtils.getVersion();if(e!==s.Platform.CONFLUENCE||!o.VersionUtils.isSameOrAfter(n,"6.7"))return t;var d=t.modules||{},c=(d.dynamicContentMacros||[]).map((function(e){return i(i({},e),{editor:e.editor?i(i({},e.editor),{height:(t=e.editor.height,"string"!=typeof t?t+104+"px":r.ValueUtils.endsWith(t,"px")?parseFloat(t)+104+"px":t)}):e.editor});var t}));return i(i({},t),{modules:i(i({},d),{dynamicContentMacros:c})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(20);t.VersionUtils=i.VersionUtils},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(){}return e.isSameOrAfter=function(t,n){var i=e.numerify(n),r=e.numerify(t);return null===i||null===r?null:r>=i},e.contains=function(e,t){return i.ValueUtils.startsWith(e,t)},e.containsInList=function(t,n){return n.filter((function(n){return e.contains(t,n)})).length>0},e.getMajor=function(e){var t=e.split("-"),n=t[0],i=(t[1],n.split("."));if(3!==i.length)throw new Error("Incorrect product minor version '"+n+"'");return i.slice(0,-1).join(".")},e.numerify=function(e){var t=e.match(/\d+/g);if(!t||!t.length)return null;var n=t.map(Number),i=n[0],r=n[1],o=n[2],a=n[3];return i?100*i+10*(r||0)+(o||0)+(a||0)/100:null},e}();t.VersionUtils=r},function(e,t,n){var i=n(22);"string"==typeof i&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(6)(i,r);i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(5);(e.exports=i(!1)).push([e.i,".ap-stats {\n    padding: 0px 10px;\n    background-color: #f5f5f5;\n}\n\n.ap-dialog-container .ap-container,\n.ap-aui-dialog2 div {\n    height: 100%;\n}\n\n.ap-aui-dialog2 div.ap-stats {\n    height: auto;\n    position: absolute; /* go over the top of the bottom bar when visible */\n}\n\n/* add new aui dialog size of fullscreen */\n.ap-aui-dialog2.aui-dialog2-fullscreen {\n    top: 0;\n}\n\n/* add new aui dialog size of maximum */\n.ap-aui-dialog2.aui-dialog2-maximum {\n    top: 0;\n    height: 100%;\n}\n.ap-aui-dialog2.aui-dialog2-maximum .aui-dialog2-content {\n    height: 100%;\n}\n\n.ap-aui-dialog2 .aui-dialog2-content {\n  padding:0;\n\n    /* in chrome'd dialogs - fixes scrollbars added by iframes with scrollbars pushing the width out */\n    overflow:hidden;\n\n    /* in safari, chromeless dialogs become invisible, because apparently GPU FTW */\n    -webkit-transform: translatez(0);\n    will-change: opacity, visibility;\n\n    display: flex;\n    flex-direction: column;\n}\n\n.ap-aui-dialog2 iframe {\n    display:block;\n}\n\n.ap-aui-dialog2.aui-dialog2-chromeless .aui-dialog2-content {\n    background-color:transparent;\n\n    /* Override the aui selector that assumes the last-child is the footer */\n    border-radius: 0;\n}\n\n.ap-aui-dialog2 .ap-status-indicator {\n  padding: 5px 10px;\n  background: transparent;\n  position: absolute;\n  top: 10px;\n  width: 100%;\n}\n\n.ap-aui-dialog2.aui-dialog2-maximum .ap-status-indicator,\n.ap-aui-dialog2.aui-dialog2-chromeless .ap-status-indicator {\n  display: none;\n}\n\n.ap-aui-dialog2 .ap-stats {\n  display: block;\n}\n\n/* header controls */\n/*\n   These styles lifted from the file viewer. We could conceivably define a separate component 'header-controls'\n   in AUI that contains its own styles, but adding to AUI is out of scope for the current task.\n\n   Given that plugin devs won't be working directly with these CSS rules, we have some flexibility to refactor\n   these internals later.\n */\n\n.ap-header-controls.aui-dialog2 .aui-dialog2-header {\n    background-color: #000;\n    border-radius: 0;\n    height: 50px;\n    margin-top: 0;\n    padding: 0 0 0 20px;\n}\n\n.ap-header-controls .header-title-container {\n    max-width: 70%;\n    display: block;\n    float: left;\n    height: 50px\n}\n\n.ap-header-controls .header-title-container div {\n    color: #fff;\n    line-height: 50px;\n    white-space: nowrap;\n    overflow: hidden\n}\n\n.ap-header-controls .header-control-panel {\n    padding-left: 0;\n    text-align: right;\n    float: right;\n    max-width: 30%;\n    display: block;\n    height: 50px\n}\n\n.ap-header-controls .header-control-panel > span {\n    display: inline-block\n}\n\n.ap-header-controls .header-control-panel .aui-button {\n    background-color: #000;  /* Override blue for primary controls*/\n    background-position: center;\n    background-repeat: no-repeat;\n    border-left: 1px solid #333;\n    border-radius: 0px;\n    height: 50px;\n    float: left;\n    margin-left: 0;  /* overrides AUI style of 10px */\n    text-align: left;\n    text-indent: -999em;\n    width: 50px\n}\n\n/* Pads the button icons provided by the AUI Icon font */\n.ap-header-controls .header-control-panel .aui-icon-small:before {\n    color: #fff;\n    margin-left: 16px;\n}\n\n/* Reduce the height of the content div to allow for the height of the header bar */\n.ap-header-controls .aui-dialog2-content {\n    max-height: calc(100% - 50px);\n}\n.ac-flag-actions a {\n  margin-right: 10px;\n  /* whole flag text appears on 1 line */\n  display: inline-block;\n}\n.ap-status-indicator {\n  padding-top: 5px;\n  font-size: 12px;\n  line-height: 1.42857142857143;\n}\n\n.ap-status-indicator small {\n  color: #707070;\n}\n\n.ap-loading, .ap-load-timeout {\n  padding-left: 4px;\n}\n\n.ap-link-disabled, .ap-link-disabled:hover, .ap-link-disabled:visited, .ap-link-disabled:focus {\n  color: gray !important;\n  text-decoration: none;\n}\n\n.ap-iframe-container iframe {\n  border: 0;\n}\n\n.ap-iframe-container iframe.full-size-general-page {\n  border-bottom: 1px solid #ccc;\n}\n.ap-iframe-container iframe.full-size-general-page-no-footer {\n  border:none;\n}\n\n.ap-status-indicator .small-spinner {\n  width: 20px;\n  height: 20px;\n  float: left;\n  margin-right: 4px;\n}\n\n.ap-iframe-container {\n  line-height: 0;\n  margin: 0;\n  padding: 0;\n  font-size: 0;\n}\n\n@-webkit-keyframes fadeInConnectSpinner { from { opacity: 0; } to { opacity: 1; } }\n@-moz-keyframes fadeInConnectSpinner { from { opacity: 0; } to { opacity: 1; } }\n@-o-keyframes fadeInConnectSpinner { from { opacity: 0; } to { opacity: 1; } }\n@keyframes fadeInConnectSpinner { from { opacity: 0; } to { opacity: 1; } }\n\n.ap-status-indicator {\n  opacity: 0;\n  animation: fadeInConnectSpinner 0.5s ease-in;\n  animation-delay: 1s;\n  animation-fill-mode: forwards;\n}\n\n.connect-resolve-error {\n  font-size: 12px;\n  line-height: 1.42857142857143;  \n}\n#ac-message-container {\n\ttop: 20px;\n\tleft: 50%;\n\tmax-width: 600px;\n\tposition: fixed;\n\tz-index: 4000;\n}\n\n.ap-aui-message {\n  font-size: 14px;\n  margin: 10px;\n}",""])},function(e,t,n){var i=n(24);"string"==typeof i&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(6)(i,r);i.locals&&(e.exports=i.locals)},function(e,t,n){var i=n(5);(e.exports=i(!1)).push([e.i,".ap-container .ap-content {\n    font-size: 0;\n}\n\n.ap-content {\n    line-height: 0;\n    margin: 0;\n    padding: 0;\n    font-size: 0;\n}\n\n.ap-inline div {\n    display: inline-block;\n}\n\n.ap-aui-dialog2.aui-dialog2-maximum .aui-dialog2-content {\n    height: 100%;\n}\n\n.aui-dialog2 .aui-dialog2-content {\n    max-height: 100%;\n}\n\n.aui-dialog2.aui-dialog2-chromeless {\n    background-color: transparent;\n}\n",""])},function(e,t,n){e.exports=function(){"use strict";var e=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t};function t(){}function n(){n.init.call(this)}function i(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function r(e,t,n){if(t)e.call(n);else for(var i=e.length,r=f(e,i),o=0;o<i;++o)r[o].call(n)}function o(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,o=f(e,r),a=0;a<r;++a)o[a].call(n,i)}function a(e,t,n,i,r){if(t)e.call(n,i,r);else for(var o=e.length,a=f(e,o),s=0;s<o;++s)a[s].call(n,i,r)}function s(e,t,n,i,r,o){if(t)e.call(n,i,r,o);else for(var a=e.length,s=f(e,a),d=0;d<a;++d)s[d].call(n,i,r,o)}function d(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,o=f(e,r),a=0;a<r;++a)o[a].apply(n,i)}function c(e,n,r,o){var a,s,d,c;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",n,r.listener?r.listener:r),s=e._events),d=s[n]):(s=e._events=new t,e._eventsCount=0),d){if("function"==typeof d?d=s[n]=o?[r,d]:[d,r]:o?d.unshift(r):d.push(r),!d.warned&&(a=i(e))&&a>0&&d.length>a){d.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+n+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=n,l.count=d.length,c=l,"function"==typeof console.warn?console.warn(c):console.log(c)}}else d=s[n]=r,++e._eventsCount;return e}function l(e,t,n){var i=!1;function r(){e.removeListener(t,r),i||(i=!0,n.apply(e,arguments))}return r.listener=n,r}function u(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function f(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}t.prototype=Object.create(null),n.EventEmitter=n,n.usingDomains=!1,n.prototype.domain=void 0,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.init=function(){this.domain=null,n.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new t,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return i(this)},n.prototype.emit=function(e){var t,n,i,c,l,u,f,p="error"===e;if(u=this._events)p=p&&null==u.error;else if(!p)return!1;if(f=this.domain,p){if(t=arguments[1],!f){if(t instanceof Error)throw t;var g=new Error('Uncaught, unspecified "error" event. ('+t+")");throw g.context=t,g}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=f,t.domainThrown=!1,f.emit("error",t),!1}if(!(n=u[e]))return!1;var h="function"==typeof n;switch(i=arguments.length){case 1:r(n,h,this);break;case 2:o(n,h,this,arguments[1]);break;case 3:a(n,h,this,arguments[1],arguments[2]);break;case 4:s(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(c=new Array(i-1),l=1;l<i;l++)c[l-1]=arguments[l];d(n,h,this,c)}return!0},n.prototype.addListener=function(e,t){return c(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return c(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,l(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,l(this,e,t)),this},n.prototype.removeListener=function(e,n){var i,r,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(i=r[e]))return this;if(i===n||i.listener&&i.listener===n)0==--this._eventsCount?this._events=new t:(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if("function"!=typeof i){for(o=-1,a=i.length;a-- >0;)if(i[a]===n||i[a].listener&&i[a].listener===n){s=i[a].listener,o=a;break}if(o<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new t,this;delete r[e]}else!function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(i,o);r.removeListener&&this.emit("removeListener",e,s||n)}return this},n.prototype.removeAllListeners=function(e){var n,i;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=new t,this._eventsCount=0):i[e]&&(0==--this._eventsCount?this._events=new t:delete i[e]),this;if(0===arguments.length){for(var r,o=Object.keys(i),a=0;a<o.length;++a)"removeListener"!==(r=o[a])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new t,this._eventsCount=0,this}if("function"==typeof(n=i[e]))this.removeListener(e,n);else if(n)do{this.removeListener(e,n[n.length-1])}while(n[0]);return this},n.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):u.call(e,t)},n.prototype.listenerCount=u,n.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var p,g=new(function(t){function n(){var e;return(e=t.call(this)||this).setMaxListeners(20),e}e(n,t);var i=n.prototype;return i.dispatch=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.emit.apply(this,["before:"+e].concat(n)),this.emit.apply(this,arguments),this.emit.apply(this,["after:"+e].concat(n))},i.registerOnce=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.once(e,t)},i.register=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.on(e,t)},i.unregister=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.removeListener(e,t)},n}(n)),h=window.AJS&&window.AJS.$||function(){},m="[Simple-XDM] ",v=Function.prototype.bind,y={locationOrigin:function(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},randomString:function(){return Math.floor(1e9*Math.random()).toString(16)},isString:function(e){return"string"==typeof e||e instanceof String},argumentsToArray:function(e){return Array.prototype.slice.call(e)},argumentNames:function(e){return e.toString().replace(/((\/\/.*$)|(\/\*[^]*?\*\/))/gm,"").replace(/[^(]+\(([^)]*)[^]+/,"$1").match(/([^\s,]+)/g)||[]},hasCallback:function(e){var t=e.length;return t>0&&"function"==typeof e[t-1]},error:function(e){if(window.console&&window.console.error){var t=[];"string"==typeof e?(t.push(m+e),t=t.concat(Array.prototype.slice.call(arguments,1))):(t.push(m),t=t.concat(Array.prototype.slice.call(arguments))),window.console.error.apply(null,t)}},warn:function(e){window.console&&console.warn(m+e)},log:function(e){window.console&&window.console.log(m+e)},_bind:function(e,t){return v&&t.bind===v?t.bind(e):function(){return t.apply(e,arguments)}},throttle:function(e,t,n){var i=0;return function(){var r=Date.now();r-i>t&&(i=r,e.apply(n,arguments))}},each:function(e,t){var n,i;if(e)if(null!=(n=e.length)&&"function"!=typeof e)for(i=0;i<n&&!1!==t.call(e[i],i,e[i]);)i+=1;else for(i in e)if(e.hasOwnProperty(i)&&!1===t.call(e[i],i,e[i]))break},extend:function(e){var t=arguments,n=[].slice.call(t,1,t.length);return n.forEach((function(t){"object"==typeof t&&Object.getOwnPropertyNames(t).forEach((function(n){e[n]=t[n]}))})),e},sanitizeStructuredClone:function(e){var t=[Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer],n=[Error,Node],i=y.warn,r=[];return function e(o){if("function"==typeof o)return i("A function was detected and removed from the message."),null;if(n.some((function(e){return o instanceof e&&(i(e.name+" object was detected and removed from the message."),!0)})))return{};if(o&&"object"==typeof o&&t.every((function(e){return!(o instanceof e)}))){var a;if(Array.isArray(o))a=o.map((function(t){return e(t)}));else{if(r.indexOf(o)>-1)return i("A circular reference was detected and removed from the message."),null;for(var s in r.push(o),a={},o)if(o.hasOwnProperty(s)){var d=e(o[s]);null!==d&&(a[s]=d)}r.pop()}return a}return o}(e)},getOrigin:function(e,t){if("function"==typeof URL)try{return new URL(e,t).origin}catch(e){}var n=document.implementation.createHTMLDocument("");if(t){var i=n.createElement("base");i.href=t,n.head.appendChild(i)}var r=n.createElement("a");r.href=e,n.body.appendChild(r);var o=r.protocol+"//"+r.hostname;return e.match(/\/\/[^/]+:[0-9]+\//)&&(o+=r.port?":"+r.port:""),o}},b=[],x=function(e){b=b.filter((function(t){var n=t.element,i=t.callback;return n!==e||(i(),!1)}))};if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window){var w=new IntersectionObserver((function(e){e.forEach((function(e){var t=e.intersectionRatio,n=e.target;t>0&&(w.unobserve(n),x(n))}))}),{threshold:.25});p=w.observe.bind(w)}else{p=function(e){(function(e){var t=document.documentElement;if(t.contains(e)&&"none"!==getComputedStyle(e).display){var n=e.getBoundingClientRect(),i=e.parentNode,r=n;do{var o=getComputedStyle(i);if("none"===o.display)return;var a=void 0;if(i===document.body?a={top:0,left:0,right:t.clientWidth,bottom:t.clientHeight}:"visible"!==o.overflow&&(a=i.getBoundingClientRect()),a){var s=Math.max(a.top,r.top),d=Math.max(a.left,r.left),c=Math.min(a.right,r.right),l=Math.min(a.bottom,r.bottom),u=c-d,f=l-s;if(u<=0||f<=0)return;r={top:s,left:d,right:c,bottom:l,width:u,height:f}}i=i.parentNode}while(i!==t);return r?r.width*r.height/(n.width*n.height):void 0}})(e)>=.25&&x(e)};var _=y.throttle((function(){b.forEach((function(e){var t=e.element;return p(t)}))}),500);window.addEventListener("resize",_),document.addEventListener("scroll",_),"MutationObserver"in window&&document.addEventListener("DOMContentLoaded",(function(){new MutationObserver(_).observe(document.body,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}))}var k=new(function(){function e(){this._addons={}}var t=e.prototype;return t._track=function(e,t){var n=window,i="connect.addon."+e;if((t=t||{}).version=n._AP&&n._AP.version?n._AP.version:void 0,t.userAgent=n.navigator.userAgent,!n.AJS)return!1;if(n.AJS.Analytics)n.AJS.Analytics.triggerPrivacyPolicySafeEvent(i,t);else{if(!n.AJS.trigger)return!1;AJS.trigger("analyticsEvent",{name:i,data:t})}return!0},t._time=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},t.trackLoadingStarted=function(e){this._addons&&e&&e.id?(e.startLoading=this._time(),this._addons[e.id]=e):console.error("ACJS: cannot track loading analytics",this._addons,e)},t.trackLoadingEnded=function(e){if(this._addons&&e&&this._addons[e.id]){var t=e.url,n=void 0!==t&&-1===t.indexOf("xdm_e="),i=this._time()-this._addons[e.id].startLoading,r=this.getIframeLoadApdex(i);this._track("iframe.performance.load",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0,iframeLoadMillis:i,iframeLoadApdex:r,iframeIsCacheable:n,value:i>2e4?"x":Math.ceil(i/100)})}else console.error("ACJS: cannot track loading end analytics",this._addons,e)},t.getIframeLoadApdex=function(e){return e<=300?1:e<=1200?.5:0},t.trackLoadingTimeout=function(e){var t=window.navigator.onLine;"boolean"!=typeof t&&(t="not-supported"),this._track("iframe.performance.timeout",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0,connectedStatus:t.toString()}),this.trackLoadingEnded(e)},t.trackLoadingCancel=function(e){this._track("iframe.performance.cancel",{addonKey:e.addon_key,moduleKey:e.key,moduleType:e.options?e.options.moduleType:void 0,moduleLocation:e.options?e.options.moduleLocation:void 0})},t.trackUseOfDeprecatedMethod=function(e,t){this._track("jsapi.deprecated",{addonKey:t.addon_key,moduleKey:t.key,methodUsed:e})},t.trackMultipleDialogOpening=function(e,t){this._track("jsapi.dialog.multiple",{addonKey:t.addon_key,moduleKey:t.key,dialogType:e})},t.trackVisible=function(e){this._track("iframe.is_visible",{addonKey:e.addon_key,moduleKey:e.key})},t.dispatch=function(e,t){this._track(e,t)},t.trackExternal=function(e,t){this._track(e,t)},e}());h.fn&&g.register("iframe-create",(function(e){k.trackLoadingStarted(e.extension)})),g.register("iframe-bridge-start",(function(e){k.trackLoadingStarted(e.extension)})),g.register("iframe-bridge-established",(function(e){var t,n;k.trackLoadingEnded(e.extension),t=document.getElementById(e.extension.id),"function"==typeof(n=function(){k.trackVisible(e.extension)})&&t instanceof Element&&(b.push({element:t,callback:n}),p(t))})),g.register("iframe-bridge-timeout",(function(e){k.trackLoadingTimeout(e.extension)})),g.register("iframe-bridge-cancelled",(function(e){k.trackLoadingCancel(e.extension)})),g.register("analytics-deprecated-method-used",(function(e){k.trackUseOfDeprecatedMethod(e.methodUsed,e.extension)})),g.register("iframe-destroyed",(function(e){delete k._addons[e.extension.extension_id]})),g.register("analytics-external-event-track",(function(e){k.trackExternal(e.eventName,e.values)}));var E=function(e,t){g.dispatch("iframe-bridge-timeout",{$el:e,extension:t})},C=function(e,t){g.dispatch("iframe-bridge-cancelled",{$el:e,extension:t})},A='<div class="ap-loading"><div class="small-spinner"></div>Loading app...</div>',O='<div class="ap-load-timeout"><div class="small-spinner"></div>App is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?</div>',P="App failed to load.",I=new(function(){function e(){this._stateRegistry={}}var t=e.prototype;return t._loadingContainer=function(e){return e.find(".ap-status-indicator")},t.render=function(){var e=document.createElement("div");e.classList.add("ap-status-indicator"),e.innerHTML=A;var t=h(e);return this._startSpinner(t),t},t._startSpinner=function(e){setTimeout((function(){var t=e.find(".small-spinner");t.length&&t.spin&&t.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})}),10)},t.hide=function(e,t){clearTimeout(this._stateRegistry[t]),delete this._stateRegistry[t],this._loadingContainer(e)[0].style.display="none"},t.cancelled=function(e,t){var n=P;this._loadingContainer(e).empty().text(n)},t._setupTimeout=function(e,t){this._stateRegistry[t.id]=setTimeout((function(){E(e,t)}),12e3)},t.timeout=function(e,t){var n=h(O),i=this._loadingContainer(e);return i.empty().append(n),this._startSpinner(i),h("a.ap-btn-cancel",i).click((function(){C(e,t)})),delete this._stateRegistry[t],i},e}());function S(e,t){return e(t={exports:{}},t.exports),t.exports}g.register("iframe-create",(function(e){e.extension.options.noDom||I._setupTimeout(e.$el.parents(".ap-iframe-container"),e.extension)})),g.register("iframe-bridge-established",(function(e){e.extension.options.noDom||I.hide(e.$el.parents(".ap-iframe-container"),e.extension.id)})),g.register("iframe-bridge-timeout",(function(e){e.extension.options.noDom||I.timeout(e.$el,e.extension.id)})),g.register("iframe-bridge-cancelled",(function(e){e.extension.options.noDom||I.cancelled(e.$el,e.extension.id)}));var M=S((function(e){function t(n,i){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(n,i)}e.exports=t})),D=S((function(e){function t(n,i,r){return function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?e.exports=t=Reflect.construct:e.exports=t=function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&M(r,n.prototype),r},t.apply(null,arguments)}e.exports=t})),j=function(t){e(i,t);var n=i.prototype;function i(e){var n;return e=e||{},(n=t.call(this,e)||this)._registeredExtensions=e.extensions||{},n._registeredAPIModules={},n._registeredAPIModules._globals={},n._pendingCallbacks={},n._keycodeCallbacks={},n._clickHandler=null,n._pendingEvents={},n._messageHandlers={init:n._handleInit,req:n._handleRequest,resp:n._handleResponse,broadcast:n._handleBroadcast,event_query:n._handleEventQuery,key_triggered:n._handleKeyTriggered,addon_clicked:n._handleAddonClick,get_host_offset:n._getHostOffset,unload:n._handleUnload,sub:n._handleSubInit},n}return n._padUndefinedArguments=function(e,t){return e.length>=t?e:e.concat(new Array(t-e.length))},n._verifyAPI=function(e,t){var n=e.data.targets;if(n){var i=this.getApiSpec(),r=!1;!function e(t,n){Object.getOwnPropertyNames(n).forEach((function(i){"object"==typeof n[i]&&t[i]?e(t[i],n[i]):"parent"===n[i]&&t[i]&&(r=!0)}))}(i,n),e.source.postMessage({type:"api_tamper",tampered:r},t.extension.url)}},n._handleInit=function(e,t){this._registeredExtensions[t.extension_id].source=e.source,t.initCallback&&(t.initCallback(e.data.eid),delete t.initCallback),e.data.targets&&this._verifyAPI(e,t)},n._handleSubInit=function(e,t){this.registerExtension(e.data.ext.id,{extension:e.data.ext})},n._getHostOffset=function(e,t){var n=e.source,i=null,r=t||window;if(r===r.top&&"function"==typeof r.getHostOffsetFunctionOverride&&(i=r.getHostOffsetFunctionOverride(n)),"number"!=typeof i)for(i=0;!this._hasSameOrigin(n);)i++,n=n.parent;e.source.postMessage({hostFrameOffset:i},e.origin)},n._hasSameOrigin=function(e){if(e===e.top)return!0;try{var t="test_var_"+Math.random().toString(16).substr(2);return e[t]=!0,e[t]}catch(e){}return!1},n._handleResponse=function(e){var t=e.data,n=this._pendingCallbacks[t.mid];n&&(delete this._pendingCallbacks[t.mid],n.apply(window,t.args))},n.registerRequestNotifier=function(e){this._registeredRequestNotifier=e},n._handleRequest=function(e,t){function n(){var n=y.sanitizeStructuredClone(y.argumentsToArray(arguments));e.source.postMessage({mid:e.data.mid,type:"resp",forPlugin:!0,args:n},t.extension.url)}var i=e.data,r=this._registeredAPIModules[i.mod],o=this.getRegisteredExtensions(t.extension)[0];if(r){var a=i.fn;if(i._cls){var s=r[i._cls],d=i.mod+"-"+i._cls+"-";n._id=i._id,"constructor"===a?(s._construct||(s.constructor.prototype._destroy=function(){delete this._context._proxies[d+this._id]},s._construct=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=D(s.constructor,t),r=t[t.length-1];return i._id=r._id,i._context=r._context,i._context._proxies[d+i._id]=i,i}),r=s,a="_construct"):r=o._proxies[d+i._id]}var c=r[a];if(c){var l=i.args,u=c.length-1;"_construct"===a&&(u=r.constructor.length-1),n._context=o,(l=this._padUndefinedArguments(l,u)).push(n);var f=c.apply(r,l);c.returnsPromise&&("object"!=typeof f&&"function"!=typeof f||"function"!=typeof f.then?n("Defined module method did not return a promise."):f.then((function(e){n(void 0,e)})).catch((function(e){n(e=e instanceof Error?e.message:e)}))),this._registeredRequestNotifier&&this._registeredRequestNotifier.call(null,{module:i.mod,fn:i.fn,type:i.type,addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})}}},n._handleBroadcast=function(e,t){var n=e.data;this.dispatch(n.etyp,(function(e){return e.extension.addon_key===t.extension.addon_key&&e.extension_id!==t.extension_id}),n.evnt,null,null)},n._handleKeyTriggered=function(e,t){var n=e.data,i=this._keycodeKey(n.keycode,n.modifiers,t.extension_id),r=this._keycodeCallbacks[i];r&&r.forEach((function(e){e.call(null,{addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id,keycode:n.keycode,modifiers:n.modifiers})}),this)},n.defineAPIModule=function(e,t){return t=t||"_globals",this._registeredAPIModules[t]=y.extend({},this._registeredAPIModules[t]||{},e),this._registeredAPIModules},n._pendingEventKey=function(e,t){var n=e.addon_key||"global";return e.key&&(n=n+"@@"+e.key),n=n+"@@"+t},n.queueEvent=function(e,t,n,i){if(this._findRegistrations(t).some((function(e){return void 0!==e.registered_events}),this))this.dispatch(e,t,n,i);else{this._cleanupInvalidEvents();var r=(new Date).getTime();this._pendingEvents[this._pendingEventKey(t,r)]={type:e,targetSpec:t,event:n,callback:i,time:r,uid:y.randomString()}}},n._cleanupInvalidEvents=function(){var e=this,t=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(n){var i=e._pendingEvents[n];t-i.time<=3e4||delete e._pendingEvents[n]}))},n._handleEventQuery=function(e,t){var n=this,i={},r=(new Date).getTime();return Object.keys(this._pendingEvents).forEach((function(o){var a=n._pendingEvents[o],s=r-a.time<=3e4,d=!a.targetSpec||0!==n._findRegistrations(a.targetSpec).length;d&&a.targetSpec.key&&(d=a.targetSpec.addon_key===t.extension.addon_key&&a.targetSpec.key===t.extension.key),s&&d?(i[o]=a,a.targetSpec=a.targetSpec||{},n.dispatch(a.type,a.targetSpec,a.event,a.callback,e.source)):s||delete n._pendingEvents[o]})),this._registeredExtensions[t.extension_id].registered_events=e.data.args,i},n._handleUnload=function(e,t){t&&(t.extension_id&&this._registeredExtensions[t.extension_id]&&delete this._registeredExtensions[t.extension_id].source,t.unloadCallback&&t.unloadCallback(e.data.eid))},n.dispatch=function(e,t,n,i,r){function o(t,n){var r;t.source&&t.source.postMessage&&(i&&(r=y.randomString(),this._pendingCallbacks[r]=i),t.source.postMessage({type:"evt",mid:r,etyp:e,evnt:n},t.extension.url))}this._findRegistrations(t||{}).forEach((function(e){r&&!e.source&&(e.source=r),e.source&&y._bind(this,o)(e,n)}),this)},n._findRegistrations=function(e){var t=this;if(0===this._registeredExtensions.length)return y.error("no registered extensions",this._registeredExtensions),[];var n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(this._registeredExtensions).map((function(e){return t._registeredExtensions[e]}));return e instanceof Function?i.filter(e):i.filter((function(t){return n.every((function(n){return t.extension[n]===e[n]}))}))},n.registerExtension=function(e,t){t._proxies={},t.extension_id=e,this._registeredExtensions[e]=t},n._keycodeKey=function(e,t,n){var i=e;return t&&("string"==typeof t&&(t=[t]),t.sort(),t.forEach((function(e){i+="$$"+e}),this)),i+"__"+n},n.registerKeyListener=function(e,t,n,i){"string"==typeof n&&(n=[n]);var r=this._registeredExtensions[e],o=this._keycodeKey(t,n,e);this._keycodeCallbacks[o]||(this._keycodeCallbacks[o]=[],r.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"add"},r.extension.url)),this._keycodeCallbacks[o].push(i)},n.unregisterKeyListener=function(e,t,n,i){var r=this._keycodeKey(t,n,e),o=this._keycodeCallbacks[r],a=this._registeredExtensions[e];if(o){if(i){var s=o.indexOf(i);this._keycodeCallbacks[r].splice(s,1)}else delete this._keycodeCallbacks[r];a.source&&a.source.postMessage&&a.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"remove"},a.extension.url)}},n.registerClickHandler=function(e){if("function"!=typeof e)throw new Error("callback must be a function");if(null!==this._clickHandler)throw new Error("ClickHandler already registered");this._clickHandler=e},n._handleAddonClick=function(e,t){"function"==typeof this._clickHandler&&this._clickHandler({addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})},n.unregisterClickHandler=function(){this._clickHandler=null},n.getApiSpec=function(){var e=this;return Object.getOwnPropertyNames(this._registeredAPIModules).reduce((function(t,n){return t[n]=function(t){var n=e._registeredAPIModules[t];if(!n)throw new Error("unregistered API module: "+t);return function e(t){return Object.getOwnPropertyNames(t).reduce((function(n,i){var r=t[i];switch(typeof r){case"function":n[i]={args:y.argumentNames(r),returnsPromise:r.returnsPromise||!1};break;case"object":r.hasOwnProperty("constructor")&&(n[i]=e(r))}return n}),{})}(n)}(n),t}),{})},n._originEqual=function(e,t){function n(e){return"string"==typeof e&&e.length>0}var i=y.getOrigin(e);return!!(n(e)&&n(t)&&n(i))&&t===i},n._checkOrigin=function(e,t){var n=t&&!t.source&&["init"].indexOf(e.data.type)>-1,i=t&&e.source===t.source,r=t&&this._originEqual(t.extension.url,e.origin)&&(n||i);return"get_host_offset"===e.data.type&&window===window.top&&(r=!0),"unload"!==e.data.type||!i&&void 0!==e.source||(r=!0),r||y.log("Failed to validate origin: "+e.origin),r},n.getRegisteredExtensions=function(e){return e?this._findRegistrations(e):this._registeredExtensions},n.unregisterExtension=function(e){var t=this._findRegistrations(e);0!==t.length&&t.forEach((function(e){var t=this;Object.keys(this._pendingEvents).forEach((function(n){var i=t._pendingEvents[n].targetSpec||{};i.addon_key===e.extension.addon_key&&i.key===e.extension.key&&delete t._pendingEvents[n]})),delete this._registeredExtensions[e.extension_id]}),this)},i}(function(){function e(e){var t=e||{};this._registerListener(t.listenOn)}var t=e.prototype;return t._registerListener=function(e){e&&e.addEventListener||(e=window),e.addEventListener("message",y._bind(this,this._receiveMessage),!1)},t._receiveMessage=function(e){var t,n=this._messageHandlers[e.data.type],i=e.data.eid;if(i&&this._registeredExtensions&&(t=this._registeredExtensions[i]),!n||!this._checkOrigin(e,t))return!1;n.call(this,e,t)},e}()),T=new(function(){function e(){this._xdm=new j}var t=e.prototype;return t.dispatch=function(e,t,n,i){return this._xdm.queueEvent(e,t,n,i),this.getExtensions(t)},t.broadcast=function(e,t,n){return this._xdm.dispatch(e,t,n,null,null),this.getExtensions(t)},t._createId=function(e){if(!e.addon_key||!e.key)throw Error("Extensions require addon_key and key");return e.addon_key+"__"+e.key+"__"+y.randomString()},t.create=function(e,t,n){var i=this.registerExtension(e,t,n),r=e.options||{},o={extension_id:i,api:this._xdm.getApiSpec(),origin:y.locationOrigin(),options:r};return{id:i,name:JSON.stringify(o),src:e.url}},t.registerRequestNotifier=function(e){this._xdm.registerRequestNotifier(e)},t.registerExtension=function(e,t,n){var i=this._createId(e);return this._xdm.registerExtension(i,{extension:e,initCallback:t,unloadCallback:n}),i},t.registerKeyListener=function(e,t,n,i){this._xdm.registerKeyListener(e,t,n,i)},t.unregisterKeyListener=function(e,t,n,i){this._xdm.unregisterKeyListener(e,t,n,i)},t.registerClickHandler=function(e){this._xdm.registerClickHandler(e)},t.unregisterClickHandler=function(){this._xdm.unregisterClickHandler()},t.defineModule=function(e,t,n){this._xdm.defineAPIModule(t,e,n)},t.defineGlobals=function(e){this._xdm.defineAPIModule(e)},t.getExtensions=function(e){return this._xdm.getRegisteredExtensions(e)},t.unregisterExtension=function(e){return this._xdm.unregisterExtension(e)},t.returnsPromise=function(e){e.returnsPromise=!0},e}()),L={broadcast:function(e,t,n){T.dispatch(e,t,n),g.dispatch("event-dispatch",{type:e,targetSpec:t,event:n})},broadcastPublic:function(e,t,n){g.dispatch("event-public-dispatch",{type:e,event:t,sender:n}),T.dispatch(e,{},{sender:{addonKey:n.addon_key,key:n.key,options:y.sanitizeStructuredClone(n.options)},event:t})}},U=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;function B(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var z=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,i,r=B(e),o=1;o<arguments.length;o++){for(var a in n=Object(arguments[o]))N.call(n,a)&&(r[a]=n[a]);if(U){i=U(n);for(var s=0;s<i.length;s++)R.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r};function $(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}var F={escapeSelector:$,stringToDimension:function(e){var t=!1,n="px";if("string"==typeof e&&(t=e.indexOf("%")===e.length-1,e=parseInt(e,10),t&&(n="%")),!isNaN(e))return e+n},getIframeByExtensionId:function(e){return h("iframe#"+$(e))},first:function(e,t){return t?e.slice(0,t):e[0]},last:function(e){return e[e.length-1]},pick:function(e,t){return"object"!=typeof e?{}:Object.keys(e).filter((function(e){return t.indexOf(e)>=0})).reduce((function(t,n){var i;return z(t,((i={})[n]=e[n],i))}),{})},debounce:function(e,t){var n;return function(){var i=this,r=[].slice.call(arguments);function o(){n=null,e.apply(i,r)}n&&clearTimeout(n),n=setTimeout(o,t||50)}},extend:z},H={emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=F.last(n);n=F.first(n,-1),L.broadcast(e,{addon_key:r._context.extension.addon_key},n)},emitPublic:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=F.last(n),o=r._context.extension;n=F.first(n,-1),L.broadcastPublic(e,n,o)}},J={open:function(e,t){g.dispatch("dialog-extension-open",{extension:e,options:t})},close:function(){g.dispatch("dialog-close-active",{})},addUserButton:function(e,t){g.dispatch("dialog-button-add",{button:{text:e.text,identifier:e.identifier,data:{userButton:!0}},extension:t})}},K={close:function(e){g.dispatch("dialog-close",{dialog:e.dialog,extension:e.extension,customData:e.customData})},closeActive:function(e){g.dispatch("dialog-close-active",e)},clickButton:function(e,t,n){g.dispatch("dialog-button-click",{identifier:e,$el:t,extension:n})},toggleButton:function(e){g.dispatch("dialog-button-toggle",e)},toggleButtonVisibility:function(e){g.dispatch("dialog-button-toggle-visibility",e)}},q=function(e){T.registerKeyListener(e.extension_id,e.key,e.modifiers,e.callback),g.dispatch("dom-event-register",e)},V=function(e){T.unregisterKeyListener(e.extension_id,e.key,e.modifiers,e.callback),g.dispatch("dom-event-unregister",e)},W=function(e){window.addEventListener("keydown",(function(t){t.keyCode===e.keyCode&&e.callback()}))},Q=function(e){T.registerClickHandler((function(t){var n=document.getElementById(t.extension_id);n&&e(n)}))},X=function(){T.unregisterClickHandler()},G=new(function(){function e(){}return e.prototype.randomIdentifier=function(){return Math.random().toString(16).substring(7)},e}()),Y=new(function(){function e(){}var t=e.prototype;return t._maxDimension=function(e,t){var n=F.stringToDimension(e),i=parseInt(n,10),r=parseInt(t,10);return n.indexOf("%")>-1&&i>=100||i>r?"100%":n},t._closeOnEscape=function(e){return!1!==e.closeOnEscape},t._size=function(e){var t=e.size;return"x-large"===e.size&&(t="xlarge"),"maximum"!==e.size&&"100%"===e.width&&"100%"===e.height&&(t="fullscreen"),t},t._header=function(e){var t="";switch(typeof e){case"string":t=e;break;case"object":t=e.value}return t},t._hint=function(e){return"string"==typeof e?e:""},t._chrome=function(e){var t=!1;return"boolean"==typeof e.chrome&&(t=e.chrome),"fullscreen"===e.size&&(t=!0),"maximum"===e.size&&(t=!1),t},t._width=function(e){if(!e.size)return e.width?this._maxDimension(e.width,h(window).width()):"50%"},t._height=function(e){if(!e.size)return e.height?this._maxDimension(e.height,h(window).height()):"50%"},t._actions=function(e){var t=[];return(e=e||{}).actions||(t=[{name:"submit",identifier:"submit",text:e.submitText||"Submit",type:"primary",disabled:!0},{name:"cancel",identifier:"cancel",text:e.cancelText||"Cancel",type:"link",immutable:!0}]),e.buttons&&(t=t.concat(this._buttons(e))),t},t._id=function(e){return"string"!=typeof e&&(e=Math.random().toString(36).substring(2,8)),e},t._buttons=function(e){var t=[];return e.buttons&&Array.isArray(e.buttons)&&e.buttons.forEach((function(e){var n,i,r=!1;e.text&&"string"==typeof e.text&&(n=e.text),i=e.identifier&&"string"==typeof e.identifier?e.identifier:G.randomIdentifier(),e.disabled&&!0===e.disabled&&(r=!0),t.push({text:n,identifier:i,type:"secondary",custom:!0,disabled:r})})),t},t._onHide=function(e){return"function"==typeof e.onHide?e.onHide:function(){}},t.sanitizeOptions=function(e){e=e||{};var t={chrome:this._chrome(e),header:this._header(e.header),hint:this._hint(e.hint),width:this._width(e),height:this._height(e),$content:e.$content,extension:e.extension,actions:this._actions(e),id:this._id(e.id),size:e.size,closeOnEscape:this._closeOnEscape(e),onHide:this._onHide(e)};return t.size=this._size(t),t},t.moduleOptionsFromGlobal=function(e,t){return!!(window._AP&&window._AP.dialogModules&&window._AP.dialogModules[e]&&window._AP.dialogModules[e][t])&&F.extend({},{chrome:!0},window._AP.dialogModules[e][t].options)},t.trackMultipleDialogOpening=function(e,t){var n,i=this._size(t);h(".ap-aui-dialog2:visible").length&&(n=h("#macro-browser-dialog").length||AJS.Confluence&&AJS.Confluence.Editor&&AJS.Confluence.Editor.currentEditMode?"fullscreen"===i?"connect-macro-multiple-fullscreen":"connect-macro-multiple":"connect-multiple",k.trackMultipleDialogOpening(n,e))},t.assertActiveDialogOrThrow=function(e,t){if(!e.isActiveDialog(t))throw new Error("Failed to find an active dialog for: "+t)},e}()),Z={notifyIframeCreated:function(e,t){g.dispatch("iframe-create",{$el:e,extension:t})},notifyBridgeEstablished:function(e,t){g.dispatch("iframe-bridge-established",{$el:e,extension:t})},notifyIframeDestroyed:function(e){"string"==typeof e&&(e={id:e}),T.getExtensions(e).forEach((function(e){g.dispatch("iframe-destroyed",{extension:e}),T.unregisterExtension({id:e.extension_id})}),this)},notifyUnloaded:function(e,t){g.dispatch("iframe-unload",{$el:e,extension:t})}},ee=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))};function te(e,t){return t.encode?t.strict?ee(e):encodeURIComponent(e):e}for(var ne={extract:function(e){return e.split("?")[1]||""},parse:function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,i){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return function(e,n,i){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=z({arrayFormat:"none"},t)),i=Object.create(null);return"string"!=typeof e?i:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),r=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(r),o,i)})),Object.keys(i).sort().reduce((function(e,t){var n=i[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))):i},stringify:function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,i){return null===n?[te(t,e),"[",i,"]"].join(""):[te(t,e),"[",te(i,e),"]=",te(n,e)].join("")};case"bracket":return function(t,n){return null===n?te(t,e):[te(t,e),"[]=",te(n,e)].join("")};default:return function(t,n){return null===n?te(t,e):[te(t,e),"=",te(n,e)].join("")}}}(t=z({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(i){var r=e[i];if(void 0===r)return"";if(null===r)return te(i,t);if(Array.isArray(r)){var o=[];return r.slice().forEach((function(e){void 0!==e&&o.push(n(i,e,o.length))})),o.join("&")}return te(i,t)+"="+te(r,t)})).filter((function(e){return e.length>0})).join("&"):""}},ie=function(e){for(var t,n=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}(e),i=n[0],r=n[1],o=new ae(function(e,t,n){return 3*(t+n)/4-n}(0,i,r)),a=0,s=r>0?i-4:i,d=0;d<s;d+=4)t=oe[e.charCodeAt(d)]<<18|oe[e.charCodeAt(d+1)]<<12|oe[e.charCodeAt(d+2)]<<6|oe[e.charCodeAt(d+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;return 2===r&&(t=oe[e.charCodeAt(d)]<<2|oe[e.charCodeAt(d+1)]>>4,o[a++]=255&t),1===r&&(t=oe[e.charCodeAt(d)]<<10|oe[e.charCodeAt(d+1)]<<4|oe[e.charCodeAt(d+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t),o},re=[],oe=[],ae="undefined"!=typeof Uint8Array?Uint8Array:Array,se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de=0,ce=se.length;de<ce;++de)re[de]=se[de],oe[se.charCodeAt(de)]=de;oe["-".charCodeAt(0)]=62,oe["_".charCodeAt(0)]=63;var le=S((function(e){function t(){}function n(){}!function(){function e(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;a++){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&((t-=3)>-1&&o.push(239,191,189),r=null);if(n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<2097152))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function i(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}t.prototype.encode=function(t){return"undefined"==typeof Uint8Array?e(t):new Uint8Array(e(t))},n.prototype.decode=function(e){return function(e,t,n){var r="",o="";n=Math.min(e.length,n||1/0);for(var a=t=t||0;a<n;a++)e[a]<=127?(r+=i(o)+String.fromCharCode(e[a]),o=""):o+="%"+e[a].toString(16);return r+i(o)}(e,0,e.length)}}(),e&&(e.exports.TextDecoderLite=n,e.exports.TextEncoderLite=t)})),ue=le.TextDecoderLite;function fe(e){var t=4-e.length%4;return 1===t?e+="=":2===t&&(e+="=="),ue.prototype.decode(ie(e))}le.TextEncoderLite;var pe=60;function ge(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(t<0||n<=t)throw'Invalid JWT: must contain 2 period (".") characters.';var i=e.substring(t+1,n);if(null===i||""===i)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var r=fe.call(window,i);return JSON.parse(r)}g.register("jwt-skew-set",(function(e){pe=e.skew}));var he={parseJwtIssuer:function(e){return ge(e).iss},parseJwtClaims:ge,isJwtExpired:function(e,t){void 0===t&&(t=pe);var n=ge(e),i=0,r=Math.floor(Date.now()/1e3);return n&&n.exp&&(i=n.exp),i-t<r}};function me(e){return ne.parse(ne.extract(e)).jwt}var ve={hasJwt:function(e){return me(e)&&0!==me(e).length},isJwtExpired:function(e){var t=me(e);return he.isJwtExpired(t)}},ye={registerContentResolver:function(e){g.dispatch("content-resolver-register-by-extension",e)},requestRefreshUrl:function(e){if(!e.resolver)throw Error("ACJS: No content resolver supplied");var t=e.resolver.call(null,F.extend({classifier:"json"},e.extension));t.fail((function(t,n){g.dispatch("jwt-url-refreshed-failed",{extension:e.extension,$container:e.$container,errorText:n.text})})),t.done((function(t){var n={};if("object"==typeof t)n=t;else if("string"==typeof t)try{n=JSON.parse(t)}catch(e){console.error("ACJS: invalid response from content resolver")}e.extension.url=n.url,F.extend(e.extension.options,n.options),g.dispatch("jwt-url-refreshed",{extension:e.extension,$container:e.$container,url:e.extension.url})})),g.dispatch("jwt-url-refresh-request",{data:e})},setClockSkew:function(e){"number"==typeof e?g.dispatch("jwt-skew-set",{skew:e}):console.error("ACJS: invalid JWT clock skew set")}},be={optionsToAttributes:function(e){var t={};return e&&"object"==typeof e&&(e.width&&(t.width=F.stringToDimension(e.width)),e.height&&(t.height=F.stringToDimension(e.height))),t}},xe=new(function(){function e(){this.store={}}var t=e.prototype;return t.set=function(e,t){if(t){var n={};n[e]=t}else n=e;F.extend(this.store,n)},t.get=function(e){return e?this.store[e]:F.extend({},this.store)},e}());function we(e){return{addon_key:e.addon_key,key:e.key,url:e.url,options:e.options}}var _e={createSimpleXdmExtension:function(e){var t=we(e),n=xe.get();e.options=t.options=F.extend({},t.options),e.options.globalOptions=n;var i=T.create(t,(function(){e.options.noDOM||(e.$el=h(document.getElementById(e.id))),Z.notifyBridgeEstablished(e.$el,e)}),(function(){Z.notifyUnloaded(e.$el,e)}));return t.id=i.id,e.id=i.id,F.extend(i,be.optionsToAttributes(e.options)),{iframeAttributes:i,extension:e}},extensionConfigSanitizer:we},ke=new(function(){function e(){this._contentResolver=!1}var t=e.prototype;return t.setContentResolver=function(e){this._contentResolver=e},t.resize=function(e,t,n){e=F.stringToDimension(e),t=F.stringToDimension(t),n.css({width:e,height:t}),n.trigger("resized",{width:e,height:t})},t.simpleXdmExtension=function(e,t){!e.url||ve.hasJwt(e.url)&&ve.isJwtExpired(e.url)?this._contentResolver?ye.requestRefreshUrl({extension:e,resolver:this._contentResolver,$container:t}):console.error("JWT is expired and no content resolver was specified"):this._appendExtension(t,this._simpleXdmCreate(e))},t._simpleXdmCreate=function(e){var t=_e.createSimpleXdmExtension(e);return e.id=t.iframeAttributes.id,e.$el=this.render(t.iframeAttributes),e},t._appendExtension=function(e,t){var n=e.find("iframe");n.length>0&&n.destroy(),t.options.hideIframeUntilLoad&&t.$el.css({visibility:"hidden"}).load((function(){t.$el.css({visibility:""})})),e.prepend(t.$el),Z.notifyIframeCreated(t.$el,t)},t._appendExtensionError=function(e,t){var n=h('<div class="connect-resolve-error"></div>'),i=h("<p />").text(t);n.append('<p class="error">Error: The content resolver threw the following error:</p>'),n.append(i),e.prepend(n)},t.resolverResponse=function(e){var t=this._simpleXdmCreate(e.extension);this._appendExtension(e.$container,t)},t.resolverFailResponse=function(e){this._appendExtensionError(e.$container,e.errorText)},t.render=function(e){return(e=e||{}).referrerpolicy="no-referrer",h("<iframe />").attr(e).addClass("ap-iframe")},e}());g.register("iframe-resize",(function(e){ke.resize(e.width,e.height,e.$el)})),g.register("content-resolver-register-by-extension",(function(e){ke.setContentResolver(e.callback)})),g.register("jwt-url-refreshed",(function(e){ke.resolverResponse(e)})),g.register("jwt-url-refreshed-failed",(function(e){ke.resolverFailResponse(e)})),g.register("after:iframe-bridge-established",(function(e){e.extension.options.noDom?e.extension.options.bridgeEstablished=!0:e.$el[0].bridgeEstablished=!0}));var Ee=function(e){g.dispatch("button-clicked",{$el:e})},Ce=function(e,t){g.dispatch("button-toggle",{$el:e,disabled:t})},Ae=function(e,t){g.dispatch("button-toggle-visibility",{$el:e,hidden:t})},Oe=["primary","link","secondary"],Pe=0,Ie=new(function(){function e(){this.AP_BUTTON_CLASS="ap-aui-button"}var t=e.prototype;return t.setType=function(e,t){return t&&Oe.indexOf(t)>=0&&e.addClass("aui-button-"+t),e},t.setDisabled=function(e,t){return void 0===t||e.data("immutable")||e.attr("aria-disabled",t),e},t.setHidden=function(e,t){return void 0===t||e.data("immutable")||e.toggle(!t),e},t._setId=function(e,t){return t||(t="ap-button-"+Pe,Pe++),e.attr("id",t),e},t._additionalClasses=function(e,t){return t&&("string"!=typeof t&&(t=t.join(" ")),e.addClass(t)),e},t.getName=function(e){return h(e).data("name")},t.getText=function(e){return h(e).text()},t.getIdentifier=function(e){return h(e).data("identifier")},t.isVisible=function(e){return h(e).is(":visible")},t.isEnabled=function(e){return!("true"===h(e).attr("aria-disabled"))},t.render=function(e){var t=h("<button />");return e=e||{},t.addClass("aui-button "+this.AP_BUTTON_CLASS),t.text(e.text),t.data(e.data),t.data({name:e.name||e.identifier,identifier:e.identifier||G.randomIdentifier(),immutable:e.immutable||!1}),this._additionalClasses(t,e.additionalClasses),this.setType(t,e.type),this.setDisabled(t,e.disabled||!1),this._setId(t,e.id),t},e}());h((function(){h("body").on("click","."+Ie.AP_BUTTON_CLASS,(function(e){var t=h(e.target).closest("."+Ie.AP_BUTTON_CLASS);"true"!==t.attr("aria-disabled")&&Ee(t)}))})),g.register("button-toggle",(function(e){Ie.setDisabled(e.$el,e.disabled)})),g.register("button-toggle-visibility",(function(e){Ie.setHidden(e.$el,e.hidden)}));var Se=["ap-iframe-container"],Me=new(function(){function e(){}var t=e.prototype;return t.createExtension=function(e,t){var n=this._renderContainer();return t&&!1===t.loadingIndicator||n.append(this._renderLoadingIndicator()),ke.simpleXdmExtension(e,n),n},t._renderContainer=function(e){var t=h("<div />").attr(e||{});return t.addClass(Se.join(" ")),t},t._renderLoadingIndicator=function(){return I.render()},e}());function De(e){return Me.createExtension(e)}g.register("iframe-create",(function(e){var t="embedded-"+e.extension.id;e.extension.$el.parents(".ap-iframe-container").attr("id",t)}));var je=function(e,t){var n={};t?(n.methods=t,n.name=e):n.methods=e,g.dispatch("module-define-custom",n)},Te={trackDeprecatedMethodUsed:function(e,t){g.dispatch("analytics-deprecated-method-used",{methodUsed:e,extension:t})},trackIframeBridgeStart:function(e){g.dispatch("iframe-bridge-start",{extension:e})},trackExternalEvent:function(e,t){g.dispatch("analytics-external-event-track",{eventName:e,values:t})}};function Le(e){var t=e.attr("class"),n=t?t.match(/ap-plugin-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}function Ue(e){var t=e.attr("class"),n=t?t.match(/ap-module-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}function Ne(e){return Le(e)+"__"+Ue(e)}function Re(e,t,n){var i=e+"Modules";if(window._AP&&window._AP[i]&&window._AP[i][t]&&window._AP[i][t][n])return F.extend({},window._AP[i][t][n].options)}function Be(e,t){return Re(e,Le(t),function(e){var t=e.attr("class"),n=t?t.match(/ap-target-key-([^\s]*)/):null;return!!Array.isArray(n)&&n[1]}(t))}function ze(e){var t,n=e.attr("href"),i={};if(n||(n=e.find("a").attr("href")),n){var r=n.indexOf("#");if(r>=0){var o=n.substring(r+1);try{t=JSON.parse(decodeURI(o))}catch(e){console.error("ACJS: cannot decode webitem anchor")}t&&window._AP&&window._AP._convertConnectOptions?i=window._AP._convertConnectOptions(t):console.error("ACJS: cannot convert webitem url to connect iframe options")}else{var a=Ne(e),s=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog",d=Be(s,e);!d&&window._AP&&window._AP[s+"Options"]&&(d=F.extend({},window._AP[s+"Options"][a])||{}),d||(d={},console.warn("no webitem "+s+"Options for "+a)),d.productContext=d.productContext||{};var c=ne.parse(ne.extract(n));F.extend(d.productContext,c),i={addon_key:Le(e),key:Ue(e),options:d}}}return i}var $e={sanitizeTriggers:function(e){var t;return Array.isArray(e)?t=e.join(" "):"string"==typeof e&&(t=e.trim()),t},uniqueId:function(){return"webitem-"+Math.floor(1e9*Math.random()).toString(16)},getExtensionKey:Le,getKey:Ue,getOptionsForWebItem:function(e){var t=Ne(e),n=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog",i=Be(n,e);!i&&window._AP&&window._AP[n+"Options"]&&(i=F.extend({},window._AP[n+"Options"][t])||{}),i||(i={},console.warn("no webitem "+n+"Options for "+t)),i.productContext=i.productContext||{},i.structuredContext=i.structuredContext||{};var r=ze(e);return r&&r.options&&(F.extend(i.productContext,r.options.productContext),F.extend(i.structuredContext,r.options.structuredContext),i.contextJwt=r.options.contextJwt),i},getModuleOptionsByAddonAndModuleKey:Re,getConfigFromTarget:ze},Fe=new function(){var e=this;this._providers={},this.registerProvider=function(t,n){e._providers[t]=n},this.getProvider=function(t){return e._providers[t]}},He=new(function(){function e(){this.moduleNamesToModules=new Map}return e.prototype.registerModule=function(e,t){var n=e.getModuleRegistrationName();this.moduleNamesToModules.set(n,e)},e.prototype.getModuleByName=function(e){return this.moduleNamesToModules.get(e)},e.prototype.getProviderByModuleName=function(e){var t=this.moduleNamesToModules.get(e);return t&&t.isEnabled()?t.getProvider():void 0},e}()),Je=new(function(){function e(){var e=this;this.create=function(e){return De(_e.extensionConfigSanitizer(e))},this.dialog={create:function(e,t){var n=$e.getModuleOptionsByAddonAndModuleKey("dialog",e.addon_key,e.key),i=F.extend({},n||{},t);J.open(e,i)},close:function(t,n){var i=e.getFrameworkAdaptor().getProviderByModuleName("dialog");i?(Y.assertActiveDialogOrThrow(i,t),L.broadcast("dialog.close",{addon_key:t},n),i.close()):J.close()}},this.registerContentResolver={resolveByExtension:function(t){e._contentResolver=t,ye.registerContentResolver({callback:t})}},this.getContentResolver=function(){return e._contentResolver},this.registerProvider=function(e,t){Fe.registerProvider(e,t)},this.getProvider=function(e){return Fe.getProvider(e)},this.frameworkAdaptor=He}var t=e.prototype;return t.createExtension=function(e){e.options=e.options||{},e.options.noDom=!0;var t=_e.createSimpleXdmExtension(e);return Te.trackIframeBridgeStart(t.extension),t},t.setFrameworkAdaptor=function(e){this.frameworkAdaptor=e},t.getFrameworkAdaptor=function(){return this.frameworkAdaptor},t._cleanExtension=function(e){return F.pick(e,["id","addon_key","key","options","url"])},t.onIframeEstablished=function(e){e._wrapper=function(t){e.call({},{$el:t.$el,extension:this._cleanExtension(t.extension)})}.bind(this),g.register("after:iframe-bridge-established",e._wrapper)},t.offIframeEstablished=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");g.unregister("after:iframe-bridge-established",e._wrapper)},t.onIframeUnload=function(e){var t=this;g.register("after:iframe-unload",(function(n){e.call({},{$el:n.$el,extension:t._cleanExtension(n.extension)})}))},t.onPublicEventDispatched=function(e){e._wrapper=function(t){e.call({},{type:t.type,event:t.event,extension:this._cleanExtension(t.sender)})}.bind(this),g.register("after:event-public-dispatch",e._wrapper)},t.offPublicEventDispatched=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");g.unregister("after:event-public-dispatch",e._wrapper)},t.onKeyEvent=function(e,t,n,i){q({extension_id:e,key:t,modifiers:n,callback:i})},t.offKeyEvent=function(e,t,n,i){V({extension_id:e,key:t,modifiers:n,callback:i})},t.onFrameClick=function(e){if("function"!=typeof e)throw new Error("handleIframeClick must be a function");Q(e)},t.offFrameClick=function(){X()},t.destroy=function(e){Z.notifyIframeDestroyed({id:e})},t.defineModule=function(e,t){je(e,t)},t.broadcastEvent=function(e,t,n){L.broadcast(e,t,n)},t.getExtensions=function(e){return T.getExtensions(e)},t.trackDeprecatedMethodUsed=function(e,t){Te.trackDeprecatedMethodUsed(e,t)},t.trackAnalyticsEvent=function(e,t){Te.trackExternalEvent(e,t)},t.setJwtClockSkew=function(e){ye.setClockSkew(e)},t.isJwtExpired=function(e,t){return t?he.isJwtExpired(e):ve.isJwtExpired(e)},t.hasJwt=function(e){return ve.hasJwt(e)},t.setExtensionConfigurationOptions=function(e,t){xe.set(e,t)},t.getExtensionConfigurationOption=function(e){return xe.get(e)},e}()),Ke="ap-dialog-",qe=new RegExp("^"+Ke+"[0-9A-Za-z]+$"),Ve=["small","medium","large","xlarge","fullscreen","maximum"],We="aui-dialog2-footer-actions",Qe="header-control-panel";function Xe(){var e=AJS.LayerManager.global.getTopLayer();if(e&&qe.test(e.attr("id"))){var t=AJS.dialog2(e);return t._id=t.$el.attr("id").replace(Ke,""),t}}function Ge(e){var t=e.find("."+Qe);return t.length||(t=e.find("."+We)),t}function Ye(e,t){return Ge(t).find(".aui-button").filter((function(){return Ie.getIdentifier(this)===e}))}var Ze=new(function(){function e(){}var t=e.prototype;return t._renderHeaderCloseBtn=function(){var e=h("<a />").addClass("aui-dialog2-header-close"),t=h("<span />").addClass("aui-icon aui-icon-small aui-iconfont-close-dialog").text("Close");return e.append(t),e},t._renderFullScreenHeader=function(e,t){var n=h("<div />").addClass("header-title-container aui-item expanded"),i=h("<div />").append(h("<span />").addClass("header-title").text(t.header||""));return n.append(i),e.append(n).append(this._renderHeaderActions(t.actions,t.extension)),e},t._renderHeader=function(e){var t=h("<header />").addClass("aui-dialog2-header");if("fullscreen"===e.size)return this._renderFullScreenHeader(t,e);if(e.header){var n=h("<h2 />").addClass("aui-dialog2-header-main").text(e.header);t.append(n)}return t.append(this._renderHeaderCloseBtn()),t},t._renderHeaderActions=function(e,t){var n=h("<div />").addClass("aui-item "+Qe);return e[0].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-success"],e[1].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-close-dialog"],this._renderActionButtons(e,t).forEach((function(e){n.append(e)})),n},t._renderContent=function(e){var t=h("<div />").addClass("aui-dialog2-content");return e&&t.append(e),t},t._renderFooter=function(e){var t=h("<footer />").addClass("aui-dialog2-footer");if("fullscreen"!==e.size){var n=this._renderFooterActions(e.actions,e.extension);t.append(n)}if(e.hint){var i=h("<div />").addClass("aui-dialog2-footer-hint").text(e.hint);t.append(i)}return t},t._renderActionButtons=function(e,t){var n=this,i=[];return[].concat(e).forEach((function(e){i.push(n._renderDialogButton({text:e.text,name:e.name,type:e.type,additionalClasses:e.additionalClasses,custom:e.custom||!1,identifier:e.identifier,immutable:e.immutable,disabled:e.disabled||!1},t))})),i},t._renderFooterActions=function(e,t){var n=h("<div />").addClass(We);return this._renderActionButtons(e,t).forEach((function(e){n.append(e)})),n},t._renderDialogButton=function(e,t){e.additionalClasses=e.additionalClasses||[],e.additionalClasses.push("ap-aui-dialog-button"),e.custom&&e.additionalClasses.push("ap-dialog-custom-button");var n=Ie.render(e);return n.extension=t,n},t.render=function(e){var t=F.extend({},e),n=Y.sanitizeOptions(e),i=h("<section />").attr({role:"dialog",id:Ke+n.id});i.attr("data-aui-modal","true"),i.data({"aui-remove-on-hide":!0,extension:n.extension}),i.addClass("aui-layer aui-dialog2 ap-aui-dialog2"),Ve.indexOf(n.size)>=0&&i.addClass("aui-dialog2-"+n.size),"fullscreen"!==n.size&&"maximum"!==n.size||(n.chrome&&i.addClass("ap-header-controls"),i.addClass("aui-dialog2-maximum")),i.append(this._renderContent(n.$content)),n.chrome?(i.prepend(this._renderHeader({header:n.header,actions:n.actions,size:n.size})),i.append(this._renderFooter({extension:n.extension,actions:n.actions,hint:n.hint,size:n.size}))):i.addClass("aui-dialog2-chromeless");var r=AJS.dialog2(i);return r._id=n.id,"fullscreen"===n.size&&(n.height=n.width="100%"),n.size&&"fullscreen"!==n.size||AJS.layer(i).changeSize(n.width,n.height),n.onHide&&r.on("hide",n.onHide),r.show(),r.$el.data("extension",n.extension),r.$el.data("originalOptions",t),i},t.setIframeDimensions=function(e){ke.resize("100%","100%",e)},t.getActive=function(){return Xe()},t.buttonIsEnabled=function(e){var t=Xe();if(t){var n=Ye(e,t.$el);return Ie.isEnabled(n)}},t.buttonIsVisible=function(e){var t=Xe();if(t){var n=Ye(e,t.$el);return Ie.isVisible(n)}},t.getByExtension=function(e){var t;if("function"==typeof e)t=e;else{var n=Object.getOwnPropertyNames(e);t=function(t){var i=h(t).data("extension");return n.every((function(t){return i[t]===e[t]}))}}return h(".ap-aui-dialog2").toArray().filter(t).map((function(e){return AJS.dialog2(e)}))},t.addButton=function(e,t){t.custom=!0;var n=this._renderDialogButton(t,e),i=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;return Ge(i).append(n),i},e}());g.register("iframe-bridge-established",(function(e){if(e.extension.options.isDialog){var t,n=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");n?(t=n.close,n.setButtonDisabled("submit",!1)):(K.toggleButton({identifier:"submit",enabled:!0}),t=function(){K.close({dialog:Xe(),extension:e.extension})}),e.extension.options.preventDialogCloseOnEscape||(q({extension_id:e.extension.id,key:27,callback:t}),g.registerOnce("dialog-close",(function(t){V({extension_id:e.extension.id,key:27})})))}})),g.register("dialog-close-active",(function(e){var t=Xe();t&&K.close({customData:e.customData,dialog:t,extension:e.extension})})),g.register("dialog-close",(function(e){e.dialog&&e.dialog.hide()})),g.register("dialog-button-toggle",(function(e){var t=Xe();if(t){var n=Ye(e.identifier,t.$el);Ce(n,!e.enabled)}})),g.register("dialog-button-toggle-visibility",(function(e){var t=Xe();if(t){var n=Ye(e.identifier,t.$el);Ae(n,e.hidden)}})),g.register("button-clicked",(function(e){var t=e.$el;if(t.hasClass("ap-aui-dialog-button")){var n=t.parents(".ap-aui-dialog2"),i=n.find("iframe");i.length&&i[0].bridgeEstablished?K.clickButton(Ie.getIdentifier(t),t,n.data("extension")):K.close({dialog:Xe(),extension:t.extension})}})),h.fn&&(g.register("iframe-create",(function(e){e.extension.options&&e.extension.options.isDialog&&Ze.setIframeDimensions(e.extension.$el)})),g.register("dialog-button-add",(function(e){Ze.addButton(e.extension,e.button)})),g.register("host-window-resize",F.debounce((function(){h(".ap-aui-dialog2").each((function(e,t){var n=h(t),i=Y.sanitizeOptions(n.data("originalOptions"));t.style.width=i.width,t.style.height=i.height}))}),100))),W({keyCode:27,callback:function(){K.closeActive({customData:{},extension:null})}});var et=new(function(){function e(){}var t=e.prototype;return t.render=function(e,t){e.options=e.options||{},t=t||{},e.options.isDialog=!0,e.options.dialogId=t.id,e.options.preventDialogCloseOnEscape=!1===t.closeOnEscape,e.options.hostFrameOffset=t.hostFrameOffset,e.options.hideIframeUntilLoad=!0;var n=Me.createExtension(e);return Ze.render({extension:e,$content:n,chrome:t.chrome,width:t.width,height:t.height,size:t.size,header:t.header,hint:t.hint,submitText:t.submitText,cancelText:t.cancelText,buttons:t.buttons,onHide:t.onHide})},t.getActiveDialog=function(){return Ze.getActive()},t.buttonIsEnabled=function(e){return Ze.buttonIsEnabled(e)},t.buttonIsVisible=function(e){return Ze.buttonIsVisible(e)},t.getByExtension=function(e){return"string"==typeof e&&(e={id:e}),Ze.getByExtension(e)},e}());g.register("dialog-extension-open",(function(e){var t=e.extension,n=Y.sanitizeOptions(e.options),i=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");if(i){var r=function(e){var n=t.key,i=t.addon_key,r={button:{identifier:e.identifier,name:e.identifier,text:e.text}};["submit","cancel"].indexOf(e.identifier)>=0&&L.broadcast("dialog."+e.identifier,{addon_key:i,key:n},r),L.broadcast("dialog.button.click",{addon_key:i,key:n},r)};t.options.preventDialogCloseOnEscape=!1===n.closeOnEscape,n.actions.map((function(e){return e.onClick=r.bind(null,e)})),i.create(n,t)}else et.render(e.extension,e.options)}));var tt={};g.register("dialog-close",(function(e){e.dialog&&e.extension&&L.broadcast("dialog.close",{addon_key:e.extension.addon_key},e.customData)})),g.register("dialog-button-click",(function(e){var t={button:{name:Ie.getName(e.$el),identifier:Ie.getIdentifier(e.$el),text:Ie.getText(e.$el)}},n={addon_key:e.extension.addon_key,key:e.extension.key};window.AJS&&window.AJS.DarkFeatures&&window.AJS.DarkFeatures.isEnabled&&window.AJS.DarkFeatures.isEnabled("connect.js.dialog.idfilter")&&(n.id=e.extension.id),e.$el.hasClass("ap-dialog-custom-button")||L.broadcast("dialog."+t.button.name,n,t),L.broadcast("dialog.button.click",n,t)}));var nt=function(){function e(e,t){t=F.last(arguments);var n=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");if(n)Y.assertActiveDialogOrThrow(n,t._context.extension.addon_key),this.name=e,this.identifier=e;else{if(!et.getActiveDialog())throw new Error("Failed to find an active dialog.");this.name=e,this.identifier=e,this.enabled=et.buttonIsEnabled(e),this.hidden=!et.buttonIsVisible(e)}}var t=e.prototype;return t.enable=function(){this.setState({enabled:!0})},t.disable=function(){this.setState({enabled:!1})},t.isEnabled=function(e){e=F.last(arguments);var t=Je.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?!n.isButtonDisabled(this.identifier):this.enabled)},t.toggle=function(){var e=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");e?e.toggleButton(this.identifier):this.setState({enabled:!this.enabled})},t.setState=function(e){var t=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");t?t.setButtonDisabled(this.identifier,!e.enabled):(this.enabled=e.enabled,K.toggleButton({identifier:this.identifier,enabled:this.enabled}))},t.trigger=function(e){e=F.last(arguments),this.enabled&&K.dialogMessage({name:this.name,extension:e._context.extension})},t.isHidden=function(e){e=F.last(arguments);var t=Je.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?n.isButtonHidden(this.identifier):this.hidden)},t.hide=function(){this.setHidden(!0)},t.show=function(){this.setHidden(!1)},t.setHidden=function(e){var t=Je.getFrameworkAdaptor().getProviderByModuleName("dialog");t?t.setButtonHidden(this.identifier,e):(this.hidden=e,K.toggleButtonVisibility({identifier:this.identifier,hidden:this.hidden}))},e}();function it(e){return tt[e.extension.options.dialogId]}var rt={create:{constructor:function(e,t){var n=(t=F.last(arguments))._id,i=t._context.extension,r={addon_key:i.addon_key,key:e.key,options:F.pick(i.options,["customData","productContext"])};r.options.customData=e.customData;var o=Y.moduleOptionsFromGlobal(r.addon_key,r.key);"number"==typeof(o||{}).hostFrameOffset&&(r.options.hostFrameOffset=o.hostFrameOffset),(e=F.extend({},o||{},e)).id=n,Y.trackMultipleDialogOpening(r,e),J.open(r,e),this.customData=e.customData,tt[n]=this}},close:function(e,t){t=F.last(arguments);var n,i=Je.getFrameworkAdaptor(),r=i.getProviderByModuleName("dialog");r?(Y.assertActiveDialogOrThrow(r,t._context.extension.addon_key),L.broadcast("dialog.close",{addon_key:t._context.extension.addon_key},e),r.close()):(n=t._context.extension.options.isDialog?et.getByExtension(t._context.extension.id)[0]:et.getActiveDialog(),K.close({customData:e,dialog:n,extension:t._context.extension}))},getCustomData:function(e){var t=it((e=F.last(arguments))._context);e(t?t.customData:void 0)},getButton:{constructor:nt,enable:nt.prototype.enable,disable:nt.prototype.disable,toggle:nt.prototype.toggle,isEnabled:nt.prototype.isEnabled,trigger:nt.prototype.trigger,hide:nt.prototype.hide,show:nt.prototype.show,isHidden:nt.prototype.isHidden},createButton:{constructor:function(e,t){t=F.last(arguments);var n=Je.getFrameworkAdaptor(),i=n.getProviderByModuleName("dialog");i?(Y.assertActiveDialogOrThrow(i,t._context.extension.addon_key),i.createButton({identifier:e.identifier,text:e.text,hidden:!1,disabled:e.disabled||!1,onClick:function(){L.broadcast("dialog.button.click",{addon_key:t._context.extension.addon_key,key:t._context.extension.key},{button:{identifier:e.identifier,text:e.text}})}})):J.addUserButton({identifier:e.identifier,text:e.text},t._context.extension)}}};g.register("iframe-resize",(function(e){ke.resize(e.width,e.height,e.$el)})),g.register("iframe-size-to-parent",(function(e){var t,n=F.getIframeByExtensionId(e.extensionId);e.hideFooter?(n.addClass("full-size-general-page-no-footer"),h("#footer").css({display:"none"}),t=h(window).height()-h("#header > nav").outerHeight()):(t=h(window).height()-h("#header > nav").outerHeight()-h("#footer").outerHeight()-1,n.removeClass("full-size-general-page-no-footer"),h("#footer").css({display:"block"})),g.dispatch("iframe-resize",{width:"100%",height:t+"px",$el:n})})),g.register("hide-footer",(function(e){e&&h("#footer").css({display:"none"})})),window.addEventListener("resize",(function(e){g.dispatch("host-window-resize",e)}),!0);var ot=function(e,t,n){var i;i=n.extension_id?F.getIframeByExtensionId(n.extension_id):n,g.dispatch("iframe-resize",{width:e,height:t,$el:i,extension:n.extension})},at=function(e,t){g.dispatch("iframe-size-to-parent",{hideFooter:t,extensionId:e})},st=function(e){g.dispatch("hide-footer",e)},dt=F.debounce,ct={},lt=[],ut={},ft={getLocation:function(e){e=F.last(arguments);var t=Fe.getProvider("get-location");e("function"==typeof t?t():window.location.href)},resize:function(e,t,n){n=F.last(arguments);var i=Fe.getProvider("addon");if(i)i.resize(e,t,n._context);else{var r=n._context.extension.id,o=n._context.extension.options;if(-1!==lt.indexOf(r)||o&&o.isDialog)return!1;ct[r]||(ct[r]=dt((function(e,t,n){ot(e,t,n._context)}),50)),ct[r](e,t,n)}return!0},sizeToParent:dt((function(e,t){t=F.last(arguments);var n=Fe.getProvider("addon");n?n.sizeToParent(e,t._context):t._context.extension.options.isFullPage?(F.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page"),at(t._context.extension_id,e),ut[t._context.extension_id]={hideFooter:e}):F.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page-fail")})),hideFooter:function(e){e&&st(e)}};g.register("host-window-resize",(function(e){Object.getOwnPropertyNames(ut).forEach((function(e){at(e,ut[e].hideFooter)}))})),g.register("after:iframe-unload",(function(e){delete ct[e.extension.id],delete ut[e.extension.id],-1!==lt.indexOf(e.extension.id)&&lt.splice(lt.indexOf(e.extension.id),1)})),g.register("before:iframe-size-to-parent",(function(e){-1===lt.indexOf(e.extensionId)&&lt.push(e.extensionId)}));var pt=function(e){g.dispatch("inline-dialog-refresh",{$el:e})},gt=function(){g.dispatch("inline-dialog-close",{})},ht=function(e){g.dispatch("inline-dialog-opened",{$el:e.$el,trigger:e.trigger,extension:e.extension})},mt={hide:function(e){e=F.last(arguments);var t=Je.getFrameworkAdaptor(),n=t.getProviderByModuleName("inlineDialog");n?n.hide(e._context):gt()}},vt="ac-message-container",yt=["generic","error","warning","success","info","hint"],bt="ap-message-",xt=new RegExp("^"+bt+"[0-9A-fa-f]+$"),wt={};function _t(e){return xt.test(e)}var kt=!1;function Et(e,t,n,i){kt||(h(document).on("aui-message-close",(function(e,t){var n=t.attr("id").replace(bt,"");wt[n]&&(h.isFunction(wt[n].onCloseTrigger)&&wt[n].onCloseTrigger(),wt[n]._destroy())})),kt=!0);var r=function(){var e=h("#"+vt);return e.length<1&&(e=h('<div id="'+vt+'" />').appendTo("body")),e}();if(i=function(e){var t={};return"object"==typeof e&&["closeable","fadeout","delay","duration","id"].forEach((function(n){n in e&&(t[n]=e[n])})),t}(i),h.extend(i,{title:t,body:AJS.escapeHtml(n)}),yt.indexOf(e)<0)throw"Invalid message type. Must be: "+yt.join(", ");_t(i.id)&&(AJS.messages[e](r,i),r.css("margin-left","-"+r.innerWidth()/2+"px"))}function Ct(e,t,n,i,r){var o="AP.messages."+e;console.warn("DEPRECATED API - AP.messages."+e+" has been deprecated since ACJS 5.0 and will be removed in a future release. Use AP.flag.create instead."),Te.trackDeprecatedMethodUsed(o,r._context.extension);var a=Je.getFrameworkAdaptor().getProviderByModuleName("messages");if(a){var s=e,d=a[s];d||(a[s]=a.generic),d(t,n,i)}else Et(e,t,n,i)}function At(e){return{constructor:function(t,n,i,r){var o=(r=F.last(arguments))._id;"string"!=typeof t&&(t=""),"string"!=typeof n&&(n=""),"object"!=typeof i&&(i={}),i.id=bt+o,Ct(e,t,n,i,r),wt[o]=this}}}var Ot={clear:function(e){var t=bt+e._id;if(_t(t)){var n=Je.getFrameworkAdaptor().getProviderByModuleName("messages");n?n.clear(t):h("#"+t).closeMessage()}},onClose:function(e,t){t=F.last(arguments);var n=e._id,i=Je.getFrameworkAdaptor(),r=i.getProviderByModuleName("messages");if(r){var o=bt+e._id;r.onClose(o,t)}else wt[n]&&(wt[n].onCloseTrigger=t)},generic:At("generic"),error:At("error"),warning:At("warning"),success:At("success"),info:At("info"),hint:At("hint")},Pt={actionInvoked:function(e,t){g.dispatch("flag-action-invoked",{id:t,actionId:e})},open:function(e){g.dispatch("flag-open",{id:e})},close:function(e){g.dispatch("flag-close",{id:e})},closed:function(e){g.dispatch("flag-closed",{id:e})}},It="ac-flag-actions",St=new(function(){function e(){}var t=e.prototype;return t.cleanKey=function(e){var t=new RegExp("^ap-flag-(.+)$"),n=e.match(t);return n&&n[1]?n[1]:null},t._toHtmlString=function(e){return"string"===h.type(e)?e:"object"===h.type(e)&&e instanceof h?e.html():void 0},t._renderBody=function(e){e=this._toHtmlString(e);var t=h("<div />").html(e);return h("<p />").addClass(It).appendTo(t),t.html()},t._renderActions=function(e,t,n){var i,r=e.find("."+It);return n=n||{},Object.getOwnPropertyNames(n).forEach((function(e){i=h("<a />").attr("href","#").data({key:e,flag_id:t}).text(n[e]),r.append(i)}),this),e},t.render=function(e){Mt||(h(document).on("aui-flag-close",(function(e){var t=e.target.id,n=St.cleanKey(t);Pt.closed(n)})),h(document).on("click","."+It,(function(e){var t=h(e.target),n=t.data("key"),i=t.data("flag_id");Pt.actionInvoked(n,i)})),Mt=!0);var t="ap-flag-"+e.id,n=AJS.flag({type:e.type,title:e.title,body:this._renderBody(e.body),close:e.close});n.setAttribute("id",t);var i=h(n);return this._renderActions(i,e.id,e.actions),i.addClass("ac-aui-flag"),i.close=n.close,i},t.close=function(e){document.getElementById(e).close()},e}()),Mt=!1;g.register("flag-close",(function(e){St.close(e.id)}));var Dt={},jt=function(){function e(e,t){if(t=F.last(arguments),"object"==typeof e){var n=t._id,i=Je.getFrameworkAdaptor().getProviderByModuleName("flag");if(i){var r=[];"object"==typeof e.actions&&(r=Object.getOwnPropertyNames(e.actions).map((function(t){return{actionKey:t,actionText:e.actions[t],executeAction:Pt.actionInvoked.bind(null,t,n)}})));var o=e.type||"info",a={id:n,title:e.title,body:e.body,actions:r,onClose:Pt.closed,close:e.close,type:o.toLowerCase()};this.flag=i.create(a);var s=Fe.getProvider("addon");s&&s.registerUnmountCallback&&s.registerUnmountCallback(this.close.bind(this),t._context)}else this.flag=St.render({type:e.type,title:e.title,body:AJS.escapeHtml(e.body),actions:e.actions,close:e.close,id:n}),Pt.open(this.flag.attr("id"));this.onTriggers={},this.extension=t._context.extension,Dt[t._id]=this,t.call(null,t._id)}}return e.prototype.close=function(){this.flag.close()},e}();function Tt(e,t,n){if(Dt[e]){var i=Dt[e].extension;(n=n||{}).flagIdentifier=e,L.broadcast(t,{extension_id:i.extension_id},n)}}g.register("flag-closed",(function(e){Tt(e.id,"flag.close"),Dt[e.id]&&delete Dt[e.id]})),g.register("flag-action-invoked",(function(e){Tt(e.id,"flag.action",{actionIdentifier:e.actionId})}));var Lt,Ut,Nt={create:{constructor:jt,close:jt.prototype.close}},Rt={trackDeprecatedMethodUsed:function(e,t){t=F.last(arguments),Te.trackDeprecatedMethodUsed(e,t._context.extension)}},Bt=10;function zt(){window.removeEventListener("scroll",$t),Lt=void 0,Ut=void 0}function $t(){var e=document.documentElement.scrollHeight,t=window.innerHeight,n=e*(Bt/100);window.pageYOffset<=n?Ft("nearTop"):t+window.pageYOffset+n>=e?Ft("nearBottom"):Ut=void 0}function Ft(e){Ut!==e&&(L.broadcast("scroll."+e,{id:Lt},{}),Ut=e)}g.register("iframe-bridge-established",(function(e){e.extension.options.isFullPage&&(window.addEventListener("scroll",$t),Lt=e.extension.id)})),g.register("iframe-destroyed",(function(e){zt()})),g.register("iframe-unload",(function(e){zt()}));var Ht={getPosition:function(e){if((e=F.last(arguments))._context.extension.options.isFullPage){var t=F.getIframeByExtensionId(e._context.extension_id),n=t.offset(),i=h(window);e({scrollY:i.scrollTop()-n.top,scrollX:i.scrollLeft()-n.left,width:window.innerWidth,height:window.innerHeight})}},setVerticalPosition:function(e,t){if((t=F.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=F.getIframeByExtensionId(t._context.extension_id),i=n.offset();"number"==typeof e&&(document.documentElement.scrollTop=i.top+e)}}},Jt=function(e,t,n){g.dispatch("dropdown-item-selected",{id:e,item:t,extension:n})};function Kt(e){return e.map((function(e){if(e.list&&Array.isArray(e.list)){var t={heading:e.heading};return t.items=e.list.map((function(e){return function(e){var t={};if("string"==typeof e)t.content=e;else{if(!e.text||"string"!=typeof e.text)throw new Error("Unknown dropdown list item format.");t.content=e.text,"boolean"==typeof e.disabled&&(t.disabled=e.disabled),void 0!==e.itemId&&(t.itemId=e.itemId)}return t}(e)})),t}}))}var qt={create:function(e,t){if(t=F.last(arguments),"object"==typeof e){var n=Je.getFrameworkAdaptor(),i=n.getProviderByModuleName("dropdown");if(i){var r=Kt(e.list),o={dropdownId:e.dropdownId,dropdownGroups:r,dropdownItemNotifier:function(e){Jt(e.dropdownId,e.item,t._context.extension)}};return i.create(o,t._context),o}}},showAt:function(e,t,n,i){var r=F.last(arguments),o={left:0,top:0},a=document.getElementById(r._context.extension_id);a?o=a.getBoundingClientRect():console.error("ACJS: no iframe found for dropdown");var s=Je.getFrameworkAdaptor(),d=s.getProviderByModuleName("dropdown");if(d){var c={dropdownId:e,x:t,y:n,width:i};d.showAt(c,{iframeDimensions:o,onItemSelection:function(e,t){Jt(e,t,r._context.extension)}})}},hide:function(e){var t=Je.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.hide(e)},itemDisable:function(e,t){var n=Je.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemDisable(e,t)},itemEnable:function(e,t){var n=Je.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemEnable(e,t)}};g.register("dropdown-item-selected",(function(e){L.broadcast("dropdown-item-selected",{addon_key:e.extension.addon_key,key:e.extension.key},{dropdownId:e.id,item:e.item})})),g.register("iframe-destroyed",(function(e){var t=Je.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)})),g.register("after:iframe-unload",(function(e){var t=Je.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));var Vt={focus:function(){window.focus(),window.document.querySelector("a").focus(),window.document.querySelector("a").blur()}},Wt=new(function(){function e(){this._webitems={},this._contentResolver=function(){}}var t=e.prototype;return t.setContentResolver=function(e){this._contentResolver=e},t.requestContent=function(e){if(e.addon_key&&e.key)return this._contentResolver.call(null,F.extend({classifier:"json"},e))},t.getWebItemsBySelector=function(e){var t,n=this;return Object.getOwnPropertyNames(this._webitems).some((function(i){var r=n._webitems[i];return!(!r.selector||r.selector.trim()!==e.trim()||(t=r,0))})),t},t.setWebItem=function(e){return this._webitems[e.name]={name:e.name,selector:e.selector,triggers:e.triggers}},t._removeTriggers=function(e){var t=this,n=$e.sanitizeTriggers(e.triggers);h((function(){h("body").off(n,e.selector,t._webitems[e.name]._on)})),delete this._webitems[e.name]._on},t._addTriggers=function(e){var t=$e.sanitizeTriggers(e.triggers);e._on=function(t){t.preventDefault();var n=h(t.target).closest(e.selector),i=$e.getConfigFromTarget(n),r=i&&i.url?i.url:void 0,o={addon_key:$e.getExtensionKey(n),key:$e.getKey(n),options:$e.getOptionsForWebItem(n),url:r};Qt.webitemInvoked(e,t,o)},h((function(){h("body").on(t,e.selector,e._on)}))},e}());g.register("webitem-added",(function(e){Wt._addTriggers(e.webitem)})),g.register("content-resolver-register-by-extension",(function(e){Wt.setContentResolver(e.callback)})),document.addEventListener("aui-responsive-menu-item-created",(function(e){var t=e.detail.originalItem.querySelector('a[class*="ap-"]');if(t){var n=e.detail.newItem.querySelector("a");[].slice.call(t.classList).forEach((function(e){/^ap-/.test(e)&&n.classList.add(e)}))}}));var Qt={addWebItem:function(e){var t;if(Wt.getWebItemsBySelector(e.selector))return!1;t=Wt.setWebItem(e),g.dispatch("webitem-added",{webitem:t})},webitemInvoked:function(e,t,n){g.dispatch("webitem-invoked:"+e.name,{webitem:e,event:t,extension:n})}},Xt=function(e){g.dispatch("inline-dialog-extension",{$el:e.$el,extension:e.extension})},Gt=new(function(){function e(){}var t=e.prototype;return t.resize=function(e){var t=F.stringToDimension(e.width),n=F.stringToDimension(e.height),i=e.$el.find(".contents");1===i.length&&(i.css({width:t,height:n}),pt(e.$el))},t.refresh=function(e){e[0].popup.reset()},t._getInlineDialog=function(e){return AJS.InlineDialog(e)},t._renderContainer=function(){return h("<div />").addClass("aui-inline-dialog-contents")},t._displayInlineDialog=function(e){ht({$el:e.$el,trigger:e.trigger,extension:e.extension})},t.hideInlineDialog=function(e){e.hide()},t.closeInlineDialog=function(){h(".aui-inline-dialog").filter((function(){return h(this).find(".ap-iframe-container").length>0})).hide()},t.render=function(e){var t=this,n=h(document.getElementById("inline-dialog-"+e.id));return 0!==n.length&&n.remove(),AJS.InlineDialog(e.bindTo,e.id,(function(n,i,r){n.append(e.$content),t._displayInlineDialog({extension:e.extension,$el:n,trigger:i}),r()}),e.inlineDialogOptions)},e}());g.register("iframe-resize",(function(e){var t=e.$el.parents(".aui-inline-dialog");1===t.length&&Gt.resize({width:e.width,height:e.height,$el:t})})),g.register("inline-dialog-refresh",(function(e){Gt.refresh(e.$el)})),g.register("inline-dialog-hide",(function(e){Gt.hideInlineDialog(e.$el)})),g.register("inline-dialog-close",(function(e){Gt.closeInlineDialog()}));var Yt="inline-dialog",Zt=".ap-inline-dialog",en=["mouseover","click"],tn=new(function(){function e(){this._inlineDialogWebItemSpec={name:Yt,selector:Zt,triggers:en},this._inlineDialogWebItems={}}var t=e.prototype;return t.getWebItem=function(){return this._inlineDialogWebItemSpec},t._createInlineDialog=function(e){return Gt.render({extension:e.extension,id:e.id,bindTo:e.$target,$content:h("<div />"),inlineDialogOptions:e.extension.options})},t.triggered=function(e){if("click"===e.event.type||e.extension.options.onHover){var t=h(e.event.currentTarget),n=t.data("inline-dialog-target-uid");this._createInlineDialog({id:n,extension:e.extension,$target:t,options:e.extension.options||{}}).show()}},t.opened=function(e){var t=e.$el.find("iframe");if(t&&1===t.length){var n=t.attr("src");if(n.length>0){var i=ve.hasJwt(n);if(i&&!ve.isJwtExpired(n)||!i)return!1}}var r=Wt.requestContent(e.extension);return r?(r.then((function(t){t.options=t.options||{},F.extend(t.options,{autoresize:!0,widthinpx:!0}),Xt({$el:e.$el,extension:t})})),!0):(console.warn("no content resolver found"),!1)},t.addExtension=function(e){var t=De(e.extension);e.$el.empty().append(t)},t.createIfNotExists=function(e){var t=h(e.event.currentTarget),n=t.data("inline-dialog-target-uid");n||(n=$e.uniqueId(),t.data("inline-dialog-target-uid",n))},e}()),nn=tn.getWebItem();g.register("before:webitem-invoked:"+nn.name,(function(e){tn.createIfNotExists(e)})),g.register("webitem-invoked:"+nn.name,(function(e){tn.triggered(e)})),g.register("inline-dialog-opened",(function(e){tn.opened(e)})),g.register("inline-dialog-extension",(function(e){tn.addExtension(e)})),Qt.addWebItem(nn);var rn="dialog",on=".ap-dialog",an=["click"],sn={chrome:!0},dn=new(function(){function e(){this._dialogWebItem={name:rn,selector:on,triggers:an}}var t=e.prototype;return t.getWebItem=function(){return this._dialogWebItem},t._dialogOptions=function(e){return F.extend({},sn,e||{})},t.triggered=function(e){var t=h(e.event.currentTarget).data("dialog-target-uid"),n=this._dialogOptions(e.extension.options);n.id=t,J.open(e.extension,n)},t.createIfNotExists=function(e){var t=h(e.event.currentTarget),n=t.data("dialog-target-uid");n||(n=$e.uniqueId(),t.data("dialog-target-uid",n))},e}()),cn=dn.getWebItem();return g.register("webitem-invoked:"+cn.name,(function(e){dn.triggered(e)})),g.register("before:webitem-invoked:"+cn.name,dn.createIfNotExists),Qt.addWebItem(cn),window._AP||(window._AP={}),window._AP.version||(window._AP.version="5.2.19"),T.defineModule("messages",Ot),T.defineModule("flag",Nt),T.defineModule("dialog",rt),T.defineModule("inlineDialog",mt),T.defineModule("env",ft),T.defineModule("events",H),T.defineModule("_analytics",Rt),T.defineModule("scrollPosition",Ht),T.defineModule("dropdown",qt),T.defineModule("host",Vt),g.register("module-define-custom",(function(e){T.defineModule(e.name,e.methods)})),T.registerRequestNotifier((function(e){k.dispatch("bridge.invokemethod",{module:e.module,fn:e.fn,addonKey:e.addon_key,moduleKey:e.key})})),Je}()}]);
