WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'biz.artemissoftware.confluence.multiexcerpt.MultiExcerptMacro:name-field-parameter', location = 'js/name-parameter-field.js' */
(function(){var a=new MutationObserver(function(g){for(var k=0;k<g.length;k++){for(var h=0;h<g[k].addedNodes.length;h++){var f=g[k].addedNodes[h];if(f.nodeType===Node.ELEMENT_NODE){b($(f))}}}});a.observe(document,{childList:true,subtree:true});var e;var d;function b(j){var i=j.find("#macro-param-MultiExcerptName");var h=j.find("ol.last");var f="#macro-param-PageWithExcerpt";if(i.length){$(document).off("keyup.select2").on("keyup.select2",function(l){if(l.which===27){c(i.val(),i,e);$("#macro-param-addpanel").focus()}});d=true;var g=$(f);g.off("selected.autocomplete-content").off("change").on({"selected.autocomplete-content change":function(){setTimeout(function(){$.ajax({url:AJS.contextPath()+"/rest/multiexcerpt/1.0/names",data:{pageTitleParam:g.val()!=="@self"?g.val():$('meta[name="ajs-page-title"]').attr("content"),currentSpaceKey:$("#confluence-space-key").attr("content")},success:function(l){e=l.slice();c(i.val(),i,l);i.off("select2-selecting").on("select2-selecting",function(m){l=e.slice();d=true;c(m.val,i,l);i.val(m.val).trigger("change");$(document).on("keydown.select2",function(n){if(n.which===9){n.preventDefault();$("#macro-param-addpanel").focus()}});setTimeout(function(){$(document).off("keydown.select2")},1);$("#macro-param-addpanel").focus()})}})},80)}});g.trigger("change")}else{if(h.length){var g=$(f);if(g.find(h).length){if("@self".match("^"+g.val())){var k=$('<li class=""><a class="content-type-page"><span title="@self"><em>@self</em></span></a></li>');k.hover(function(){$(this).toggleClass("active")});k.click(function(){g.val("@self");g.trigger("change")});if(h.find('span[title="@self"]').length==0){g.off("keydown");g.keydown(function(l){if(l.which==13&&$("li.active").find('span[title="@self"]').length){l.stopPropagation();g.val("@self");$("div.aui-dropdown.aui-dropdown-left").remove();g.trigger("change")}});h.append(k)}$("a.no-results").parent().remove()}}}}}function c(i,j,g){$("#select2-drop-mask").remove();if(i.length>0&&d){var h=false;$.each(g,function(k,l){if(l.id===i){h=true;return false}});if(!h){var f={id:i,text:i};g.unshift(f)}}d=false;j.auiSelect2("destroy");j.auiSelect2({data:g,createSearchChoice:function(k,l){if($(l).filter(function(){return this.text.localeCompare(k)===0}).length===0){return{id:k,text:k}}}}).on("select2-focus",function(){j.data("select2").open();$("#select2-drop-mask").off();$("#select2-drop-mask").on("click",function(){c(i,j,g);$("#macro-param-addpanel").focus()})})}})();$(document).ready(function(){$(document).on("focusout","#macro-param-SpaceWithExcerpt",function(){setTimeout(function(){var a=$("#macro-param-SpaceWithExcerpt").val();if(!a){a=AJS.Meta.get("space-key");$("#macro-param-PageWithExcerpt").trigger("focusout")}$("#macro-param-PageWithExcerpt").attr("data-spacekey",a)},300)})});
}catch(e){WRMCB(e)};