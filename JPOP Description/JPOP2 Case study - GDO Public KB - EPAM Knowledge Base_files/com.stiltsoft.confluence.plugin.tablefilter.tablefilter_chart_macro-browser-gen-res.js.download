WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:chart~macro-browser-gen-res', location = 'build/chart~macro-browser.js' */
(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{21:function(t,e,i){var a,n;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s,o){"use strict";"object"==r(e)?t.exports=o(i(17)):(a=[i(17)],void 0===(n=function(t){return s.dimple=o(t),s.dimple}.apply(e,a))||(t.exports=n))}(this,(function(t){"use strict";var e={version:"2.2.0",plot:{},aggregateMethod:{},axis:function(i,a,n,r,s,o){this.chart=i,this.position=a,this.categoryFields=null==s?n:[].concat(s),this.measure=r,this.timeField=s,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this.autoRotateLabel=null==o||o,this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var t,e,i=[],a=!1;if(this.chart&&this.chart.series){for(t=0;t<this.chart.series.length;t+=1)(e=this.chart.series[t])[this.position]===this&&(e.data&&e.data.length>0?i=i.concat(e.data):a=!0);a&&this.chart.data&&(i=i.concat(this.chart.data))}return i},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var e,i,a,n,r,s,o;return null!==this.tickFormat&&void 0!==this.tickFormat?e=this._hasTimeField()?t.timeFormat(this.tickFormat):t.format(this.tickFormat):this.showPercent?e=t.format(".0%"):this.useLog&&null!==this.measure?e=function(e){var i=Math.floor(Math.abs(e),0).toString().length,a=Math.min(Math.floor((i-1)/3),4),n="kmBT".substring(a-1,a),r="0"===Math.round(e/Math.pow(1e3,a)*10).toString().slice(-1)?0:1;return 0===e?0:t.format(",."+r+"f")(e/Math.pow(1e3,a))+n}:null!==this.measure?(i=Math.floor(Math.abs(this._max),0).toString(),a=Math.floor(Math.abs(this._min),0).toString(),(n=Math.max(a.length,i.length))>3?(r=Math.min(Math.floor((n-1)/3),4),s="kmBT".substring(r-1,r),o=n-3*r<=1?1:0,e=function(e){return 0===e?0:t.format(",."+o+"f")(e/Math.pow(1e3,r))+s}):(o=Math.max(-(this._tick_step?Math.floor(Math.log(this._tick_step)/Math.LN10):0),0),e=t.format(",."+o+"f"))):e=function(t){return t},e},this._getTimePeriod=function(){var e=this.timePeriod,i=30,a=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(e=a/1e3<=i?t.timeSecond:a/6e4<=i?t.timeMinute:a/36e5<=i?t.timeHour:a/864e5<=i?t.timeHay:a/6048e5<=i?t.timeWeek:a/26298e5<=i?t.timeMonth:t.timeYear),e},this._getTooltipText=function(e,i){if(this._hasTimeField())i[this.position+"Field"][0]&&e.push(this.timeField+": "+this._getFormat()(i[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach((function(t,a){null!=t&&i[this.position+"Field"][a]&&e.push(t+(i[this.position+"Field"][a]!==t?": "+i[this.position+"Field"][a]:""))}),this);else if(this._hasMeasure())switch(this.position){case"x":e.push(this.measure+": "+this._getFormat()(i.width));break;case"y":e.push(this.measure+": "+this._getFormat()(i.height));break;case"p":e.push(this.measure+": "+this._getFormat()(i.angle)+" ("+t.format(".0%")(i.piePct)+")");break;default:e.push(this.measure+": "+this._getFormat()(i[this.position+"Value"]))}},this._getTopMaster=function(){var t=this;return null!==this.master&&void 0!==this.master&&(t=this.master._getTopMaster()),t},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(e){return null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(e)?Date.parse(e):new Date(e):t.timeParse(this.dateParseFormat)(e)},this._update=function(i){var a,n,r,s,o=[],l=this.ticks||10,c=function(t,i,a){var n,r,s=t.categoryFields[0],o=t._getAxisData(),l=s,c=!1,u=!0,h=null;for(n=0;n<o.length;n+=1)if(null!=(h=t._parseDate(o[n][s]))&&isNaN(h)){u=!1;break}return u||t.chart.series.forEach((function(e){e[i]===t&&e[a]._hasMeasure()&&(l=e[a].measure,c=!0)}),this),r=t._orderRules.concat({ordering:l,desc:c}),e._getOrderedList(o,s,r)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,"x"!==this.position||null!==this._scale&&!i){if("y"!==this.position||null!==this._scale&&!i)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"p"===this.position[0]&&null===this._scale?this.useLog?this._scale=t.scaleLog().range([0,360]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):this._scale=t.scaleLinear().range([0,360]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=t.scaleLinear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(c(t,"y","x"))}),this),this._scale=t.scalePoint().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=t.axisLeft().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisRight().scale(this._scale),this.ticks&&this._draw.ticks(l)}}else if(this._hasTimeField()?this._scale=t.scaleTime().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=t.scaleLog().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(o=c(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach((function(t){o=o.concat(c(t,"x","y"))}),this),this._scale=t.scalePoint().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(o.concat([""]))):this._scale=t.scaleLinear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=t.axisBottom().scale(this._scale),this.ticks&&this._draw.ticks(l);break;case 1:this._draw=t.axisTop().scale(this._scale),this.ticks&&this._draw.ticks(l)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach((function(t){t._scale=this._scale}),this),null!=i&&!1!==i||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(l).length>0)||"x"!==this.position&&"y"!==this.position||(n=(a=this._scale.ticks(l))[1]-a[0],r=((this._max-this._min)%n).toFixed(0),this._tick_step=n,0!==r&&(this._max=Math.ceil(this._max/n)*n,this._min=Math.floor(this._min/n)*n,this._update(!0))),s=null!=o&&o.length>0?this._scale.copy()(o[0]):this._min>0?this._scale.copy()(this._min):this._max<0?this._scale.copy()(this._max):this._scale.copy()(0),this._origin!==s&&(this._previousOrigin=null===this._origin?s:this._origin,this._origin=s),this},this.addGroupOrderRule=function(t,e){this._groupOrderRules.push({ordering:t,desc:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})}},chart:function(i,a){this.svg=i,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=a,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease=t.easeCubicInOut,this.staggerDraw=!1,this.transition={},this._group=i.append("g"),this._group.attr("class","dimple-chart"),this._gridlines_group=this._group.insert("g"),this._gridlines_group.attr("class","dimple-gridlines-group"),this._axis_group=this._group.insert("g"),this._axis_group.attr("class","dimple-axis-group"),this._tooltipGroup=null,this._assignedColors={},this._assignedClasses={},this._nextColor=0,this._nextClass=0,this._axisIndex=function(t,e){var i=0,a=0,n=-1;for(i=0;i<this.axes.length;i+=1){if(this.axes[i]===t){n=a;break}null!=e&&e[0]!==this.axes[i].position[0]||(a+=1)}return n},this._getAllData=function(){var t=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(t=t.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach((function(e){null!==e.data&&void 0!==e.data&&e.data.length>0&&(t=t.concat(e.data))})),t},this._getData=function(i,a,n,r,s,o,l,c,u,h){var d,p,g=[],f=function(t,e){var i=[];return null!==t&&(t._hasTimeField()?i.push(t._parseDate(e[t.timeField])):t._hasCategories()&&t.categoryFields.forEach((function(t){i.push(e[t])}),this)),i},m={x:!1,y:!1,z:!1,p:!1,c:!1},y={x:[],y:[]},x={x:[],y:[],z:[],p:[]},v={min:null,max:null},b={x:[],y:[],z:[],p:[]},_=[],w={},S={x:0,y:0,z:0,p:0},k="",T=[],C=[],P=[],F="",A=[],L="",M=[],I="",D=[],B=[],V=i,O=[];for(p in this.storyboard&&this.storyboard.categoryFields.length>0&&(k=this.storyboard.categoryFields[0],T=e._getOrderedList(V,k,this.storyboard._orderRules)),o&&o._hasCategories()&&o._hasMeasure()&&(F=o.categoryFields[0],A=e._getOrderedList(V,F,o._orderRules.concat([{ordering:o.measure,desc:!0}]))),l&&l._hasCategories()&&l._hasMeasure()&&(L=l.categoryFields[0],M=e._getOrderedList(V,L,l._orderRules.concat([{ordering:l.measure,desc:!0}]))),u&&u._hasCategories()&&u._hasMeasure()&&(I=u.categoryFields[0],D=e._getOrderedList(V,I,u._orderRules.concat([{ordering:u.measure,desc:!0}]))),V.length>0&&a&&a.length>0&&(B=[].concat(r),C=[],a.forEach((function(t){void 0!==V[0][t]&&C.push(t)}),this),u&&u._hasMeasure()?B.push({ordering:u.measure,desc:!0}):h&&h._hasMeasure()?B.push({ordering:h.measure,desc:!0}):c&&c._hasMeasure()?B.push({ordering:c.measure,desc:!0}):o&&o._hasMeasure()?B.push({ordering:o.measure,desc:!0}):l&&l._hasMeasure()&&B.push({ordering:l.measure,desc:!0}),P=e._getOrderedList(V,C,B)),V.sort((function(t,e){var i,a,n,r,s,o,l=0;if(""!==k&&(l=T.indexOf(t[k])-T.indexOf(e[k])),""!==F&&0===l&&(l=A.indexOf(t[F])-A.indexOf(e[F])),""!==L&&0===l&&(l=M.indexOf(t[L])-M.indexOf(e[L])),""!==I&&0===l&&(l=D.indexOf(t[I])-M.indexOf(e[I])),C&&C.length>0&&0===l)for(i=[].concat(C),l=0,n=0;n<P.length;n+=1){for(a=[].concat(P[n]),s=!0,o=!0,r=0;r<i.length;r+=1)s=s&&t[i[r]]===a[r],o=o&&e[i[r]]===a[r];if(s||o){l=s&&o?0:s?-1:1;break}}return l})),V.forEach((function(t){var e,i,r,s,d,p=-1,y=f(o,t),x=f(l,t),v=f(c,t),b=f(u,t),_=[];if(a&&0!==a.length)for(r=0;r<a.length;r+=1)void 0===t[a[r]]?_.push(a[r]):_.push(t[a[r]]);else _=["All"];for(e=_.join("/")+"_"+y.join("/")+"_"+x.join("/")+"_"+b.join("/")+"_"+v.join("/"),i=0;i<g.length;i+=1)if(g[i].key===e){p=i;break}-1===p&&(s={key:e,aggField:_,xField:y,xValue:null,xCount:0,yField:x,yValue:null,yCount:0,pField:b,pValue:null,pCount:0,zField:v,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],pValueList:[],cValueList:[],fill:{},stroke:{}},g.push(s),p=g.length-1),(d=function(e,i){var a,r,s=!0,o={value:0,count:1},l={value:0,count:1},c="";null!==i&&(a=i.getFrameValue(),i.categoryFields.forEach((function(e,i){i>0&&(c+="/"),c+=t[e],s=c===a}),this)),null!=e&&s&&(r=g[p],e._hasMeasure()&&null!==t[e.measure]&&void 0!==t[e.measure]&&(-1===r[e.position+"ValueList"].indexOf(t[e.measure])&&r[e.position+"ValueList"].push(t[e.measure]),isNaN(parseFloat(t[e.measure]))&&(m[e.position]=!0),o.value=r[e.position+"Value"],o.count=r[e.position+"Count"],l.value=t[e.measure],r[e.position+"Value"]=n(o,l),r[e.position+"Count"]+=1))})(o,this.storyboard),d(l,this.storyboard),d(c,this.storyboard),d(u,this.storyboard),d(h,this.storyboard)}),this),o&&o._hasCategories()&&o.categoryFields.length>1&&void 0!==y.x&&(O=[],l._hasMeasure()&&O.push({ordering:l.measure,desc:!0}),y.x=e._getOrderedList(V,o.categoryFields[1],o._groupOrderRules.concat(O))),l&&l._hasCategories()&&l.categoryFields.length>1&&void 0!==y.y&&(O=[],o._hasMeasure()&&O.push({ordering:o.measure,desc:!0}),y.y=e._getOrderedList(V,l.categoryFields[1],l._groupOrderRules.concat(O)),y.y.reverse()),g.forEach((function(t){null!==o&&(!0===m.x&&(t.xValue=t.xValueList.length),d=o._hasMeasure()&&o._hasCategories()?(x.x[t.xField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0):(x.x[t.xField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0),x.x[t.xField.join("/")]=d),null!==l&&(!0===m.y&&(t.yValue=t.yValueList.length),d=l._hasMeasure()&&l._hasCategories()?(x.y[t.yField.join("/")]||0)+(l._hasMeasure()?Math.abs(t.yValue):0):(x.y[t.yField.join("/")]||0)+(o._hasMeasure()?Math.abs(t.xValue):0),x.y[t.yField.join("/")]=d),null!==u&&(!0===m.p&&(t.pValue=t.pValueList.length),d=(x.p[t.pField.join("/")]||0)+(u._hasMeasure()?Math.abs(t.pValue):0),x.p[t.pField.join("/")]=d),null!==c&&(!0===m.z&&(t.zValue=t.zValueList.length),d=(x.z[t.zField.join("/")]||0)+(c._hasMeasure()?Math.abs(t.zValue):0),x.z[t.zField.join("/")]=d),null!==h&&((null===v.min||t.cValue<v.min)&&(v.min=t.cValue),(null===v.max||t.cValue>v.max)&&(v.max=t.cValue))}),this),x.x)x.x.hasOwnProperty(p)&&(S.x+=x.x[p]);for(p in x.y)x.y.hasOwnProperty(p)&&(S.y+=x.y[p]);for(p in x.p)x.p.hasOwnProperty(p)&&(S.p+=x.p[p]);for(p in x.z)x.z.hasOwnProperty(p)&&(S.z+=x.z[p]);return g.forEach((function(e){var i,a,n,r,d=function(t,i,a){var n,r,o,l,c;null!=t&&(l=t.position,t._hasCategories()?t._hasMeasure()?(n=e[t.position+"Field"].join("/"),r=t.showPercent?x[t.position][n]/S[t.position]:x[t.position][n],-1===_.indexOf(n)&&(w[n]=r+(_.length>0?w[_[_.length-1]]:0),_.push(n)),o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!s?r:w[n],e[a]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&r<=0?r:0)):(e[l]=e["c"+l]=e[l+"Field"][0],e[a]=1,void 0!==y[l]&&null!==y[l]&&y[l].length>=2&&(e[l+"Offset"]=y[l].indexOf(e[l+"Field"][1]),e[a]=1/y[l].length)):(r=t.showPercent?e[l+"Value"]/x[i][e[i+"Field"].join("/")]:e[l+"Value"],n=e[i+"Field"].join("/")+(e[l+"Value"]>=0),c=b[l][n]=(null===b[l][n]||void 0===b[l][n]||"z"===l||"p"===l?0:b[l][n])+r,o=e[l+"Bound"]=e["c"+l]="x"!==l&&"y"!==l||!s?r:c,e[a]=r,e[l]=o-("x"===l&&r>=0||"y"===l&&r<=0?r:0)))};d(o,"y","width"),d(l,"x","height"),d(c,"z","r"),d(u,"p","angle"),null!==h&&null!==v.min&&null!==v.max&&(v.min===v.max&&(v.min-=.5,v.max+=.5),v.min=h.overrideMin||v.min,v.max=h.overrideMax||v.max,e.cValue=e.cValue>v.max?v.max:e.cValue<v.min?v.min:e.cValue,r=(n=t.scaleLinear().range([0,null===h.colors||1===h.colors.length?1:h.colors.length-1]).domain([v.min,v.max])(e.cValue))-Math.floor(n),e.cValue===v.max&&(r=1),h.colors&&1===h.colors.length?(i=t.rgb(h.colors[0]),a=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)):h.colors&&h.colors.length>1?(i=t.rgb(h.colors[Math.floor(n)]),a=t.rgb(h.colors[Math.ceil(n)])):(i=t.rgb("white"),a=t.rgb(this.getColor(e.aggField.slice(-1)[0]).fill)),i.r=Math.floor(i.r+(a.r-i.r)*r),i.g=Math.floor(i.g+(a.g-i.g)*r),i.b=Math.floor(i.b+(a.b-i.b)*r),e.fill=i.toString(),e.stroke=i.darker(.5).toString())}),this),g},this._getDelay=function(t,i,a){return function(n){var r=0;return a&&i.staggerDraw&&(a.x._hasCategories()?r=e._helpers.cx(n,i,a)/i._widthPixels()*t:a.y._hasCategories()&&(r=(1-e._helpers.cy(n,i,a)/i._heightPixels())*t)),r}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach((function(t){var e,i,a,n,r,s=t.data||this.data||[],o=[].concat(t.categoryFields||"All"),l=this._getData(s,o,t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),c=[],u={},h=t.startAngle*(Math.PI/180)||0,d=(t.endAngle||360)*(Math.PI/180);if(h>d&&(h-=2*Math.PI),t.p&&o.length>0){if(t.x&&t.y){for(o.pop(),c=this._getData(s,["__dimple_placeholder__"].concat(o),t.aggregate,t._orderRules,t._isStacked(),t.x,t.y,t.z,t.p,t.c),e=0;e<l.length;e+=1)for((a=["__dimple_placeholder__"].concat(l[e].aggField)).pop(),t.x&&t.x._hasCategories()&&(a=a.concat(l[e].xField)),t.y&&t.y._hasCategories()&&(a=a.concat(l[e].yField)),n=a.join("|"),i=0;i<c.length;i+=1)if(r=[].concat(c[i].aggField),t.x&&t.x._hasCategories()&&(r=r.concat(c[i].xField)),t.y&&t.y._hasCategories()&&(r=r.concat(c[i].yField)),n===r.join("|")){l[e].xField=c[i].xField,l[e].xValue=c[i].xValue,l[e].xCount=c[i].xCount,l[e].yField=c[i].yField,l[e].yValue=c[i].yValue,l[e].yCount=c[i].yCount,l[e].zField=c[i].zField,l[e].zValue=c[i].zValue,l[e].zCount=c[i].zCount,l[e].x=c[i].x,l[e].y=c[i].y,l[e].r=c[i].r,l[e].xOffset=c[i].xOffset,l[e].yOffset=c[i].yOffset,l[e].width=c[i].width,l[e].height=c[i].height,l[e].cx=c[i].cx,l[e].cy=c[i].cy,l[e].xBound=c[i].xBound,l[e].yBound=c[i].yBound,l[e].xValueList=c[i].xValueList,l[e].yValueList=c[i].yValueList,l[e].zValueList=c[i].zValueList,l[e].cValueList=c[i].cValueList,l[e].pieKey=c[i].key,l[e].value=l.pValue,u[c[i].key]||(u[c[i].key]={total:0,angle:h}),u[c[i].key].total+=l[e].pValue;break}}else for(e=0;e<l.length;e+=1)l[e].pieKey="All",l[e].value=l.pValue,u[l[e].pieKey]||(u[l[e].pieKey]={total:0,angle:h}),u[l[e].pieKey].total+=l[e].pValue;for(e=0;e<l.length;e+=1)0===u[l[e].pieKey].total?l[e].piePct=0:l[e].piePct=l[e].pValue/u[l[e].pieKey].total,l[e].startAngle=u[l[e].pieKey].angle,l[e].endAngle=l[e].startAngle+l[e].piePct*(d-h),u[l[e].pieKey].angle=l[e].endAngle}t._positionData=l}),this)},this._handleTransition=function(t,i,a,n){var r=null;return 0===i?r=t:(r=t.transition().duration(i).delay(a._getDelay(i,a,n)),e._ease(r,a.ease)),r},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(i){null!==i._eventHandlers&&i._eventHandlers.length>0&&i._eventHandlers.forEach((function(a){var n,r=function(n){var r=new e.eventArgs;null!==i.chart.storyboard&&(r.frameValue=i.chart.storyboard.getFrameValue()),r.seriesValue=n.aggField,r.xValue=n.x,r.yValue=n.y,r.zValue=n.z,r.pValue=n.p,r.colorValue=n.cValue,r.seriesShapes=i.shapes,r.selectedShape=t.select(this),a.handler(r)};if(null!==a.handler&&"function"==typeof a.handler)if(null!==i._markers&&void 0!==i._markers)for(n in i._markers)i._markers.hasOwnProperty(n)&&i._markers[n].on(a.event,r);else i.shapes.on(a.event,r)}),this)},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this.addAxis=function(t,i,a,n){var r,s=null,o=null;if(null!=i&&(i=[].concat(i)),"string"==typeof t||t instanceof String)s=new e.axis(this,t,i,a,n),this.axes.push(s);else{if(o=t,(s=new e.axis(this,o.position,i,a,n))._hasMeasure()!==o._hasMeasure()?r="You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.":s._hasTimeField()!==o._hasTimeField()?r="You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.":(null===s.categoryFields||void 0===s.categoryFields?0:s.categoryFields.length)!==(null===o.categoryFields||void 0===o.categoryFields?0:o.categoryFields.length)&&(r="You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type."),r)throw r;o._slaves.push(s)}return s},this.addCategoryAxis=function(t,e){return this.addAxis(t,e,null)},this.addColorAxis=function(t,e){var i=this.addAxis("c",null,t);return i.colors=null==e?null:[].concat(e),i},this.addLegend=function(t,i,a,n,r,s){s=null==s?this.series:[].concat(s),r=null==r?"left":r;var o=new e.legend(this,t,i,a,n,r,s);return this.legends.push(o),o},this.addLogAxis=function(t,e,i){var a=this.addAxis(t,null,e,null);return null!=i&&(a.logBase=i),a.useLog=!0,a},this.addMeasureAxis=function(t,e){return this.addAxis(t,null,e)},this.addPctAxis=function(t,e,i){var a=null;return(a=null!=i?this.addAxis(t,i,e):this.addMeasureAxis(t,e)).showPercent=!0,a},this.addSeries=function(t,i,a){null!=a||(a=this.axes),null!=i||(i=e.plot.bubble);var n,r=null,s=null,o=null,l=null,c=null;return a.forEach((function(t){null!==t&&i.supportedAxes.indexOf(t.position)>-1&&(null===r&&"x"===t.position[0]?r=t:null===s&&"y"===t.position[0]?s=t:null===o&&"z"===t.position[0]?o=t:null===l&&"c"===t.position[0]?l=t:null===l&&"p"===t.position[0]&&(c=t))}),this),t&&(t=[].concat(t)),n=new e.series(this,t,r,s,o,l,c,i,e.aggregateMethod.sum,i.stacked),this.series.push(n),n},this.addTimeAxis=function(t,e,i,a){var n=this.addAxis(t,null,null,e);return n.tickFormat=a,n.dateParseFormat=i,n},this.assignClass=function(t,e){return this._assignedClasses[t]=e,this._assignedClasses[t]},this.assignColor=function(t,i,a,n){return this._assignedColors[t]=new e.color(i,a,n),this._assignedColors[t]},this.customClassList={axisLine:"dimple-custom-axis-line",axisLabel:"dimple-custom-axis-label",axisTitle:"dimple-custom-axis-title",tooltipBox:"dimple-custom-tooltip-box",tooltipLabel:"dimple-custom-tooltip-label",tooltipDropLine:"dimple-custom-tooltip-dropline",lineMarker:"dimple-custom-line-marker",lineMarkerCircle:"dimple-custom-line-marker-circle",legendLabel:"dimple-custom-legend-label",legendKey:"dimple-custom-legend-key",areaSeries:"dimple-custom-series-area",barSeries:"dimple-custom-series-bar",bubbleSeries:"dimple-custom-series-bubble",lineSeries:"dimple-custom-series-line",pieSeries:"dimple-custom-series-pie",gridline:"dimple-custom-gridline",colorClasses:["dimple-custom-format-1","dimple-custom-format-2","dimple-custom-format-3","dimple-custom-format-4","dimple-custom-format-5","dimple-custom-format-6","dimple-custom-format-7","dimple-custom-format-8","dimple-custom-format-9","dimple-custom-format-10"]},this.defaultColors=[new e.color("#80B1D3"),new e.color("#FB8072"),new e.color("#FDB462"),new e.color("#B3DE69"),new e.color("#FFED6F"),new e.color("#BC80BD"),new e.color("#8DD3C7"),new e.color("#CCEBC5"),new e.color("#FFFFB3"),new e.color("#BEBADA"),new e.color("#FCCDE5"),new e.color("#D9D9D9")],this.draw=function(e,i){e=e||0;var a,n,r=null,s=null,o=!1,l=!1,c=this._xPixels(),u=this._yPixels(),h=this._widthPixels(),d=this._heightPixels();return null!=i&&!1!==i||this._getSeriesData(),this.axes.forEach((function(t){t._scale=null}),this),this.axes.forEach((function(t){if(t._min=0,t._max=0,n=[],t._hasMeasure()){var e=!1;this.series.forEach((function(i){if(i._deepMatch(t)){var a=i._axisBounds(t.position);t._min>a.min&&(t._min=a.min),t._max<a.max&&(t._max=a.max),e=!0}}),this),e||this._getAllData().forEach((function(e){t._min>e[t.measure]&&(t._min=e[t.measure]),t._max<e[t.measure]&&(t._max=e[t.measure])}),this)}else t._hasTimeField()?(t._min=null,t._max=null,this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].timeField&&void 0!==e[t.position].timeField&&-1===n.indexOf(e[t.position].timeField)&&n.push(e[t.position].timeField)}),this),t._getAxisData().forEach((function(e){n.forEach((function(i){var a=t._parseDate(e[i]);(null===t._min||a<t._min)&&(t._min=a),(null===t._max||a>t._max)&&(t._max=a)}),this)}),this)):t._hasCategories()&&(t._min=0,a=[],this.series.forEach((function(e){e._deepMatch(t)&&null!==e[t.position].categoryFields[0]&&void 0!==e[t.position].categoryFields[0]&&-1===n.indexOf(e[t.position].categoryFields[0])&&n.push(e[t.position].categoryFields[0])}),this),t._getAxisData().forEach((function(t){n.forEach((function(e){-1===a.indexOf(t[e])&&a.push(t[e])}),this)}),this),t._max=a.length);null!==t._slaves&&void 0!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(e){e._min=t._min,e._max=t._max}),this),t._update(),null===r&&"x"===t.position?r=t:null===s&&"y"===t.position&&(s=t)}),this),this.axes.forEach((function(i){var a=!1,n=null,p=0,g=null,f=!1,m=0,y={l:null,t:null,r:null,b:null},x=0,v=0,b="",_=this,w=function(t){return null===n||0===e||a?t:_._handleTransition(t,e,_)},S=function(){var e=t.select(this).selectAll("text");return!i.measure&&i._max>0&&("x"===i.position?e.attr("x",h/i._max/2):"y"===i.position&&e.attr("y",d/i._max*-1/2)),i.categoryFields&&i.categoryFields.length>0&&(i!==r||null!==s.categoryFields&&0!==s.categoryFields.length||e.attr("y",u+d-s._scale(0)+9),i!==s||null!==r.categoryFields&&0!==r.categoryFields.length||e.attr("x",-1*(r._scale(0)-c)-9)),this},k=function(e){return function(){var i=t.select(this).attr("class")||"";return-1===i.indexOf(e)&&(i+=" "+e),i.trim()}};null===i.gridlineShapes?(i.showGridlines||null===i.showGridlines&&!i._hasCategories()&&(!o&&"x"===i.position||!l&&"y"===i.position))&&(i.gridlineShapes=this._gridlines_group.append("g").attr("class","dimple-gridline"),"x"===i.position?o=!0:l=!0):"x"===i.position?o=!0:l=!0,null===i.shapes&&(i.shapes=this._axis_group.append("g").attr("class","dimple-axis dimple-axis-"+i.position).each((function(){_.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),a=!0),i===r&&null!==s?(n="translate(0, "+(null===s.categoryFields||0===s.categoryFields.length?s._scale(0):u+d)+")",g="translate(0, "+(i===r?u+d:u)+")",p=-d):i===s&&null!==r?(n="translate("+(null===r.categoryFields||0===r.categoryFields.length?r._scale(0):c)+", 0)",g="translate("+(i===s?c:c+h)+", 0)",p=-h):"x"===i.position?(g=n="translate(0, "+(i===r?u+d:u)+")",p=-d):"y"===i.position&&(g=n="translate("+(i===s?c:c+h)+", 0)",p=-h),null!==n&&null!==i._draw&&(i._hasTimeField()?w(i.shapes).call(i._draw.ticks(i._getTimePeriod(),i.timeInterval).tickFormat(i._getFormat())).attr("transform",n).each(S):i.useLog?w(i.shapes).call(i._draw.ticks(4,i._getFormat())).attr("transform",n).each(S):w(i.shapes).call(i._draw.tickFormat(i._getFormat())).attr("transform",n).each(S),null!==i.gridlineShapes&&w(i.gridlineShapes).call(i._draw.tickSize(p,0,0).tickFormat("")).attr("transform",g)),w(i.shapes.selectAll("text")).attr("class",k(_.customClassList.axisLabel)).call((function(t){_.noFormats||t.style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),w(i.shapes.selectAll("path, line")).attr("class",k(_.customClassList.axisLine)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","black").style("shape-rendering","crispEdges")})),null!==i.gridlineShapes&&(i.gridlineShapes.selectAll("path").remove(),w(i.gridlineShapes.selectAll("line")).attr("class",k(_.customClassList.gridline)).call((function(t){_.noFormats||t.style("fill","none").style("stroke","lightgray").style("opacity",.8)}))),null!==i.measure&&void 0!==i.measure||(i.autoRotateLabel?i===r?(m=0,i.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/i.shapes.selectAll("text").nodes().length?(f=!0,i.shapes.selectAll("text").style("text-anchor","start").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+e.x+","+(e.y+e.height/2)+") translate(-5, 0)")}))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===i.position&&(m=0,i.shapes.selectAll("text").each((function(){var t=this.getComputedTextLength();m=t>m?t:m})),m>h/i.shapes.selectAll("text").nodes().length?(f=!0,i.shapes.selectAll("text").style("text-anchor","end").each((function(){var e=this.getBBox();t.select(this).attr("transform","rotate(90,"+(e.x+e.width)+","+(e.y+e.height/2)+") translate(5, 0)")}))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):(f=!1,i.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))),null!==i.titleShape&&void 0!==i.titleShape&&i.titleShape.remove(),i.shapes.selectAll("text").each((function(){var t=this.getBBox();(null===y.l||-9-t.width<y.l)&&(y.l=-9-t.width),(null===y.r||t.x+t.width>y.r)&&(y.r=t.x+t.width),f?((null===y.t||t.y+t.height-t.width<y.t)&&(y.t=t.y+t.height-t.width),(null===y.b||t.height+t.width>y.b)&&(y.b=t.height+t.width)):((null===y.t||t.y<y.t)&&(y.t=t.y),(null===y.b||9+t.height>y.b)&&(y.b=9+t.height))})),"x"===i.position?(v=i===r?u+d+y.b+5:u+y.t-10,x=c+h/2):"y"===i.position&&(b="rotate(270, "+(x=i===s?c+y.l-10:c+h+y.r+20)+", "+(v=u+d/2)+")"),i.hidden||"x"!==i.position&&"y"!==i.position||null===i.title||(i.titleShape=this._axis_group.append("text").attr("class","dimple-axis dimple-title "+_.customClassList.axisTitle+" dimple-axis-"+i.position),i.titleShape.attr("x",x).attr("y",v).attr("text-anchor","middle").attr("transform",b).text(void 0!==i.title?i.title:null===i.categoryFields||void 0===i.categoryFields||0===i.categoryFields.length?i.measure:i.categoryFields.join("/")).each((function(){_.noFormats||t.select(this).style("font-family",i.fontFamily).style("font-size",i._getFontSize())})),i===r?i.titleShape.each((function(){t.select(this).attr("y",v+this.getBBox().height/1.65)})):i===s&&i.titleShape.each((function(){t.select(this).attr("x",x+this.getBBox().height/1.65)})))}),this),this.series.forEach((function(t){t.plot.draw(this,t,e),this._registerEventHandlers(t)}),this),this.legends.forEach((function(t){t._draw()}),this),this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getClass=function(t){return this._assignedClasses[t]||(this._assignedClasses[t]=this.customClassList.colorClasses[this._nextClass],this._nextClass=(this._nextClass+1)%this.customClassList.colorClasses.length),this._assignedClasses[t]},this.getColor=function(t){return null!==this._assignedColors[t]&&void 0!==this._assignedColors[t]||(this._assignedColors[t]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[t]},this.setBounds=function(t,i,a,n){return this.x=t,this.y=i,this.width=a,this.height=n,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this.draw(0,!0),this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return e._parseYPosition(this.height,this.svg.node())},this},this.setMargins=function(t,i,a,n){return this.x=t,this.y=i,this.width=0,this.height=0,this._xPixels=function(){return e._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return e._parentWidth(this.svg.node())-this._xPixels()-e._parseXPosition(a,this.svg.node())},this._heightPixels=function(){return e._parentHeight(this.svg.node())-this._yPixels()-e._parseYPosition(n,this.svg.node())},this},this.setStoryboard=function(t,i){return this.storyboard=new e.storyboard(this,t),null!=i&&(this.storyboard.onTick=i),this.storyboard}},color:function(e,i,a){this.fill=e,this.stroke=null==i?t.rgb(e).darker(.5).toString():i,this.opacity=null==a?.8:a},eventArgs:function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.pValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},legend:function(i,a,n,r,s,o,l){this.chart=i,this.series=l,this.x=a,this.y=n,this.width=r,this.height=s,this.horizontalAlign=o,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(){var i,a=this._getEntries(),n=0,r=0,s=0,o=0,l=this;this.shapes&&this.shapes.remove(),(i=this.chart._group.selectAll(".dimple-dont-select-any").data(a).enter().append("g").attr("class",(function(t){return"dimple-legend "+e._createClass(t.aggField)})).attr("opacity",1)).append("text").attr("class",(function(t){return"dimple-legend dimple-legend-text "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendLabel})).text((function(t){return t.key})).call((function(t){l.chart.noFormats||t.style("font-family",l.fontFamily).style("font-size",l._getFontSize()).style("shape-rendering","crispEdges")})).each((function(){var t=this.getBBox();t.width>n&&(n=t.width),t.height>r&&(r=t.height)})),i.append("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)})).attr("height",9).attr("width",15),r=(r<9?9:r)+l._getVerticalPadding(),n+=15+l._getHorizontalPadding(),i.each((function(i){s+n>l._widthPixels()&&(s=0,o+=r),o>l._heightPixels()?t.select(this).remove():(t.select(this).select("text").attr("x","left"===l.horizontalAlign?l._xPixels()+15+5+s:l._xPixels()+(l._widthPixels()-s-n)+15+5).attr("y",(function(){return l._yPixels()+o+this.getBBox().height/1.65})).attr("width",l._widthPixels()).attr("height",l._heightPixels()),t.select(this).select("rect").attr("class",(function(t){return"dimple-legend dimple-legend-key "+e._createClass(t.aggField)+" "+l.chart.customClassList.legendKey+" "+t.css})).attr("x","left"===l.horizontalAlign?l._xPixels()+s:l._xPixels()+(l._widthPixels()-s-n)).attr("y",l._yPixels()+o).attr("height",9).attr("width",15).call((function(t){l.chart.noFormats||t.style("fill",i.fill).style("stroke",i.stroke).style("opacity",i.opacity).style("shape-rendering","crispEdges")})),s+=n)})),this.shapes=i},this._getEntries=function(){var t=[];return this.series&&this.series.forEach((function(e){e._positionData.forEach((function(i){var a,n=-1,r=e.plot.grouped&&!e.x._hasCategories()&&!e.y._hasCategories()&&i.aggField.length<2?"All":i.aggField.slice(-1)[0];for(a=0;a<t.length;a+=1)if(t[a].key===r){n=a;break}-1===n&&e.chart._assignedColors[r]&&(t.push({key:r,fill:e.chart._assignedColors[r].fill,stroke:e.chart._assignedColors[r].stroke,opacity:e.chart._assignedColors[r].opacity,css:e.chart._assignedClasses[r],series:e,aggField:i.aggField}),n=t.length-1)}))}),this),t},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getHorizontalPadding=function(){return isNaN(this.horizontalPadding)?20:this.horizontalPadding},this._getVerticalPadding=function(){return isNaN(this.verticalPadding)?2:this.verticalPadding},this._heightPixels=function(){return e._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return e._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return e._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return e._parseYPosition(this.y,this.chart.svg.node())}},series:function(t,e,i,a,n,r,s,o,l,c){this.chart=t,this.x=i,this.y=a,this.z=n,this.c=r,this.p=s,this.plot=o,this.categoryFields=e,this.aggregate=l,this.stacked=c,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._group=t._group.append("g"),this._group.attr("class","dimple-series-group-"+t.series.length),this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(t){var e,i,a,n={min:0,max:0},r=null,s=null,o=[],l=0,c=this._positionData;return"x"===t?(r=this.x,s=this.y):"y"===t?(r=this.y,s=this.x):"z"===t?r=this.z:"p"===t?r=this.p:"c"===t&&(r=this.c),r.showPercent?c.forEach((function(t){t[r.position+"Bound"]<n.min&&(n.min=t[r.position+"Bound"]),t[r.position+"Bound"]>n.max&&(n.max=t[r.position+"Bound"])}),this):null===s||null===s.categoryFields||0===s.categoryFields.length?c.forEach((function(t){!this._isStacked()||"x"!==r.position&&"y"!==r.position?(t[r.position+"Value"]<n.min&&(n.min=t[r.position+"Value"]),t[r.position+"Value"]>n.max&&(n.max=t[r.position+"Value"])):t[r.position+"Value"]<0?n.min=n.min+t[r.position+"Value"]:n.max=n.max+t[r.position+"Value"]}),this):(e=r.position+"Value",i=s.position+"Field",a=[],c.forEach((function(t){var n=t[i].join("/"),r=a.indexOf(n);-1===r&&(a.push(n),r=a.length-1),void 0===o[r]&&(o[r]={min:0,max:0},r>=l&&(l=r+1)),this.stacked?t[e]<0?o[r].min=o[r].min+t[e]:o[r].max=o[r].max+t[e]:(t[e]<o[r].min&&(o[r].min=t[e]),t[e]>o[r].max&&(o[r].max=t[e]))}),this),o.forEach((function(t){void 0!==t&&(t.min<n.min&&(n.min=t.min),t.max>n.max&&(n.max=t.max))}),this)),n},this._deepMatch=function(t){var e=!1;return this[t.position]===t?e=!0:void 0!==t._slaves&&null!==t._slaves&&t._slaves.length>0&&t._slaves.forEach((function(t){e=e||this._deepMatch(t)}),this),e},this._dropLineOrigin=function(){var t=0,e=0,i={x:null,y:null},a={x:null,y:null};return this.chart.axes.forEach((function(t){"x"===t.position&&null===a.x?t._hasTimeField()?a.x=this.chart._xPixels():a.x=t._origin:"y"===t.position&&null===a.y&&(t._hasTimeField()?a.y=this.chart._yPixels()+this.chart._heightPixels():a.y=t._origin)}),this),this.chart.axes.forEach((function(n){"x"!==n.position||this.x.hidden?"y"!==n.position||this.y.hidden||(this._deepMatch(n)&&(0===e?i.x=a.x:1===e&&(i.x=this.chart._xPixels()+this.chart._widthPixels())),e+=1):(this._deepMatch(n)&&(0===t?i.y=a.y:1===t&&(i.y=this.chart._yPixels())),t+=1)}),this),i},this._getTooltipFontSize=function(){return this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(t,e){this._eventHandlers.push({event:t,handler:e})},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getTooltipText=function(t){var e=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach((function(i,a){null!=i&&null!==t.aggField[a]&&void 0!==t.aggField[a]&&e.push(i+(t.aggField[a]!==i?": "+t.aggField[a]:""))}),this),this.p?(this.x&&this.x._hasCategories()&&this.x._getTooltipText(e,t),this.y&&this.y._hasCategories()&&this.y._getTooltipText(e,t),this.z&&this.z._hasCategories()&&this.z._getTooltipText(e,t),this.p._getTooltipText(e,t)):(this.x&&this.x._getTooltipText(e,t),this.y&&this.y._getTooltipText(e,t),this.z&&this.z._getTooltipText(e,t)),this.c&&this.c._getTooltipText(e,t),e.filter((function(t,i){return e.indexOf(t)===i}))}},storyboard:function(t,e){null!=e&&(e=[].concat(e)),this.chart=t,this.categoryFields=e,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(){var e=this,i=0;e.storyLabel||(e.chart.axes.forEach((function(t){"x"===t.position&&(i+=1)}),e),e.storyLabel=e.chart._group.append("text").attr("class","dimple-storyboard-label").attr("opacity",1).attr("x",e.chart._xPixels()+.01*e.chart._widthPixels()).attr("y",e.chart._yPixels()+(e.chart._heightPixels()/35>10?e.chart._heightPixels()/35:10)*(i>1?1.25:-1)).call((function(i){t.noFormats||i.style("font-family",e.fontFamily).style("font-size",e._getFontSize())}))),e.storyLabel.text(e.categoryFields.join("\\")+": "+e.getFrameValue())},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach((function(t){var e="";null!==this.categoryFields&&(this.categoryFields.forEach((function(i,a){a>0&&(e+="/"),e+=t[i]}),this),-1===this._categories.indexOf(e)&&(this._categories.push(e),this._categories.length))}),this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){return this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(t){this._frame=t%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(t,e){this._orderRules.push({ordering:t,desc:e})},this.getFrameValue=function(){var t=null;return this._frame>=0&&this._getCategories().length>this._frame&&(t=this._getCategories()[this._frame]),t},this.goToFrame=function(t){if(this._getCategories().length>0){var e=this._getCategories().indexOf(t);this._goToFrameIndex(e)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(t){return function(){t._goToFrameIndex(t._frame+1),null!==t.onTick&&t.onTick(t.getFrameValue()),t._drawText(t.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}}};return e.aggregateMethod.avg=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),t.count=null===t.count||void 0===t.count?1:parseFloat(t.count),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),e.count=null===e.count||void 0===e.count?1:parseFloat(e.count),(t.value*t.count+e.value*e.count)/(t.count+e.count)},e.aggregateMethod.count=function(t,e){return t.count=null===t.count||void 0===t.count?0:parseFloat(t.count),e.count=null===e.count||void 0===e.count?0:parseFloat(e.count),t.count+e.count},e.aggregateMethod.max=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value>e.value?t.value:e.value},e.aggregateMethod.min=function(t,e){return null===t.value?parseFloat(e.value):parseFloat(t.value)<parseFloat(e.value)?parseFloat(t.value):parseFloat(e.value)},e.aggregateMethod.sum=function(t,e){return t.value=null===t.value||void 0===t.value?0:parseFloat(t.value),e.value=null===e.value||void 0===e.value?0:parseFloat(e.value),t.value+e.value},e.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,a,n){var r,s,o,l,c,u,h,d,p,g,f,m,y,x,v,b,_,w,S,k,T,C,P,F,A=a._positionData,L=[],M=null,I="dimple-series-"+i.series.indexOf(a),D=a.x._hasCategories()||a.y._hasCategories()?0:1,B=!1,V={},O=[],$=[],E=function(){return function(i,a,n,r){t.select(a).style("opacity",1),e._showPointTooltip(i,a,n,r)}},N=function(i){return function(a,n,r,s){t.select(n).style("opacity",s.lineMarkers||i.data.length<2?e._helpers.opacity(a,r,s):0),e._removeTooltip(a,n,r,s)}},H=function(t,r){e._drawMarkers(t,i,a,n,I,B,E(),N(t),r)},z=function(t,n){var r;return"step"===a.interpolation&&a[t]._hasCategories()?(r=e._helpers[t](n,i,a)+("y"===t?e._helpers.height(n,i,a):0),a[t].categoryFields.length<2&&(r+=("y"===t?1:-1)*e._helpers[t+"Gap"](i,a))):r=e._helpers["c"+t](n,i,a),parseFloat(r)},G=function(i,n){var r=t.line().x((function(t){return a.x._hasCategories()||!n?t.x:a.x[n]})).y((function(t){return a.y._hasCategories()||!n?t.y:a.y[n]}));return e._interpolate(r,i),r},W=function(t,e){return parseFloat(t)-parseFloat(e)},R=function(t,e){return parseFloat(t.x)-parseFloat(e.x)},j=function(t,e,i){var a,n,r=e[e.length-1],s=9999,o=r;for(a=0;a<t.length;a+=1)t[a].x===r.x&&t[a].y===r.y||(n=180-Math.atan2(t[a].x-r.x,t[a].y-r.y)*(180/Math.PI))>i&&n<s&&(o=t[a],s=n);return e.push(o),s};for(r="step"===a.interpolation?"step-after":a.interpolation,f=e._getSeriesOrder(a.data||i.data,a),a.c&&(a.x._hasCategories()&&a.y._hasMeasure()||a.y._hasCategories()&&a.x._hasMeasure())&&(B=!0),a.x._hasCategories()?(P="x",F="y"):a.y._hasCategories()&&(P="y",F="x"),s=0;s<A.length;s+=1){for(c=[],h=-1,l=D;l<A[s].aggField.length;l+=1)c.push(A[s].aggField[l]);for(u=e._createClass(c),l=0;l<L.length;l+=1)if(L[l].keyString===u){h=l;break}-1===h&&(h=L.length,L.push({key:c,keyString:u,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:P&&A[s][P+"Field"]&&A[s][P+"Field"].length>=2?A[s][P+"Field"][0]:"All"})),L[h].data.push(A[s])}for(f&&L.sort((function(t,i){return e._arrayIndexCompare(f,t.key,i.key)})),s=0;s<L.length;s+=1){for(L[s].data.sort(e._getSeriesSortPredicate(i,a,f)),o=0;o<L[s].data.length;o+=1)L[s].points.push({x:z("x",L[s].data[o]),y:z("y",L[s].data[o])}),P&&(V[L[s].group]||(V[L[s].group]={}),V[L[s].group][L[s].points[L[s].points.length-1][P]]=a[F]._origin);m=L[s].points,"step"===a.interpolation&&m.length>1&&P&&(a.x._hasCategories()?(m.push({x:2*m[m.length-1].x-m[m.length-2].x,y:m[m.length-1].y}),V[L[s].group][m[m.length-1][P]]=a[F]._origin):a.y._hasCategories()&&(m=[{x:m[0].x,y:2*m[0].y-m[1].y}].concat(m),V[L[s].group][m[0][P]]=a[F]._origin,L[s].points=m))}for(v in V)if(V.hasOwnProperty(v)){for(b in O[v]=[],V[v])V[v].hasOwnProperty(b)&&O[v].push(parseFloat(b));O[v].sort(W)}for(s=0;s<L.length;s+=1){if(m=L[s].points,_=L[s].group,y=[],$=[],B&&e._addGradient(L[s].key,"fill-area-gradient-"+L[s].keyString,a.x._hasCategories()?a.x:a.y,A,i,n,"fill"),O[_]&&O[_].length>0)for(o=0,l=0;o<O[_].length;o+=1)O[_][o]>=m[0][P]&&O[_][o]<=m[m.length-1][P]&&((x={})[P]=O[_][o],x[F]=V[_][O[_][o]],y.push(x),m[l][P]>O[_][o]?$.push(x):($.push(m[l]),V[L[s].group][O[_][o]]=m[l][F],l+=1));else if(a._orderRules&&a._orderRules.length>0)$=m.concat(m[0]);else{m=m.sort(R),$.push(m[0]),C=0;do{C=j(m,$,C)}while($.length<=m.length&&($[0].x!==$[$.length-1].x||$[0].y!==$[$.length-1].y))}y=y.reverse(),w=G(r,"_previousOrigin")($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_previousOrigin")(y),T=-1===(k=G("linear","_previousOrigin")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].entry=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=G(r)($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r)(y),T=-1===(k=G("linear")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].update=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),w=G(r,"_origin")($),S=G("step-after"===r?"step-before":"step-before"===r?"step-after":r,"_origin")(y),T=-1===(k=G("linear","_origin")($)).indexOf("L")?void 0:k.indexOf("L"),L[s].exit=w+(S&&S.length>0?"L"+S.substring(1):"")+(k&&k.length>0?"L"+k.substring(1,T):0),L[s].color=i.getColor(L[s].key.length>0?L[s].key[L[s].key.length-1]:"All"),L[s].css=i.getClass(L[s].key.length>0?L[s].key[L[s].key.length-1]:"All")}i._tooltipGroup&&i._tooltipGroup.remove(),d=(M=a.shapes?a.shapes.data(L,(function(t){return t.key})):a._group.selectAll("."+I).data(L,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return I+" dimple-line "+t.keyString+" "+i.customClassList.areaSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return B?1:t.color.opacity})).style("fill",(function(t){return B?"url(#"+e._createClass(["fill-area-gradient-"+t.keyString])+")":t.color.fill})).style("stroke",(function(t){return B?"url(#"+e._createClass(["stroke-area-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",a.lineWeight)})).each((function(t){t.markerData=t.data,H(t,this)})),p=i._handleTransition(M.merge(d),n,i).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,H(t,this)})),g=i._handleTransition(M.exit(),n,i).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],H(t,this)})),e._postDrawHandling(a,p,g,n),a.shapes=a._group.selectAll("."+I)}},e.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(t,i,a){var n,r,s,o=i._positionData,l=null,c=["dimple-series-"+t.series.indexOf(i),"dimple-bar"],u=!i._isStacked()&&i.x._hasMeasure(),h=!i._isStacked()&&i.y._hasMeasure(),d="none";i.x._hasCategories()&&i.y._hasCategories()?d="both":i.x._hasCategories()?d="x":i.y._hasCategories()&&(d="y"),t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=i.shapes?i.shapes.data(o,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(o,(function(t){return t.key}))).enter().append("rect").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(i){var a=[];return a=(a=(a=a.concat(i.aggField)).concat(i.xField)).concat(i.yField),c.join(" ")+" "+e._createClass(a)+" "+t.customClassList.barSeries+" "+e._helpers.css(i,t)})).attr("x",(function(a){var n=i.x._previousOrigin;return"x"===d?n=e._helpers.x(a,t,i):"both"===d&&(n=e._helpers.cx(a,t,i)),n})).attr("y",(function(a){var n=i.y._previousOrigin;return"y"===d?n=e._helpers.y(a,t,i):"both"===d&&(n=e._helpers.cy(a,t,i)),n})).attr("width",(function(a){return"x"===d?e._helpers.width(a,t,i):0})).attr("height",(function(a){return"y"===d?e._helpers.height(a,t,i):0})).on("mouseover",(function(a){e._showBarTooltip(a,this,t,i)})).on("mouseleave",(function(a){e._removeTooltip(a,this,t,i)})).call((function(a){t.noFormats||a.attr("opacity",(function(a){return e._helpers.opacity(a,t,i)})).style("fill",(function(a){return e._helpers.fill(a,t,i)})).style("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),r=t._handleTransition(l.merge(n),a,t,i).attr("x",(function(a){return u?e._helpers.cx(a,t,i)-i.x.floatingBarWidth/2:e._helpers.x(a,t,i)})).attr("y",(function(a){return h?e._helpers.cy(a,t,i)-i.y.floatingBarWidth/2:e._helpers.y(a,t,i)})).attr("width",(function(a){return u?i.x.floatingBarWidth:e._helpers.width(a,t,i)})).attr("height",(function(a){return h?i.y.floatingBarWidth:e._helpers.height(a,t,i)})).call((function(a){t.noFormats||a.attr("fill",(function(a){return e._helpers.fill(a,t,i)})).attr("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),s=t._handleTransition(l.exit(),a,t,i).attr("x",(function(a){var n=i.x._origin;return"x"===d?n=e._helpers.x(a,t,i):"both"===d&&(n=e._helpers.cx(a,t,i)),n})).attr("y",(function(a){var n=i.y._origin;return"y"===d?n=e._helpers.y(a,t,i):"both"===d&&(n=e._helpers.cy(a,t,i)),n})).attr("width",(function(a){return"x"===d?e._helpers.width(a,t,i):0})).attr("height",(function(a){return"y"===d?e._helpers.height(a,t,i):0})),e._postDrawHandling(i,r,s,a),i.shapes=i._group.selectAll("."+c.join("."))}},e.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(t,i,a){var n,r,s,o=i._positionData,l=null,c=["dimple-series-"+t.series.indexOf(i),"dimple-bubble"];t._tooltipGroup&&t._tooltipGroup.remove(),n=(l=i.shapes?i.shapes.data(o,(function(t){return t.key})):i._group.selectAll("."+c.join(".")).data(o,(function(t){return t.key}))).enter().append("circle").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(i){var a=[];return a=(a=(a=(a=a.concat(i.aggField)).concat(i.xField)).concat(i.yField)).concat(i.zField),c.join(" ")+" "+e._createClass(a)+" "+t.customClassList.bubbleSeries+" "+e._helpers.css(i,t)})).attr("cx",(function(a){return i.x._hasCategories()?e._helpers.cx(a,t,i):i.x._previousOrigin})).attr("cy",(function(a){return i.y._hasCategories()?e._helpers.cy(a,t,i):i.y._previousOrigin})).attr("r",0).on("mouseover",(function(a){e._showPointTooltip(a,this,t,i)})).on("mouseleave",(function(a){e._removeTooltip(a,this,t,i)})).call((function(a){t.noFormats||a.attr("opacity",(function(a){return e._helpers.opacity(a,t,i)})).style("fill",(function(a){return e._helpers.fill(a,t,i)})).style("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),r=t._handleTransition(l.merge(n),a,t,i).attr("cx",(function(a){return e._helpers.cx(a,t,i)})).attr("cy",(function(a){return e._helpers.cy(a,t,i)})).attr("r",(function(a){return e._helpers.r(a,t,i)})).call((function(a){t.noFormats||a.attr("fill",(function(a){return e._helpers.fill(a,t,i)})).attr("stroke",(function(a){return e._helpers.stroke(a,t,i)}))})),s=t._handleTransition(l.exit(),a,t,i).attr("r",0).attr("cx",(function(a){return i.x._hasCategories()?e._helpers.cx(a,t,i):i.x._origin})).attr("cy",(function(a){return i.y._hasCategories()?e._helpers.cy(a,t,i):i.y._origin})),e._postDrawHandling(i,r,s,a),i.shapes=i._group.selectAll("."+c.join("."))}},e.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(i,a,n){var r,s,o,l,c,u,h,d,p,g,f,m=a._positionData,y=[],x=null,v="dimple-series-"+i.series.indexOf(a),b=a.x._hasCategories()||a.y._hasCategories()?0:1,_=!1,w=function(){return function(i,a,n,r){t.select(a).style("opacity",1),e._showPointTooltip(i,a,n,r)}},S=function(i){return function(a,n,r,s){t.select(n).style("opacity",s.lineMarkers||i.data.length<2?e._helpers.opacity(a,r,s):0),e._removeTooltip(a,n,r,s)}},k=function(t,r){e._drawMarkers(t,i,a,n,v,_,w(),S(t),r)},T=function(t,n){var r;return"step"===a.interpolation&&a[t]._hasCategories()?(a.barGap=0,a.clusterBarGap=0,r=e._helpers[t](n,i,a)+("y"===t?e._helpers.height(n,i,a):0)):r=e._helpers["c"+t](n,i,a),parseFloat(r.toFixed(1))},C=function(i,n){var r=t.line().x((function(t){return a.x._hasCategories()||!n?t.x:a.x[n]})).y((function(t){return a.y._hasCategories()||!n?t.y:a.y[n]}));return e._interpolate(r,i),r};for(r="step"===a.interpolation?"step-after":a.interpolation,f=e._getSeriesOrder(a.data||i.data,a),a.c&&(a.x._hasCategories()&&a.y._hasMeasure()||a.y._hasCategories()&&a.x._hasMeasure())&&(_=!0),s=0;s<m.length;s+=1){for(c=[],h=-1,l=b;l<m[s].aggField.length;l+=1)c.push(m[s].aggField[l]);for(u=e._createClass(c),l=0;l<y.length;l+=1)if(y[l].keyString===u){h=l;break}-1===h&&(h=y.length,y.push({key:c,keyString:u,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),y[h].data.push(m[s])}for(f&&y.sort((function(t,i){return e._arrayIndexCompare(f,t.key,i.key)})),s=0;s<y.length;s+=1){for(y[s].data.sort(e._getSeriesSortPredicate(i,a,f)),_&&e._addGradient(y[s].key,"fill-line-gradient-"+y[s].keyString,a.x._hasCategories()?a.x:a.y,m,i,n,"fill"),o=0;o<y[s].data.length;o+=1)y[s].points.push({x:T("x",y[s].data[o]),y:T("y",y[s].data[o])});"step"===a.interpolation&&y[s].points.length>1&&(a.x._hasCategories()?y[s].points.push({x:2*y[s].points[y[s].points.length-1].x-y[s].points[y[s].points.length-2].x,y:y[s].points[y[s].points.length-1].y}):a.y._hasCategories()&&(y[s].points=[{x:y[s].points[0].x,y:2*y[s].points[0].y-y[s].points[1].y}].concat(y[s].points))),y&&y[s]&&y[s].points&&1===y[s].points.length&&y[s].points.push({x:y[s].points[0].x,y:y[s].points[0].y}),y[s].entry=C(r,"_previousOrigin")(y[s].points),y[s].update=C(r)(y[s].points),y[s].exit=C(r,"_origin")(y[s].points),y[s].color=i.getColor(y[s].key.length>0?y[s].key[y[s].key.length-1]:"All"),y[s].css=i.getClass(y[s].key.length>0?y[s].key[y[s].key.length-1]:"All")}i._tooltipGroup&&i._tooltipGroup.remove(),d=(x=a.shapes?a.shapes.data(y,(function(t){return t.key})):a._group.selectAll("."+v).data(y,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){return v+" dimple-line "+t.keyString+" "+i.customClassList.lineSeries+" "+t.css})).attr("d",(function(t){return t.entry})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return _?1:t.color.opacity})).style("fill","none").style("stroke",(function(t){return _?"url(#"+e._createClass(["fill-line-gradient-"+t.keyString])+")":t.color.stroke})).style("stroke-width",a.lineWeight)})).each((function(t){t.markerData=t.data,k(t,this)})),p=i._handleTransition(x.merge(d),n,i).attr("d",(function(t){return t.update})).each((function(t){t.markerData=t.data,k(t,this)})),g=i._handleTransition(x.exit(),n,i).attr("d",(function(t){return t.exit})).each((function(t){t.markerData=[],k(t,this)})),e._postDrawHandling(a,p,g,n),a.shapes=a._group.selectAll("."+v)}},e.plot.pie={stacked:!1,grouped:!1,supportedAxes:["x","y","c","z","p"],draw:function(i,a,n){var r,s,o,l=a._positionData,c=null,u=["dimple-series-"+i.series.indexOf(a),"dimple-pie"],h=function(t){return a.x&&a.y?e._helpers.r(t,i,a):i._widthPixels()<i._heightPixels()?i._widthPixels()/2:i._heightPixels()/2},d=function(t){var i=h(t);return a.outerRadius&&(i=e._parsePosition(a.outerRadius,i)),Math.max(i,0)},p=function(t){var i=0;return a.innerRadius&&(i=e._parsePosition(a.innerRadius,h(t))),Math.max(i,0)},g=function(e){return t.arc().innerRadius(p(e)).outerRadius(d(e))(e)},f=function(e){e.innerRadius=p(e),e.outerRadius=d(e);var i,a=t.interpolate(this._current,e);return i=t.arc().innerRadius((function(t){return t.innerRadius})).outerRadius((function(t){return t.outerRadius})),this._current=a(0),function(t){return i(a(t))}},m=function(t){return function(n){var r,s;return a.x&&a.y?(r=!t||a.x._hasCategories()?e._helpers.cx(n,i,a):a.x._previousOrigin,s=!t||a.y._hasCategories()?e._helpers.cy(n,i,a):a.y._previousOrigin):(r=i._xPixels()+i._widthPixels()/2,s=i._yPixels()+i._heightPixels()/2),"translate("+r+","+s+")"}};i._tooltipGroup&&i._tooltipGroup.remove(),r=(c=a.shapes?a.shapes.data(l,(function(t){return t.key})):a._group.selectAll("."+u.join(".")).data(l,(function(t){return t.key}))).enter().append("path").attr("id",(function(t){return e._createClass([t.key])})).attr("class",(function(t){var a=[];return a=(a=a.concat(t.aggField)).concat(t.pField),u.join(" ")+" "+e._createClass(a)+" "+i.customClassList.pieSeries+" "+e._helpers.css(t,i)})).attr("d",g).on("mouseover",(function(t){e._showBarTooltip(t,this,i,a)})).on("mouseleave",(function(t){e._removeTooltip(t,this,i,a)})).call((function(t){i.noFormats||t.attr("opacity",(function(t){return e._helpers.opacity(t,i,a)})).style("fill",(function(t){return e._helpers.fill(t,i,a)})).style("stroke",(function(t){return e._helpers.stroke(t,i,a)}))})).attr("transform",m(!0)).each((function(t){this._current=t,t.innerRadius=p(t),t.outerRadius=d(t)})),s=i._handleTransition(c.merge(r),n,i,a).call((function(t){n&&n>0?t.attrTween("d",f):t.attr("d",g),i.noFormats||t.attr("fill",(function(t){return e._helpers.fill(t,i,a)})).attr("stroke",(function(t){return e._helpers.stroke(t,i,a)}))})).attr("transform",m(!1)),o=i._handleTransition(c.exit(),n,i,a).attr("transform",m(!0)).attr("d",g),e._postDrawHandling(a,s,o,n),a.shapes=a._group.selectAll("."+u.join("."))}},e._addGradient=function(t,i,a,n,r,s,o){var l=[].concat(t),c=r.svg.select("#"+e._createClass([i])),u=[],h=a.position+"Field",d=!0,p=[];n.forEach((function(t){-1===u.indexOf(t[h])&&t.aggField.join("_")===l.join("_")&&u.push(t[h])}),this),u=u.sort((function(t,e){return a._scale(t)-a._scale(e)})),null===c.node()&&(d=!1,c=r.svg.append("defs").append("linearGradient").attr("id",e._createClass([i])).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===a.position?a._scale(u[0])+r._widthPixels()/u.length/2:0).attr("y1","y"===a.position?a._scale(u[0])-r._heightPixels()/u.length/2:0).attr("x2","x"===a.position?a._scale(u[u.length-1])+r._widthPixels()/u.length/2:0).attr("y2","y"===a.position?a._scale(u[u.length-1])-r._heightPixels()/u.length/2:0)),u.forEach((function(t,e){var i={},a=0;for(a=0;a<n.length;a+=1)if(n[a].aggField.join("_")===l.join("_")&&n[a][h].join("_")===t.join("_")){i=n[a];break}p.push({offset:Math.round(e/(u.length-1)*100)+"%",color:i[o]})}),this),d?r._handleTransition(c.selectAll("stop").data(p),s,r).attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color})):c.selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t.offset})).attr("stop-color",(function(t){return t.color}))},e._arrayIndexCompare=function(t,e,i){var a,n,r,s,o,l;for(n=0;n<t.length;n+=1){for(s=!0,o=!0,l=[].concat(t[n]),r=0;r<e.length;r+=1)s=s&&e[r]===l[r];for(r=0;r<i.length;r+=1)o=o&&i[r]===l[r];if(s||o){a=s&&o?0:s?-1:1;break}}return a},e._createClass=function(t){var e,i,a=[];if(i=function(t){var e=t.charCodeAt(0),i="-";return e>=65&&e<=90&&(i=t.toLowerCase()),i},t.length>0)for(e=0;e<t.length;e+=1)t[e]&&a.push("dimple-"+t[e].toString().replace(/[^a-z0-9]/g,i));else a=["dimple-all"];return a.join(" ")},e._drawMarkerBacks=function(i,a,n,r,s,o){var l,c,u,h=["dimple-marker-back",s,i.keyString];n.lineMarkers&&(l=null===n._markerBacks||void 0===n._markerBacks||void 0===n._markerBacks[i.keyString]?n._group.selectAll("."+h.join(".")).data(i.markerData):n._markerBacks[i.keyString].data(i.markerData,(function(t){return t.key})),(u=o.nextSibling&&o.nextSibling.id?l.enter().insert("circle","#"+o.nextSibling.id):l.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker Back"])})).attr("class",(function(t){var i=[];return n.x._hasCategories()&&(i=i.concat(t.xField)),n.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+h.join(" ")})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._previousOrigin})).attr("r",0).attr("fill","white").attr("stroke","none"),a._handleTransition(l.merge(u),r,a).attr("cx",(function(t){return e._helpers.cx(t,a,n)})).attr("cy",(function(t){return e._helpers.cy(t,a,n)})).attr("r",2+n.lineWeight),c=a._handleTransition(l.exit(),r,a).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._origin})).attr("r",0),0===r?c.remove():c.each("end",(function(){t.select(this).remove()})),void 0!==n._markerBacks&&null!==n._markerBacks||(n._markerBacks={}),n._markerBacks[i.keyString]=l)},e._drawMarkers=function(i,a,n,r,s,o,l,c,u){var h,d,p,g=["dimple-marker",s,i.keyString];h=null===n._markers||void 0===n._markers||void 0===n._markers[i.keyString]?n._group.selectAll("."+g.join(".")).data(i.markerData):n._markers[i.keyString].data(i.markerData,(function(t){return t.key})),(p=u.nextSibling&&u.nextSibling.id?h.enter().insert("circle","#"+u.nextSibling.id):h.enter().append("circle")).attr("id",(function(t){return e._createClass([t.key+" Marker"])})).attr("class",(function(t){var i=[],r=a.getClass(t.aggField.length>0?t.aggField[t.aggField.length-1]:"All");return n.x._hasCategories()&&(i=i.concat(t.xField)),n.y._hasCategories()&&(i=i.concat(t.yField)),e._createClass(i)+" "+g.join(" ")+" "+a.customClassList.lineMarker+" "+r})).on("mouseover",(function(t){l(t,this,a,n)})).on("mouseleave",(function(t){c(t,this,a,n)})).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._previousOrigin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._previousOrigin})).attr("r",0).attr("opacity",n.lineMarkers||i.data.length<2?i.color.opacity:0).call((function(t){a.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,a,n):i.color.stroke}))})),a._handleTransition(h.merge(p),r,a).attr("cx",(function(t){return e._helpers.cx(t,a,n)})).attr("cy",(function(t){return e._helpers.cy(t,a,n)})).attr("r",2+n.lineWeight).attr("opacity",n.lineMarkers||i.data.length<2?i.color.opacity:0).call((function(t){a.noFormats||t.attr("fill","white").style("stroke-width",n.lineWeight).attr("stroke",(function(t){return o?e._helpers.fill(t,a,n):i.color.stroke}))})),d=a._handleTransition(h.exit(),r,a).attr("cx",(function(t){return n.x._hasCategories()?e._helpers.cx(t,a,n):n.x._origin})).attr("cy",(function(t){return n.y._hasCategories()?e._helpers.cy(t,a,n):n.y._origin})).attr("r",0),0===r?d.remove():d.each("end",(function(){t.select(this).remove()})),void 0!==n._markers&&null!==n._markers||(n._markers={}),n._markers[i.keyString]=h,e._drawMarkerBacks(i,a,n,r,s,u)},e._ease=function(e,i){if(e&&i&&"[object String]"===Object.prototype.toString.call(i)){switch(i){case"linear":i=t.easeLinear;break;case"poly":i=t.easePoly;break;case"quad":i=t.easeQuad;break;case"cubic":i=t.easeCubic;break;case"sin":i=t.easeSin;break;case"exp":i=t.easeExp;break;case"circle":i=t.easeCircle;break;case"elastic":i=t.easeElastic;break;case"back":i=t.easeBack;break;case"bounce":i=t.easeBounce}e.ease(i)}},e._getOrderedList=function(t,i,a){var n,r=[],s=[],o=[].concat(i),l=[].concat(i),c=[];return null!=a&&(c=c.concat(a)),(c=c.concat({ordering:o,desc:!1})).forEach((function(e){var i,a=[],n=[];if("function"==typeof e.ordering){if(t&&t.length>0)for(i in t[0])t[0].hasOwnProperty(i)&&-1===l.indexOf(i)&&l.push(i)}else if(e.ordering instanceof Array){for(i=0;i<e.ordering.length;i+=1)t&&t.length>0&&t[0].hasOwnProperty(e.ordering[i])&&n.push(e.ordering[i]),a.push(e.ordering[i]);n.length>a.length/2?l.concat(n):e.values=a}else l.push(e.ordering)}),this),n=e._rollUp(t,o,l),c.length>=1&&(c.forEach((function(t){var e=null!==t.desc&&void 0!==t.desc&&t.desc,i=t.ordering,a=[],n=function(t){var e,i=0;for(e=0;e<t.length;e+=1){if(isNaN(t[e])){i=void 0;break}i+=parseFloat(t[e])}return i},s=function(t,e){var i=0,a=n(t),r=n(e);return isNaN(a)||isNaN(r)?isNaN(Date.parse(t[0]))||isNaN(Date.parse(e[0]))?t[0]<e[0]?i=-1:t[0]>e[0]&&(i=1):i=Date.parse(t[0])-Date.parse(e[0]):i=parseFloat(a)-parseFloat(r),i};"function"==typeof i?r.push((function(t,a){return(e?-1:1)*i(t,a)})):t.values&&t.values.length>0?(t.values.forEach((function(t){a.push([].concat(t).join("|"))}),this),r.push((function(t,i){var n,r,s,l="",c="";for(s=0;s<o.length;s+=1)s>0&&(l+="|",c+="|"),l+=t[o[s]],c+=i[o[s]];return n=a.indexOf(l),r=a.indexOf(c),n=n<0?e?-1:a.length:n,r=r<0?e?-1:a.length:r,(e?-1:1)*(n-r)}))):[].concat(t.ordering).forEach((function(t){r.push((function(i,a){var n=0;return void 0!==i[t]&&void 0!==a[t]&&(n=s([].concat(i[t]),[].concat(a[t]))),(e?-1:1)*n}))}))})),n.sort((function(t,e){for(var i=0,a=0;i<r.length&&0===a;)a=r[i](t,e),i+=1;return a})),n.forEach((function(t){var e,i=[];if(1===o.length)s.push(t[o[0]]);else{for(e=0;e<o.length;e+=1)i.push(t[o[e]]);s.push(i)}}),this)),s},e._getSeriesOrder=function(t,i){var a=[].concat(i._orderRules),n=i.categoryFields,r=[];return null!=n&&n.length>0&&(null!==i.c&&void 0!==i.c&&i.c._hasMeasure()&&a.push({ordering:i.c.measure,desc:!0}),i.x._hasMeasure()&&a.push({ordering:i.x.measure,desc:!0}),i.y._hasMeasure()&&a.push({ordering:i.y.measure,desc:!0}),r=e._getOrderedList(t,n,a)),r},e._getSeriesSortPredicate=function(t,i,a){return function(n,r){var s=0;return i.x._hasCategories()&&(s=e._helpers.cx(n,t,i)-e._helpers.cx(r,t,i)),0===s&&i.y._hasCategories()&&(s=e._helpers.cy(n,t,i)-e._helpers.cy(r,t,i)),0===s&&a&&(s=e._arrayIndexCompare(a,n.aggField,r.aggField)),s}},e._helpers={cx:function(t,i,a){return null!==a.x.measure&&void 0!==a.x.measure?a.x._scale(t.cx):a.x._hasCategories()&&a.x.categoryFields.length>=2?a.x._scale(t.cx)+e._helpers.xGap(i,a)+(t.xOffset+.5)*((i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))*t.width):a.x._scale(t.cx)+i._widthPixels()/a.x._max/2},cy:function(t,i,a){return null!==a.y.measure&&void 0!==a.y.measure?a.y._scale(t.cy):null!==a.y.categoryFields&&void 0!==a.y.categoryFields&&a.y.categoryFields.length>=2?a.y._scale(t.cy)-i._heightPixels()/a.y._max+e._helpers.yGap(i,a)+(t.yOffset+.5)*((i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))*t.height):a.y._scale(t.cy)-i._heightPixels()/a.y._max/2},r:function(t,e,i){var a=0,n=1;return null===i.z||void 0===i.z?a=i.radius&&"auto"!==i.radius?i.radius:5:(i.radius&&"auto"!==i.radius&&i.radius>1&&(n=i.radius/i.z._scale(i.z._max)),a=i.z._hasMeasure()?i.z._scale(t.r)*n:i.z._scale(e._heightPixels()/100)*n),a},xGap:function(t,e){var i=0;return(null===e.x.measure||void 0===e.x.measure)&&e.barGap>0&&(i=t._widthPixels()/e.x._max*(e.barGap>.99?.99:e.barGap)/2),i},xClusterGap:function(t,i,a){var n=0;return null!==a.x.categoryFields&&void 0!==a.x.categoryFields&&a.x.categoryFields.length>=2&&a.clusterBarGap>0&&!a.x._hasMeasure()&&(n=t.width*(i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))*(a.clusterBarGap>.99?.99:a.clusterBarGap)/2),n},yGap:function(t,e){var i=0;return(null===e.y.measure||void 0===e.y.measure)&&e.barGap>0&&(i=t._heightPixels()/e.y._max*(e.barGap>.99?.99:e.barGap)/2),i},yClusterGap:function(t,i,a){var n=0;return null!==a.y.categoryFields&&void 0!==a.y.categoryFields&&a.y.categoryFields.length>=2&&a.clusterBarGap>0&&!a.y._hasMeasure()&&(n=t.height*(i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))*(a.clusterBarGap>.99?.99:a.clusterBarGap)/2),n},x:function(t,i,a){return a.x._hasTimeField()?a.x._scale(t.x)-e._helpers.width(t,i,a)/2:null!==a.x.measure&&void 0!==a.x.measure?a.x._scale(t.x):a.x._scale(t.x)+e._helpers.xGap(i,a)+t.xOffset*(e._helpers.width(t,i,a)+2*e._helpers.xClusterGap(t,i,a))+e._helpers.xClusterGap(t,i,a)},y:function(t,i,a){return a.y._hasTimeField()?a.y._scale(t.y)-e._helpers.height(t,i,a)/2:null!==a.y.measure&&void 0!==a.y.measure?a.y._scale(t.y):a.y._scale(t.y)-i._heightPixels()/a.y._max+e._helpers.yGap(i,a)+t.yOffset*(e._helpers.height(t,i,a)+2*e._helpers.yClusterGap(t,i,a))+e._helpers.yClusterGap(t,i,a)},width:function(t,i,a){return null!==a.x.measure&&void 0!==a.x.measure?Math.abs(a.x._scale(t.x<0?t.x-t.width:t.x+t.width)-a.x._scale(t.x)):a.x._hasTimeField()?a.x.floatingBarWidth:t.width*(i._widthPixels()/a.x._max-2*e._helpers.xGap(i,a))-2*e._helpers.xClusterGap(t,i,a)},height:function(t,i,a){return a.y._hasTimeField()?a.y.floatingBarWidth:null!==a.y.measure&&void 0!==a.y.measure?Math.abs(a.y._scale(t.y)-a.y._scale(t.y<=0?t.y+t.height:t.y-t.height)):t.height*(i._heightPixels()/a.y._max-2*e._helpers.yGap(i,a))-2*e._helpers.yClusterGap(t,i,a)},opacity:function(t,e,i){return null!==i.c&&void 0!==i.c?t.opacity:e.getColor(t.aggField.slice(-1)[0]).opacity},fill:function(t,e,i){return null!==i.c&&void 0!==i.c?t.fill:e.getColor(t.aggField.slice(-1)[0]).fill},stroke:function(t,e,i){return null!==i.c&&void 0!==i.c?t.stroke:e.getColor(t.aggField.slice(-1)[0]).stroke},css:function(t,e){return e.getClass(t.aggField.slice(-1)[0])}},e._interpolate=function(e,i){if(e&&i){if("[object String]"===Object.prototype.toString.call(i))switch(i){case"linear":i=t.curveLinear;break;case"linear-closed":i=t.curveLinearClosed;break;case"step":i=t.curveStep;break;case"step-before":i=t.curveStepBefore;break;case"step-after":i=t.curveStepAfter;break;case"basis":i=t.curveBasis;break;case"basis-open":i=t.curveBasisOpen;break;case"basis-closed":i=t.curveBasisClosed;break;case"bundle":i=t.curveBundle;break;case"cardinal":i=t.curveCardinal;break;case"cardinal-open":i=t.curveCardinalOpen;break;case"cardinal-closed":i=t.curveCardinalClosed;break;case"monotone":i=t.curveMonotoneX}e.curve(i)}},e._parentHeight=function(t){var e=t.getBoundingClientRect().height;return(!e||e<0)&&(e=t.clientHeight),e},e._parentWidth=function(t){var e=t.getBoundingClientRect().width;return(!e||e<0)&&(e=t.clientWidth),e},e._parsePosition=function(t,e){var i=0;return t&&t.toString().split(",").forEach((function(a){a&&(isNaN(a)?"%"===a.slice(-1)?i+=e*(parseFloat(a.slice(0,a.length-1))/100):"px"===a.slice(-2)?i+=parseFloat(a.slice(0,a.length-2)):i=t:i+=parseFloat(a))}),this),i<0&&(i=e+i),i},e._parseXPosition=function(t,i){return e._parsePosition(t,e._parentWidth(i))},e._parseYPosition=function(t,i){return e._parsePosition(t,e._parentHeight(i))},e._postDrawHandling=function(t,e,i,a){0===a?(e.each((function(e,i){t.afterDraw&&t.afterDraw(this,e,i)})),i.remove()):(e.on("end",(function(e,i){t.afterDraw&&t.afterDraw(this,e,i)})),i.call((function(){t.shapes&&t.shapes.exit().remove()})))},e._removeTooltip=function(t,e,i,a){i._tooltipGroup&&i._tooltipGroup.remove()},e._rollUp=function(t,e,i){var a=[];return e=null!=e?[].concat(e):[],t.forEach((function(t){var n=-1,r={},s=!0;a.forEach((function(i,a){-1===n&&(s=!0,e.forEach((function(e){s=s&&t[e]===i[e]}),this),s&&(n=a))}),this),-1!==n?r=a[n]:(e.forEach((function(e){r[e]=t[e]}),this),a.push(r),n=a.length-1),i.forEach((function(i){-1===e.indexOf(i)&&(void 0===r[i]&&(r[i]=[]),r[i]=r[i].concat(t[i]))}),this),a[n]=r}),this),a},e._showBarTooltip=function(e,i,a,n){var r,s,o,l,c,u,h=10,d=t.select(i),p=d.node().getBBox().x,g=d.node().getBBox().y,f=d.node().getBBox().width,m=d.node().getBBox().height,y=d.attr("opacity"),x=d.attr("fill"),v=n._dropLineOrigin(),b=t.rgb(t.rgb(x).r+.6*(255-t.rgb(x).r),t.rgb(x).g+.6*(255-t.rgb(x).g),t.rgb(x).b+.6*(255-t.rgb(x).b)),_=t.rgb(t.rgb(x).r+.8*(255-t.rgb(x).r),t.rgb(x).g+.8*(255-t.rgb(x).g),t.rgb(x).b+.8*(255-t.rgb(x).b)),w=n.getTooltipText(e),S=0,k=0,T=0,C=function(t,e){var i=d.node().getCTM(),n=a.svg.node().createSVGPoint();return n.x=t||0,n.y=e||0,n.matrixTransform(i)};null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),a._tooltipGroup=a.svg.append("g"),n.p||(u=n._isStacked()?1:f/2,n.x._hasCategories()||null===v.y||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",p<n.x._origin?p+u:p+f-u).attr("y1",g<v.y?g+m:g).attr("x2",p<n.x._origin?p+u:p+f-u).attr("y2",g<v.y?g+m:g).call((function(t){a.noFormats||t.style("fill","none").style("stroke",x).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",y)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",g<v.y?v.y-1:v.y+1),u=n._isStacked()?1:m/2,n.y._hasCategories()||null===v.x||a._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+a.customClassList.tooltipDropLine).attr("x1",p<v.x?p+f:p).attr("y1",g<n.y._origin?g+u:g+m-u).attr("x2",p<v.x?p+f:p).attr("y2",g<n.y._origin?g+u:g+m-u).call((function(t){a.noFormats||t.style("fill","none").style("stroke",x).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",y)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",p<v.x?v.x-1:v.x+1)),s=(r=a._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+a.customClassList.tooltipBox),r.selectAll(".dimple-dont-select-any").data(w).enter().append("text").attr("class","dimple-tooltip "+a.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){a.noFormats||t.style("font-family",n.tooltipFontFamily).style("font-size",n._getTooltipFontSize())})),r.each((function(){k=this.getBBox().width>k?this.getBBox().width:k,T=this.getBBox().width>T?this.getBBox().height:T})),r.selectAll("text").attr("x",0).attr("y",(function(){return(S+=this.getBBox().height)-this.getBBox().height/2})),s.attr("x",-5).attr("y",-5).attr("height",Math.floor(S+5)-.5).attr("width",k+10).attr("rx",5).attr("ry",5).call((function(t){a.noFormats||t.style("fill",_).style("stroke",b).style("stroke-width",2).style("opacity",.95)})),C(p+f+5+h+k).x<parseFloat(a.svg.node().getBBox().width)?(o=p+f+5+h,l=g+m/2-(S-(T-5))/2):C(p-(15+k)).x>0?(o=p-(15+k),l=g+m/2-(S-(T-5))/2):C(0,g+m+S+h+5).y<parseFloat(a.svg.node().getBBox().height)?(o=(o=(o=p+f/2-(10+k)/2)>0?o:h)+k<parseFloat(a.svg.node().getBBox().width)?o:parseFloat(a.svg.node().getBBox().width)-k-h,l=g+m+10):(o=(o=(o=p+f/2-(10+k)/2)>0?o:h)+k<parseFloat(a.svg.node().getBBox().width)?o:parseFloat(a.svg.node().getBBox().width)-k-h,l=g-S-(T-5)),c=C(o,l),r.attr("transform","translate("+c.x+" , "+c.y+")")},e._showPointTooltip=function(i,a,n,r){var s,o,l,c,u=10,h=t.select(a),d=parseFloat(h.attr("cx")),p=parseFloat(h.attr("cy")),g=parseFloat(h.attr("r")),f=e._helpers.opacity(i,n,r),m=h.attr("stroke"),y=r._dropLineOrigin(),x=t.rgb(t.rgb(m).r+.6*(255-t.rgb(m).r),t.rgb(m).g+.6*(255-t.rgb(m).g),t.rgb(m).b+.6*(255-t.rgb(m).b)),v=t.rgb(t.rgb(m).r+.8*(255-t.rgb(m).r),t.rgb(m).g+.8*(255-t.rgb(m).g),t.rgb(m).b+.8*(255-t.rgb(m).b)),b=0,_=0,w=0,S=r.getTooltipText(i);null!==n._tooltipGroup&&void 0!==n._tooltipGroup&&n._tooltipGroup.remove(),n._tooltipGroup=n.svg.append("g"),n._tooltipGroup.append("circle").attr("class","dimple-line-marker-circle "+n.customClassList.lineMarkerCircle).attr("cx",d).attr("cy",p).attr("r",g).call((function(t){n.noFormats||t.attr("opacity",0).style("fill","none").style("stroke",m).style("stroke-width",1)})).transition().duration(375).ease(t.easeLinear).attr("r",g+r.lineWeight+2).call((function(t){n.noFormats||t.attr("opacity",1).style("stroke-width",2)})),null!==y.y&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d).attr("y1",p<y.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).attr("x2",d).attr("y2",p<y.y?p+g+r.lineWeight+2:p-g-r.lineWeight-2).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("y2",p<y.y?y.y-1:y.y+1),null!==y.x&&n._tooltipGroup.append("line").attr("class","dimple-tooltip-dropline "+n.customClassList.tooltipDropLine).attr("x1",d<y.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y1",p).attr("x2",d<y.x?d+g+r.lineWeight+2:d-g-r.lineWeight-2).attr("y2",p).call((function(t){n.noFormats||t.style("fill","none").style("stroke",m).style("stroke-width",2).style("stroke-dasharray","3, 3").style("opacity",f)})).transition().delay(375).duration(375).ease(t.easeLinear).attr("x2",d<y.x?y.x-1:y.x+1),o=(s=n._tooltipGroup.append("g")).append("rect").attr("class","dimple-tooltip "+n.customClassList.tooltipBox),s.selectAll(".dont-select-any").data(S).enter().append("text").attr("class","dimple-tooltip "+n.customClassList.tooltipLabel).text((function(t){return t})).call((function(t){n.noFormats||t.style("font-family",r.tooltipFontFamily).style("font-size",r._getTooltipFontSize())})),s.each((function(){_=this.getBBox().width>_?this.getBBox().width:_,w=this.getBBox().width>w?this.getBBox().height:w})),s.selectAll("text").attr("x",0).attr("y",(function(){return(b+=this.getBBox().height)-this.getBBox().height/2})),o.attr("x",-5).attr("y",-5).attr("height",Math.floor(b+5)-.5).attr("width",_+10).attr("rx",5).attr("ry",5).call((function(t){n.noFormats||t.style("fill",v).style("stroke",x).style("stroke-width",2).style("opacity",.95)})),d+g+5+u+_<parseFloat(n.svg.node().getBBox().width)?(l=d+g+5+u,c=p-(b-(w-5))/2):d-g-(15+_)>0?(l=d-g-(15+_),c=p-(b-(w-5))/2):p+g+b+u+5<parseFloat(n.svg.node().getBBox().height)?(l=(l=(l=d-(10+_)/2)>0?l:u)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-u,c=p+g+10):(l=(l=(l=d-(10+_)/2)>0?l:u)+_<parseFloat(n.svg.node().getBBox().width)?l:parseFloat(n.svg.node().getBBox().width)-_-u,c=p-b-(w-5)),s.attr("transform","translate("+l+" , "+c+")")},e.filterData=function(t,e,i){var a=t;return null!==e&&null!==i&&(null!=i&&(i=[].concat(i)),a=[],t.forEach((function(t){null===t[e]?a.push(t):i.indexOf([].concat(t[e]).join("/"))>-1&&a.push(t)}),this)),a},e.getUniqueValues=function(t,e){var i=[];return null!=e&&(e=[].concat(e),t.forEach((function(t){var a="";e.forEach((function(e,i){i>0&&(a+="/"),a+=t[e]}),this),-1===i.indexOf(a)&&i.push(a)}),this)),i},e.newSvg=function(e,i,a){var n=null;if(null!=e||(e="body"),(n=t.select(e)).empty())throw"The '"+e+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return n.append("svg").attr("width",i).attr("height",a)},e}))},22:function(t,e,i){"use strict";var a=i(3),n=i(0),r=(i(46),i(4)),s=i.n(r),o={initChartColorsDialog:function(t){var e,i="tf-chart-color-"+t.macroId,r=i+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:i,dialogId:r,options:{offsetX:-20,width:220,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){e=[];var i=t.getChartColorLabels(),n=[];return i.forEach((function(i,s){var o=t.colors[s%t.colors.length];e.push(o),n.push({color:o,field:i,id:r,variant:a.a.FIELD_VARIANTS.COLORS})})),s.a.inlineDialog({clazz:"tf-chart-colors-dialog",name:"chart-colors",inputs:n,dialogId:r})},applyCallback:function(){n.a.chartColors.forEach((function(t){-1==$.inArray(t,e)&&e.push(t)})),t.triggerSettingsButtonInvoke(),t.enableSaveBtn(),t.colors=e,t.colorKeyMap=function(t,e,i){return e.forEach((function(e,a){t[e]=i[a]})),t}({},t.getChartColorLabels(),e),t.colorsCache=t.colors.slice(),t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},bindsCallback:function(t){t.popup.find(".tfc-color:not(.selected)").on("click",(function(){var i=$(this);e[i.data("index")]=i.data("color"),t.popup.find("button .tfc-color").eq(i.data("index")).css("background",i.data("color")).attr("data-color",i.data("color"))}))},hideCallback:function(){t.controls.removeClass("active")}})},initInterpolationDialog:function(t){var e="tf-interpolation-dialog-"+t.macroId,i=e+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:e,dialogId:i,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,i){t.interpolation[e]||(t.interpolation[e]=t.defaultInterpolation),n.push({field:e,value:t.interpolation[e],variant:a.a.FIELD_VARIANTS.INTERPOLATION_SELECT})})),s.a.inlineDialog({clazz:"tf-interpolation-dialog",name:"interpolation",inputs:n,dialogId:i})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var i={};e.popup.find("form").find("select").each((function(t,e){var a=$(e);i[a.data("name")]=a.val()})),t.interpolation=i,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})},initLineSettingsDialog:function(t){var e="tf-line-settings-dialog-"+t.macroId,i=e+"-"+t.pageId;return a.a.initAJSDialog({container:t.settings,dialogName:e,dialogId:i,options:{offsetX:-20,width:250,gravity:"n",noBind:!0,addActiveClass:!1},getContent:function(){var e=t.getChartColorLabels(),n=[];return e.forEach((function(e,i){t.lineSettings[e]||(t.lineSettings[e]={type:"solid",width:1.5}),n.push({field:e,value:t.lineSettings[e],variant:a.a.FIELD_VARIANTS.LINE_SETTINGS})})),s.a.inlineDialog({clazz:"tf-line-settings-dialog",name:"line-settings",inputs:n,dialogId:i})},applyCallback:function(e){t.triggerSettingsButtonInvoke(),t.enableSaveBtn();var i={};e.popup.find("form").find(".field-group").each((function(t,e){var a=$(e),n=a.find("select"),r=n.data("name"),s=n.val(),o=Math.abs(parseFloat(a.find("input").val()||"1.5"));i[r]={type:s,width:o}})),t.lineSettings=i,t.draw()},cancelCallback:function(){t.triggerSettingsButtonInvoke()},hideCallback:function(){t.controls.removeClass("active")}})}};e.a=o},3:function(t,e,i){"use strict";var a={FIELD_VARIANTS:{CHECKBOX:"checkbox",COLORS:"colors",INTERPOLATION_SELECT:"interpolation_select",LINE_SETTINGS:"line_settings",NUMBER:"number",SINGLE_SELECT:"single_select",TEXT:"text",RANGE:"range"},isMultiSelectFilter:function(t){return"icon"===t||"select_"===t||"hideColumns"===t},isAllColumnsFilter:function(t){return"global"===t||"hideColumns"===t},isRangeFilter:function(t){return"number_"===t||"date_"===t},fieldTypeToVariant:function(t){var e;switch(t){case"date_":case"number_":e=a.FIELD_VARIANTS.RANGE;break;case"hideColumns":case"select_":case"icon":e=a.FIELD_VARIANTS.SINGLE_SELECT;break;case"freetext_":case"global":default:e=a.FIELD_VARIANTS.TEXT}return e},initAJSDialog:function(t){return AJS.InlineDialog(t.container,t.dialogName,(function(e,i,a){return e.html(t.getContent()),a(),!1}),{initCallback:function(){var e=this;e.popup.find("#cancel-"+t.dialogId).click((function(){return e.hide(),"function"==typeof t.cancelCallback&&t.cancelCallback(),!1})),e.popup.find("#apply-"+t.dialogId).click((function(){return $(this).prop("disabled",!0),e.hide(),"function"==typeof t.applyCallback&&t.applyCallback(e),!1})),e.popup.find(".aui-dropdown2").click((function(){return!1})),"function"==typeof t.bindsCallback&&t.bindsCallback(e)},hideCallback:function(){"function"==typeof t.hideCallback&&t.hideCallback()},hideDelay:null,gravity:t.options.gravity||"n",persistent:t.options.persistent,width:t.options.width,offsetX:t.options.offsetX,noBind:t.options.noBind,addActiveClass:t.options.addActiveClass||!0})}};e.a=a},30:function(t,e,i){"use strict";var a=i(17);a.selection.prototype.filterByAttr=function(t,e){return this.filter((function(){return this.attributes[t].textContent===e}))},a.transition.prototype.filterByAttr=a.selection.prototype.filterByAttr;var n=a,r=i(18),s=i(21),o=i.n(s),l=i(42),c=i.n(l);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=0,p={header:{title:{text:"",color:"#333333",fontSize:18,font:"arial"},subtitle:{text:"",color:"#666666",fontSize:14,font:"arial"},location:"topz-center",titleSubtitlePadding:8},footer:{text:"",color:"#666666",fontSize:14,font:"arial",location:"left"},size:{canvasHeight:500,canvasWidth:500,pieInnerRadius:"0%",pieOuterRadius:null},data:{sortOrder:"none",ignoreSmallSegments:{enabled:!1,valueType:"percentage",value:null},smallSegmentGrouping:{enabled:!1,value:1,valueType:"percentage",label:"Other",color:"#cccccc"},content:[]},labels:{outer:{format:"label",hideWhenLessThanPercentage:null,pieDistance:30},inner:{format:"percentage",hideWhenLessThanPercentage:null},mainLabel:{color:"#333333",font:"arial",fontSize:10},percentage:{color:"#dddddd",font:"arial",fontSize:10,decimalPlaces:0},value:{color:"#cccc44",font:"arial",fontSize:10},lines:{enabled:!0,style:"curved",color:"segment"},truncation:{enabled:!1,truncateLength:30},formatter:null},effects:{load:{effect:"default",speed:1e3},pullOutSegmentOnClick:{effect:"bounce",speed:300,size:10},highlightSegmentOnMouseover:!0,highlightLuminosity:-.2},tooltips:{enabled:!1,type:"placeholder",string:"",placeholderParser:null,styles:{fadeInSpeed:250,backgroundColor:"#000000",backgroundOpacity:.5,color:"#efefef",borderRadius:2,font:"arial",fontSize:10,padding:4}},misc:{colors:{background:null,segments:["#2484c1","#65a620","#7b6888","#a05d56","#961a1a","#d8d23a","#e98125","#d0743c","#635222","#6ada6a","#0c6197","#7d9058","#207f33","#44b9b0","#bca44a","#e4a14b","#a3acb2","#8cc3e9","#69a6f9","#5b388f","#546e91","#8bde95","#d2ab58","#273c71","#98bf6e","#4daa4b","#98abc5","#cc1010","#31383b","#006391","#c2643f","#b0a474","#a5a39c","#a9c2bc","#22af8c","#7fcecf","#987ac6","#3d3b87","#b77b1c","#c9c2b6","#807ece","#8db27c","#be66a2","#9ed3c6","#00644b","#005064","#77979f","#77e079","#9c73ab","#1f79a7"],segmentStroke:"#ffffff"},gradient:{enabled:!1,percentage:95,color:"#000000"},canvasPadding:{top:5,right:5,bottom:5,left:5},pieCenterOffset:{x:0,y:0},cssPrefix:null},callbacks:{onload:null,onMouseoverSegment:null,onMouseoutSegment:null,onClickSegment:null}},g=function(t){var e=t.cssPrefix,i=t.element,a=t.options;if(!(i instanceof HTMLElement||i instanceof SVGElement))return!1;if(!/[a-zA-Z][a-zA-Z0-9_-]*$/.test(e))return!1;if(!f.isArray(a.data.content))return!1;if(0===a.data.content.length)return!1;for(var n=[],r=0;r<a.data.content.length;r++)"number"!=typeof a.data.content[r].value||isNaN(a.data.content[r].value)||a.data.content[r].value<=0||n.push(a.data.content[r]);return t.options.data.content=n,!0},f={addSVGSpace:function(t){var e=t.element,i=t.options.size.canvasWidth,a=t.options.size.canvasHeight,r=t.options.misc.colors.background,s=n.select(e).append("svg:svg").attr("width",i).attr("height",a);return"transparent"!==r&&s.style("background-color",(function(){return r})),s},whenIdExists:function(t,e){var i=1,a=setInterval((function(){document.getElementById(t)&&(clearInterval(a),e()),i>1e3&&clearInterval(a),i++}),1)},whenElementsExist:function(t,e){var i=1,a=setInterval((function(){for(var n=!0,r=0;r<t.length;r++)if(!document.getElementById(t[r])){n=!1;break}n&&(clearInterval(a),e()),i>1e3&&clearInterval(a),i++}),1)},shuffleArray:function(t){for(var e,i,a=t.length;0!==a;)i=Math.floor(Math.random()*a),e=t[a-=1],t[a]=t[i],t[i]=e;return t},processObj:function(t,e,i){return"string"==typeof e?f.processObj(t,e.split("."),i):1===e.length&&void 0!==i?(t[e[0]]=i,t[e[0]]):0===e.length?t:f.processObj(t[e[0]],e.slice(1),i)},getDimensions:function(t){var e=document.getElementById(t),i=0,a=0;if(e){var n=e.getBBox();i=n.width,a=n.height}return{w:i,h:a}},rectIntersect:function(t,e){return!(e.x>t.x+t.w||e.x+e.w<t.x||e.y+e.h<t.y||e.y>t.y+t.h)},getColorShade:function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;for(var i="#",a=0;a<3;a++){var n=parseInt(t.substr(2*a,2),16);i+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*e),255)).toString(16))).substr(n.length)}return i},initSegmentColors:function(t){for(var e=t.options.data.content,i=t.options.misc.colors.segments,a=[],n=0;n<e.length;n++)e[n].hasOwnProperty("color")?a.push(e[n].color):a.push(i[n]);return a},applySmallSegmentGrouping:function(t,e){var i;"percentage"===e.valueType&&(i=y.getTotalPieSize(t));for(var a=[],n=[],r=0,s=0;s<t.length;s++)if("percentage"===e.valueType){if(t[s].value/i*100<=e.value){n.push(t[s]),r+=t[s].value;continue}t[s].isGrouped=!1,a.push(t[s])}else{if(t[s].value<=e.value){n.push(t[s]),r+=t[s].value;continue}t[s].isGrouped=!1,a.push(t[s])}return n.length&&a.push({color:e.color,label:e.label,value:r,isGrouped:!0,groupedData:n}),a},showPoint:function(t,e,i){t.append("circle").attr("cx",e).attr("cy",i).attr("r",2).style("fill","black")},isFunction:function(t){return t&&"[object Function]"==={}.toString.call(t)},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}},m=function t(){var e,i,a,n,r,s,o=arguments[0]||{},l=1,c=arguments.length,h=!1,d=Object.prototype.toString,p=Object.prototype.hasOwnProperty,g={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},f={isFunction:function(t){return"function"===f.type(t)},isArray:Array.isArray||function(t){return"array"===f.type(t)},isWindow:function(t){return null!==t&&t===t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null===t?String(t):g[d.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==f.type(t)||t.nodeType)return!1;try{if(t.constructor&&!p.call(t,"constructor")&&!p.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var e;for(e in t);return void 0===e||p.call(t,e)}};for("boolean"==typeof o&&(h=o,o=arguments[1]||{},l=2),"object"===u(o)||f.isFunction(o)||(o={}),c===l&&(o=this,--l);l<c;l++)if(null!==(e=arguments[l]))for(i in e)a=o[i],o!==(n=e[i])&&(h&&n&&(f.isPlainObject(n)||(r=f.isArray(n)))?(r?(r=!1,s=a&&f.isArray(a)?a:[]):s=a&&f.isPlainObject(a)?a:{},o[i]=t(h,s,n)):void 0!==n&&(o[i]=n));return o},y={toRadians:function(t){return t*(Math.PI/180)},toDegrees:function(t){return t*(180/Math.PI)},computePieRadius:function(t){var e=t.options.size,i=t.options.misc.canvasPadding,a=e.canvasWidth-i.left-i.right,n=e.canvasHeight-i.top-i.bottom;"pie-center"!==t.options.header.location&&(n-=t.textComponents.headerHeight),t.textComponents.footer.exists&&(n-=t.textComponents.footer.h);var r,s,o=(a<(n=n<0?0:n)?a:n)/3;if(null!==e.pieOuterRadius)if(/%/.test(e.pieOuterRadius)){s=(s=(s=parseInt(e.pieOuterRadius.replace(/[\D]/,""),10))>99?99:s)<0?0:s;var l=a<n?a:n;if("none"!==t.options.labels.outer.format){var c=2*parseInt(t.options.labels.outer.pieDistance,10);l-c>0&&(l-=c)}o=Math.floor(l/100*s)/2}else o=parseInt(e.pieOuterRadius,10);/%/.test(e.pieInnerRadius)?(s=(s=(s=parseInt(e.pieInnerRadius.replace(/[\D]/,""),10))>99?99:s)<0?0:s,r=Math.floor(o/100*s)):r=parseInt(e.pieInnerRadius,10),t.innerRadius=r,t.outerRadius=o},getTotalPieSize:function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i].value;return e},sortPieData:function(t){var e=t.options.data.content;switch(t.options.data.sortOrder){case"none":break;case"random":e=f.shuffleArray(e);break;case"value-asc":e.sort((function(t,e){return t.value<e.value?-1:1}));break;case"value-desc":e.sort((function(t,e){return t.value<e.value?1:-1}));break;case"label-asc":e.sort((function(t,e){return t.label.toLowerCase()>e.label.toLowerCase()?1:-1}));break;case"label-desc":e.sort((function(t,e){return t.label.toLowerCase()<e.label.toLowerCase()?1:-1}))}return e},getPieTranslateCenter:function(t){return"translate("+t.x+","+t.y+")"},calculatePieCenter:function(t){var e=t.options.misc.pieCenterOffset,i=t.textComponents.title.exists&&"pie-center"!==t.options.header.location,a=t.textComponents.subtitle.exists&&"pie-center"!==t.options.header.location,n=t.options.misc.canvasPadding.top;i&&a?n+=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h:i?n+=t.textComponents.title.h:a&&(n+=t.textComponents.subtitle.h);var r=0;t.textComponents.footer.exists&&(r=t.textComponents.footer.h+t.options.misc.canvasPadding.bottom);var s=(t.options.size.canvasWidth-t.options.misc.canvasPadding.left-t.options.misc.canvasPadding.right)/2+t.options.misc.canvasPadding.left,o=(t.options.size.canvasHeight-r-n)/2+n;s+=e.x,o+=e.y,t.pieCenter={x:s,y:o}},rotate:function(t,e,i,a,n){n=n*Math.PI/180;var r=Math.cos,s=Math.sin;return{x:(t-i)*r(n)-(e-a)*s(n)+i,y:(t-i)*s(n)+(e-a)*r(n)+a}},translate:function(t,e,i,a){var n=y.toRadians(a);return{x:t+i*Math.sin(n),y:e-i*Math.cos(n)}},pointIsInArc:function(t,e,i){var a=i.innerRadius()(e),n=i.outerRadius()(e),r=i.startAngle()(e),s=i.endAngle()(e),o=t.x*t.x+t.y*t.y,l=Math.atan2(t.x,-t.y);return l=l<0?l+2*Math.PI:l,a*a<=o&&o<=n*n&&r<=l&&l<=s}},x={add:function(t,e,i){var a=x.getIncludes(i),n=t.options.labels,r=t.svg.insert("g","."+t.cssPrefix+"labels-"+e).attr("class",t.cssPrefix+"labels-"+e).selectAll("."+t.cssPrefix+"labelGroup-"+e).data(t.options.data.content).enter().append("g").attr("id",(function(i,a){return t.cssPrefix+"labelGroup"+a+"-"+e})).attr("data-index",(function(t,e){return e})).attr("class",t.cssPrefix+"labelGroup-"+e).style("opacity",0),s={section:e,sectionDisplayType:i};a.mainLabel&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentMainLabel"+a+"-"+e})).attr("class",t.cssPrefix+"segmentMainLabel-"+e).text((function(t,e){var i=t.label;return n.formatter?(s.index=e,s.part="mainLabel",s.value=t.value,s.label=i,i=n.formatter(s)):n.truncation.enabled&&t.label.length>n.truncation.truncateLength&&(i=t.label.substring(0,n.truncation.truncateLength)+"..."),i})).style("font-size",n.mainLabel.fontSize+"px").style("font-family",n.mainLabel.font).style("fill",n.mainLabel.color),a.percentage&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentPercentage"+a+"-"+e})).attr("class",t.cssPrefix+"segmentPercentage-"+e).text((function(t,e){var i=t.percentage;return n.formatter?(s.index=e,s.part="percentage",s.value=t.value,s.label=t.percentage,i=n.formatter(s)):i+="%",i})).style("font-size",n.percentage.fontSize+"px").style("font-family",n.percentage.font).style("fill",n.percentage.color),a.value&&r.append("text").attr("id",(function(i,a){return t.cssPrefix+"segmentValue"+a+"-"+e})).attr("class",t.cssPrefix+"segmentValue-"+e).text((function(t,e){return s.index=e,s.part="value",s.value=t.value,s.label=t.value,n.formatter?n.formatter(s,t.value):t.value})).style("font-size",n.value.fontSize+"px").style("font-family",n.value.font).style("fill",n.value.color)},positionLabelElements:function(t,e,i){x["dimensions-"+e]=[],n.selectAll("."+t.cssPrefix+"labelGroup-"+e).each((function(i,a){var r=n.select(this).selectAll("."+t.cssPrefix+"segmentMainLabel-"+e),s=n.select(this).selectAll("."+t.cssPrefix+"segmentPercentage-"+e),o=n.select(this).selectAll("."+t.cssPrefix+"segmentValue-"+e);x["dimensions-"+e].push({mainLabel:null!==r.node()?r.node().getBBox():null,percentage:null!==s.node()?s.node().getBBox():null,value:null!==o.node()?o.node().getBBox():null})}));var a=x["dimensions-"+e];switch(i){case"label-value1":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width+5}));break;case"label-value2":n.selectAll("."+t.cssPrefix+"segmentValue-"+e).attr("dy",(function(t,e){return a[e].mainLabel.height}));break;case"label-percentage1":n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width+5}));break;case"label-percentage2":n.selectAll("."+t.cssPrefix+"segmentPercentage-"+e).attr("dx",(function(t,e){return a[e].mainLabel.width/2-a[e].percentage.width/2})).attr("dy",(function(t,e){return a[e].mainLabel.height}))}},computeLabelLinePositions:function(t){t.lineCoordGroups=[],n.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,i){return x.computeLinePosition(t,i)}))},computeLinePosition:function(t,e){var i,a,n,r,s=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),o=y.rotate(t.pieCenter.x,t.pieCenter.y-t.outerRadius,t.pieCenter.x,t.pieCenter.y,s),l=t.outerLabelGroupData[e].h/5,c=Math.floor(s/90);switch(2===c&&180===s&&(c=1),c){case 0:i=t.outerLabelGroupData[e].x-6-(t.outerLabelGroupData[e].x-6-o.x)/2,a=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 1:i=o.x+(t.outerLabelGroupData[e].x-o.x)/4,a=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x-6,r=t.outerLabelGroupData[e].y-l;break;case 2:var u=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;i=o.x-(o.x-u)/4,a=o.y+(t.outerLabelGroupData[e].y-o.y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l;break;case 3:var h=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6;i=h+(o.x-h)/4,a=t.outerLabelGroupData[e].y+(o.y-t.outerLabelGroupData[e].y)/4,n=t.outerLabelGroupData[e].x+t.outerLabelGroupData[e].w+6,r=t.outerLabelGroupData[e].y-l}"straight"===t.options.labels.lines.style?t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:n,y:r}]:t.lineCoordGroups[e]=[{x:o.x,y:o.y},{x:i,y:a},{x:n,y:r}]},addLabelLines:function(t){var e=t.svg.insert("g","."+t.cssPrefix+"pieChart").attr("class",t.cssPrefix+"lineGroups").style("opacity",0).selectAll("."+t.cssPrefix+"lineGroup").data(t.lineCoordGroups).enter().append("g").attr("class",t.cssPrefix+"lineGroup"),i=n.line().curve(n.curveBasis).x((function(t){return t.x})).y((function(t){return t.y}));e.append("path").attr("d",i).attr("stroke",(function(e,i){return"segment"===t.options.labels.lines.color?t.options.colors[i]:t.options.labels.lines.color})).attr("stroke-width",1).attr("fill","none").style("opacity",(function(e,i){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&e.percentage<a||""===t.options.data.content[i].label?0:1}))},positionLabelGroups:function(t,e){"none"!==t.options.labels[e].format&&n.selectAll("."+t.cssPrefix+"labelGroup-"+e).style("opacity",0).attr("transform",(function(i,a){var n,r;if("outer"===e)n=t.outerLabelGroupData[a].x,r=t.outerLabelGroupData[a].y;else{var s=m(!0,{},t.pieCenter);if(t.innerRadius>0){var o=v.getSegmentAngle(a,t.options.data.content,t.totalSize,{midpoint:!0}),l=y.translate(t.pieCenter.x,t.pieCenter.y,t.innerRadius,o);s.x=l.x,s.y=l.y}var c=f.getDimensions(t.cssPrefix+"labelGroup"+a+"-inner"),u=c.w/2,h=c.h/4;n=s.x+(t.lineCoordGroups[a][0].x-s.x)/1.8,r=s.y+(t.lineCoordGroups[a][0].y-s.y)/1.8,n-=u,r+=h}return"translate("+n+","+r+")"}))},fadeInLabelsAndLines:function(t){var e="default"===t.options.effects.load.effect?t.options.effects.load.speed:1;setTimeout((function(){var e="default"===t.options.effects.load.effect?400:1;n.selectAll("."+t.cssPrefix+"labelGroup-outer").transition().duration(e).style("opacity",(function(e,i){var a=t.options.labels.outer.hideWhenLessThanPercentage;return null!==a&&e.percentage<a?0:1})),n.selectAll("."+t.cssPrefix+"labelGroup-inner").transition().duration(e).style("opacity",(function(e,i){var a=t.options.labels.inner.hideWhenLessThanPercentage;return null!==a&&e.percentage<a?0:1})),n.selectAll("g."+t.cssPrefix+"lineGroups").transition().duration(e).style("opacity",1),f.isFunction(t.options.callbacks.onload)&&setTimeout((function(){try{t.options.callbacks.onload()}catch(t){}}),e)}),e)},getIncludes:function(t){var e=!1,i=!1,a=!1;switch(t){case"label":e=!0;break;case"value":i=!0;break;case"percentage":a=!0;break;case"label-value1":case"label-value2":e=!0,i=!0;break;case"label-percentage1":case"label-percentage2":e=!0,a=!0}return{mainLabel:e,value:i,percentage:a}},computeOuterLabelCoords:function(t){t.svg.selectAll("."+t.cssPrefix+"labelGroup-outer").each((function(e,i){return x.getIdealOuterLabelPositions(t,i)})),x.resolveOuterLabelCollisions(t)},resolveOuterLabelCollisions:function(t){if("none"!==t.options.labels.outer.format){var e=t.options.data.content.length;x.checkConflict(t,0,"clockwise",e),x.checkConflict(t,e-1,"anticlockwise",e)}},checkConflict:function(t,e,i,a){var n,r;if(!(a<=1)){var s=t.outerLabelGroupData[e].hs;if(!("clockwise"===i&&"right"!==s||"anticlockwise"===i&&"left"!==s)){var o="clockwise"===i?e+1:e-1,l=t.outerLabelGroupData[e],c=t.outerLabelGroupData[o],u={labelHeights:t.outerLabelGroupData[0].h,center:t.pieCenter,lineLength:t.outerRadius+t.options.labels.outer.pieDistance,heightChange:t.outerLabelGroupData[0].h+1};if("clockwise"===i){for(n=0;n<=e;n++)if(r=t.outerLabelGroupData[n],!x.isLabelHidden(t,n)&&f.rectIntersect(r,c)){x.adjustLabelPos(t,o,l,u);break}}else for(n=a-1;n>=e;n--)if(r=t.outerLabelGroupData[n],!x.isLabelHidden(t,n)&&f.rectIntersect(r,c)){x.adjustLabelPos(t,o,l,u);break}x.checkConflict(t,o,i,a)}}},isLabelHidden:function(t,e){var i=t.options.labels.outer.hideWhenLessThanPercentage;return null!==i&&d.percentage<i||""===t.options.data.content[e].label},adjustLabelPos:function(t,e,i,a){var n,r,s,o;o=i.y+a.heightChange,r=a.center.y-o,n=Math.abs(a.lineLength)>Math.abs(r)?Math.sqrt(a.lineLength*a.lineLength-r*r):Math.sqrt(r*r-a.lineLength*a.lineLength),s="right"===i.hs?a.center.x+n:a.center.x-n-t.outerLabelGroupData[e].w,t.outerLabelGroupData[e].x=s,t.outerLabelGroupData[e].y=o},getIdealOuterLabelPositions:function(t,e){var i=n.select("#"+t.cssPrefix+"labelGroup"+e+"-outer").node();if(i){var a=i.getBBox(),r=v.getSegmentAngle(e,t.options.data.content,t.totalSize,{midpoint:!0}),s=t.pieCenter.x,o=t.pieCenter.y-(t.outerRadius+t.options.labels.outer.pieDistance),l=y.rotate(s,o,t.pieCenter.x,t.pieCenter.y,r),c="right";r>180?(l.x-=a.width+8,c="left"):l.x+=8,t.outerLabelGroupData[e]={x:l.x,y:l.y,w:a.width,h:a.height,hs:c}}}},v={effectMap:{none:n.easeLinear,bounce:n.easeBounce,linear:n.easeLinear,sin:n.easeSin,elastic:n.easeElastic,back:n.easeBack,quad:n.easeQuad,circle:n.easeCircle,exp:n.easeExp},create:function(t){var e=t.pieCenter,i=t.options.colors,a=t.options.effects.load,r=t.options.misc.colors.segmentStroke,s=t.svg.insert("g","#"+t.cssPrefix+"title").attr("transform",(function(){return y.getPieTranslateCenter(e)})).attr("class",t.cssPrefix+"pieChart"),o=n.arc().innerRadius(t.innerRadius).outerRadius(t.outerRadius).startAngle(0).endAngle((function(e){return e.value/t.totalSize*2*Math.PI})),l=s.selectAll("."+t.cssPrefix+"arc").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"arc"),c=a.speed;"none"===a.effect&&(c=0),l.append("path").attr("id",(function(e,i){return t.cssPrefix+"segment"+i})).attr("fill",(function(e,a){var n=i[a];return t.options.misc.gradient.enabled&&(n="url(#"+t.cssPrefix+"grad"+a+")"),n})).style("stroke",r).style("stroke-width",1).transition().ease(n.easeCubicInOut).duration(c).attr("data-index",(function(t,e){return e})).attrTween("d",(function(e){var i=n.interpolate({value:0},e);return function(e){return t.arc(i(e))}})),t.svg.selectAll("g."+t.cssPrefix+"arc").attr("transform",(function(e,i){var a=0;return i>0&&(a=v.getSegmentAngle(i-1,t.options.data.content,t.totalSize)),"rotate("+a+")"})),t.arc=o},addGradients:function(t){var e=t.svg.append("defs").selectAll("radialGradient").data(t.options.data.content).enter().append("radialGradient").attr("gradientUnits","userSpaceOnUse").attr("cx",0).attr("cy",0).attr("r","120%").attr("id",(function(e,i){return t.cssPrefix+"grad"+i}));e.append("stop").attr("offset","0%").style("stop-color",(function(e,i){return t.options.colors[i]})),e.append("stop").attr("offset",t.options.misc.gradient.percentage+"%").style("stop-color",t.options.misc.gradient.color)},addSegmentEventHandlers:function(t){var e=n.selectAll("."+t.cssPrefix+"arc,."+t.cssPrefix+"labelGroup-inner,."+t.cssPrefix+"labelGroup-outer");e.on("click",(function(){var e,i=n.select(this);if(i.attr("class")===t.cssPrefix+"arc")e=i.select("path");else{var a=i.attr("data-index");e=n.select("#"+t.cssPrefix+"segment"+a)}var r=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onClickSegment,e,r),"none"!==t.options.effects.pullOutSegmentOnClick.effect&&(r?v.closeSegment(t,e.node()):v.openSegment(t,e.node()))})),e.on("mouseover",(function(){var e,i,a=n.select(this);if(a.attr("class")===t.cssPrefix+"arc"?e=a.select("path"):(i=a.attr("data-index"),e=n.select("#"+t.cssPrefix+"segment"+i)),t.options.effects.highlightSegmentOnMouseover){i=e.attr("data-index");var r=t.options.colors[i];e.style("fill",f.getColorShade(r,t.options.effects.highlightLuminosity))}t.options.tooltips.enabled&&(i=e.attr("data-index"),_.showTooltip(t,i));var s=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoverSegment,e,s)})),e.on("mousemove",(function(){_.moveTooltip(t)})),e.on("mouseout",(function(){var e,i,a=n.select(this);if(a.attr("class")===t.cssPrefix+"arc"?e=a.select("path"):(i=a.attr("data-index"),e=n.select("#"+t.cssPrefix+"segment"+i)),t.options.effects.highlightSegmentOnMouseover){i=e.attr("data-index");var r=t.options.colors[i];t.options.misc.gradient.enabled&&(r="url(#"+t.cssPrefix+"grad"+i+")"),e.style("fill",r)}t.options.tooltips.enabled&&(i=e.attr("data-index"),_.hideTooltip(t,i));var s=e.attr("class")===t.cssPrefix+"expanded";v.onSegmentEvent(t,t.options.callbacks.onMouseoutSegment,e,s)}))},onSegmentEvent:function(t,e,i,a){if(f.isFunction(e)){var n=parseInt(i.attr("data-index"),10);e({segment:i.node(),index:n,expanded:a,data:t.options.data.content[n]})}},openSegment:function(t,e){t.isOpeningSegment||(t.isOpeningSegment=!0,v.maybeCloseOpenSegment(),n.select(e).transition().ease(v.effectMap[t.options.effects.pullOutSegmentOnClick.effect]).duration(t.options.effects.pullOutSegmentOnClick.speed).attr("transform",(function(e,i){var a=t.arc.centroid(e),n=a[0],r=a[1],s=Math.sqrt(n*n+r*r),o=parseInt(t.options.effects.pullOutSegmentOnClick.size,10);return"translate("+n/s*o+","+r/s*o+")"})).on("end",(function(i,a){t.currentlyOpenSegment=e,t.isOpeningSegment=!1,n.select(e).attr("class",t.cssPrefix+"expanded")})))},maybeCloseOpenSegment:function(){n.selectAll("."+pie.cssPrefix+"expanded").size()>0&&v.closeSegment(pie,n.select("."+pie.cssPrefix+"expanded").node())},closeSegment:function(t,e){n.select(e).transition().duration(400).attr("transform","translate(0,0)").on("end",(function(i,a){n.select(e).attr("class",""),t.currentlyOpenSegment=null}))},getCentroid:function(t){var e=t.getBBox();return{x:e.x+e.width/2,y:e.y+e.height/2}},getSegmentAngle:function(t,e,i,a){var n,r=m({compounded:!0,midpoint:!1},a),s=e[t].value;if(r.compounded){n=0;for(var o=0;o<=t;o++)n+=e[o].value}void 0===n&&(n=s);var l=n/i*360;r.midpoint&&(l-=s/i*360/2);return l}},b={offscreenCoord:-1e4,addTitle:function(t){t.svg.selectAll("."+t.cssPrefix+"title").data([t.options.header.title]).enter().append("text").text((function(t){return t.text})).attr("id",t.cssPrefix+"title").attr("class",t.cssPrefix+"title").attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("text-anchor",(function(){return"top-center"===t.options.header.location||"pie-center"===t.options.header.location?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionTitle:function(t){var e,i=t.textComponents,a=t.options.header.location,n=t.options.misc.canvasPadding,r=t.options.size.canvasWidth,s=t.options.header.titleSubtitlePadding;e="top-left"===a?n.left:(r-n.right)/2+n.left,e+=t.options.misc.pieCenterOffset.x;var o=n.top+i.title.h;"pie-center"===a&&(o=t.pieCenter.y,i.subtitle.exists?o=o-(i.title.h+s+i.subtitle.h)/2+i.title.h:o+=i.title.h/4);t.svg.select("#"+t.cssPrefix+"title").attr("x",e).attr("y",o)},addSubtitle:function(t){var e=t.options.header.location;t.svg.selectAll("."+t.cssPrefix+"subtitle").data([t.options.header.subtitle]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"subtitle").attr("class",t.cssPrefix+"subtitle").attr("text-anchor",(function(){return"top-center"===e||"pie-center"===e?"middle":"left"})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionSubtitle:function(t){var e,i=t.options.misc.canvasPadding,a=t.options.size.canvasWidth;e="top-left"===t.options.header.location?i.left:(a-i.right)/2+i.left,e+=t.options.misc.pieCenterOffset.x;var n=b.getHeaderHeight(t);t.svg.select("#"+t.cssPrefix+"subtitle").attr("x",e).attr("y",n)},addFooter:function(t){t.svg.selectAll("."+t.cssPrefix+"footer").data([t.options.footer]).enter().append("text").text((function(t){return t.text})).attr("x",b.offscreenCoord).attr("y",b.offscreenCoord).attr("id",t.cssPrefix+"footer").attr("class",t.cssPrefix+"footer").attr("text-anchor",(function(){var e="left";return"bottom-center"===t.options.footer.location?e="middle":"bottom-right"===t.options.footer.location&&(e="left"),e})).attr("fill",(function(t){return t.color})).style("font-size",(function(t){return t.fontSize+"px"})).style("font-family",(function(t){return t.font}))},positionFooter:function(t){var e,i=t.options.footer.location,a=t.textComponents.footer.w,n=t.options.size.canvasWidth,r=t.options.size.canvasHeight,s=t.options.misc.canvasPadding;e="bottom-left"===i?s.left:"bottom-right"===i?n-a-s.right:n/2,t.svg.select("#"+t.cssPrefix+"footer").attr("x",e).attr("y",r-s.bottom)},getHeaderHeight:function(t){var e;if(t.textComponents.title.exists){var i=t.textComponents.title.h+t.options.header.titleSubtitlePadding+t.textComponents.subtitle.h;e="pie-center"===t.options.header.location?t.pieCenter.y-i/2+i:i+t.options.misc.canvasPadding.top}else if("pie-center"===t.options.header.location){var a=t.options.misc.canvasPadding.bottom+t.textComponents.footer.h;e=(t.options.size.canvasHeight-a)/2+t.options.misc.canvasPadding.top+t.textComponents.subtitle.h/2}else e=t.options.misc.canvasPadding.top+t.textComponents.subtitle.h;return e}},_={addTooltips:function(t){var e=t.svg.insert("g").attr("class",t.cssPrefix+"tooltips");e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).enter().append("g").attr("class",t.cssPrefix+"tooltip").attr("id",(function(e,i){return t.cssPrefix+"tooltip"+i})).style("opacity",0).append("rect").attr("rx",t.options.tooltips.styles.borderRadius).attr("ry",t.options.tooltips.styles.borderRadius).attr("x",-t.options.tooltips.styles.padding).attr("opacity",t.options.tooltips.styles.backgroundOpacity).style("fill",t.options.tooltips.styles.backgroundColor),e.selectAll("."+t.cssPrefix+"tooltip").data(t.options.data.content).append("text").attr("fill",(function(e){return t.options.tooltips.styles.color})).style("font-size",(function(e){return t.options.tooltips.styles.fontSize})).style("font-family",(function(e){return t.options.tooltips.styles.font})).text((function(e,i){var a=t.options.tooltips.string;return"caption"===t.options.tooltips.type&&(a=e.caption),_.replacePlaceholders(t,a,i,{label:e.label,value:e.value,percentage:e.percentage})})),e.selectAll("."+t.cssPrefix+"tooltip rect").attr("width",(function(e,i){return f.getDimensions(t.cssPrefix+"tooltip"+i).w+2*t.options.tooltips.styles.padding})).attr("height",(function(e,i){return f.getDimensions(t.cssPrefix+"tooltip"+i).h+2*t.options.tooltips.styles.padding})).attr("y",(function(e,i){return-f.getDimensions(t.cssPrefix+"tooltip"+i).h/2+1}))},showTooltip:function(t,e){var i=t.options.tooltips.styles.fadeInSpeed;_.currentTooltip===e&&(i=1),_.currentTooltip=e,n.select("#"+t.cssPrefix+"tooltip"+e).transition().duration(i).style("opacity",(function(){return 1})),_.moveTooltip(t)},moveTooltip:function(t){n.selectAll("#"+t.cssPrefix+"tooltip"+_.currentTooltip).attr("transform",(function(e){var i=n.mouse(this.parentNode);return"translate("+(i[0]+t.options.tooltips.styles.padding+2)+","+(i[1]-2*t.options.tooltips.styles.padding-2)+")"}))},hideTooltip:function(t,e){n.select("#"+t.cssPrefix+"tooltip"+e).style("opacity",(function(){return 0})),n.select("#"+t.cssPrefix+"tooltip"+_.currentTooltip).attr("transform",(function(e,i){return"translate("+(t.options.size.canvasWidth+1e3)+","+(t.options.size.canvasHeight+1e3)+")"}))},replacePlaceholders:function(t,e,i,a){f.isFunction(t.options.tooltips.placeholderParser)&&t.options.tooltips.placeholderParser(i,a);return e.replace(/\{(\w+)\}/g,(function(t){var e=arguments[1];return a.hasOwnProperty(e)?a[arguments[1]]:arguments[0]}))}},w=function(t,e){if(this.element=t,"string"==typeof t){var i=t.replace(/^#/,"");this.element=document.getElementById(i)}var a={};m(!0,a,p,e),this.options=a,null!==this.options.misc.cssPrefix?this.cssPrefix=this.options.misc.cssPrefix:(this.cssPrefix="p"+h+"_",h++),g(this)&&(n.select(this.element).attr("d3pie","0.2.1"),S.call(this),k.call(this))};w.prototype.recreate=function(){g(this)&&(S.call(this),k.call(this))},w.prototype.redraw=function(){this.element.innerHTML="",k.call(this)},w.prototype.destroy=function(){this.element.innerHTML="",n.select(this.element).attr("d3pie",null)},w.prototype.getOpenSegment=function(){var t=this.currentlyOpenSegment;if(null!=t){var e=parseInt(n.select(t).attr("data-index"),10);return{element:t,index:e,data:this.options.data.content[e]}}return null},w.prototype.openSegment=function(t){(t=parseInt(t,10))<0||t>this.options.data.content.length-1||v.openSegment(this,n.select("#"+this.cssPrefix+"segment"+t).node())},w.prototype.closeSegment=function(){v.maybeCloseOpenSegment()},w.prototype.updateProp=function(t,e){switch(t){case"header.title.text":var i=f.processObj(this.options,t);f.processObj(this.options,t,e),n.select("#"+this.cssPrefix+"title").html(e),(""===i&&""!==e||""!==i&&""===e)&&this.redraw();break;case"header.subtitle.text":var a=f.processObj(this.options,t);f.processObj(this.options,t,e),n.select("#"+this.cssPrefix+"subtitle").html(e),(""===a&&""!==e||""!==a&&""===e)&&this.redraw();break;case"callbacks.onload":case"callbacks.onMouseoverSegment":case"callbacks.onMouseoutSegment":case"callbacks.onClickSegment":case"effects.pullOutSegmentOnClick.effect":case"effects.pullOutSegmentOnClick.speed":case"effects.pullOutSegmentOnClick.size":case"effects.highlightSegmentOnMouseover":case"effects.highlightLuminosity":f.processObj(this.options,t,e);break;default:f.processObj(this.options,t,e),this.destroy(),this.recreate()}};var S=function(){this.options.data.content=y.sortPieData(this),this.options.data.smallSegmentGrouping.enabled&&(this.options.data.content=f.applySmallSegmentGrouping(this.options.data.content,this.options.data.smallSegmentGrouping)),this.options.colors=f.initSegmentColors(this),this.totalSize=y.getTotalPieSize(this.options.data.content);for(var t=this.options.labels.percentage.decimalPlaces,e=0;e<this.options.data.content.length;e++)this.options.data.content[e].percentage=T(this.options.data.content[e].value,this.totalSize,t);for(var i=0,a=0;a<this.options.data.content.length;a++)a===this.options.data.content.length-1&&(this.options.data.content[a].percentage=(100-i).toFixed(t)),i+=parseFloat(this.options.data.content[a].percentage)},k=function(){this.svg=f.addSVGSpace(this),this.textComponents={headerHeight:0,title:{exists:""!==this.options.header.title.text,h:0,w:0},subtitle:{exists:""!==this.options.header.subtitle.text,h:0,w:0},footer:{exists:""!==this.options.footer.text,h:0,w:0}},this.outerLabelGroupData=[],this.textComponents.title.exists&&b.addTitle(this),this.textComponents.subtitle.exists&&b.addSubtitle(this),b.addFooter(this);var t=this;f.whenIdExists(this.cssPrefix+"footer",(function(){b.positionFooter(t);var e=f.getDimensions(t.cssPrefix+"footer");t.textComponents.footer.h=e.h,t.textComponents.footer.w=e.w}));var e=[];this.textComponents.title.exists&&e.push(this.cssPrefix+"title"),this.textComponents.subtitle.exists&&e.push(this.cssPrefix+"subtitle"),this.textComponents.footer.exists&&e.push(this.cssPrefix+"footer"),f.whenElementsExist(e,(function(){if(t.textComponents.title.exists){var e=f.getDimensions(t.cssPrefix+"title");t.textComponents.title.h=e.h,t.textComponents.title.w=e.w}if(t.textComponents.subtitle.exists){var i=f.getDimensions(t.cssPrefix+"subtitle");t.textComponents.subtitle.h=i.h,t.textComponents.subtitle.w=i.w}if(t.textComponents.title.exists||t.textComponents.subtitle.exists){var a=0;t.textComponents.title.exists&&(a+=t.textComponents.title.h,t.textComponents.subtitle.exists&&(a+=t.options.header.titleSubtitlePadding)),t.textComponents.subtitle.exists&&(a+=t.textComponents.subtitle.h),t.textComponents.headerHeight=a}y.computePieRadius(t),y.calculatePieCenter(t),b.positionTitle(t),b.positionSubtitle(t),t.options.misc.gradient.enabled&&v.addGradients(t),v.create(t),x.add(t,"inner",t.options.labels.inner.format),x.add(t,"outer",t.options.labels.outer.format),x.positionLabelElements(t,"inner",t.options.labels.inner.format),x.positionLabelElements(t,"outer",t.options.labels.outer.format),x.computeOuterLabelCoords(t),x.positionLabelGroups(t,"outer"),x.computeLabelLinePositions(t),t.options.labels.lines.enabled&&"none"!==t.options.labels.outer.format&&x.addLabelLines(t),x.positionLabelGroups(t,"inner"),x.fadeInLabelsAndLines(t),t.options.tooltips.enabled&&_.addTooltips(t),v.addSegmentEventHandlers(t)}))},T=function(t,e,i){var a=t/e;return i<=0?Math.round(100*a):(100*a).toFixed(i)},C=w,P=i(6),F=i(23),A=i(8),L=i.n(A),M={};function I(t,e,i,a){if(t.endAngle-t.startAngle==0)return"M 0 0";var n=e*Math.cos(t.startAngle),r=i*Math.sin(t.startAngle),s=e*Math.cos(t.endAngle),o=i*Math.sin(t.endAngle),l=[];return l.push("M",n,r,"A",e,i,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",s,o,"L",a*s,a*o),l.push("A",a*e,a*i,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",a*n,a*r,"z"),l.join(" ")}function D(t,e,i,a){var n=t.startAngle>Math.PI?Math.PI:t.startAngle,r=t.endAngle>Math.PI?Math.PI:t.endAngle,s=e*Math.cos(n),o=i*Math.sin(n),l=e*Math.cos(r),c=i*Math.sin(r),u=[];return u.push("M",s,a+o,"A",e,i,"0 0 1",l,a+c,"L",l,c,"A",e,i,"0 0 0",s,o,"z"),u.join(" ")}function B(t,e,i,a,n){var r=t.startAngle<Math.PI?Math.PI:t.startAngle,s=t.endAngle<Math.PI?Math.PI:t.endAngle,o=n*e*Math.cos(r),l=n*i*Math.sin(r),c=n*e*Math.cos(s),u=n*i*Math.sin(s),h=[];return h.push("M",o,l,"A",n*e,n*i,"0 0 1",c,u,"L",c,a+u,"A",n*e,n*i,"0 0 0",o,a+l,"z"),h.join(" ")}function V(t,e,i,a,n,r,s){t.data(e).enter().append("text").attr("class","percent").attr("x",(function(t){var e=AJS.$("<span>"+s(t)+"</span>");e.appendTo("body");var n=e.width();e.remove();var r=a*i,o=Math.cos(.5*(t.startAngle+t.endAngle));return.5*(a-r)*o+r*o-n/2})).attr("y",(function(t){var e=n*i,a=Math.sin(.5*(t.startAngle+t.endAngle));return.5*(n-e)*a+e*a+r})).text((function(t){return s(t)})).style("fill",(function(t){return t.data.textColor})).each((function(t){this._current=t}))}M.getPercent=function(t){return Math.round(1e3*(t.endAngle-t.startAngle)/(2*Math.PI))/10+"%"},M.transition=function(t,e,i,a,r,s){var o=n.pie().sort(null).value((function(t){return t.value}))(e);n.select("#"+t).selectAll(".innerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return B(e(t),i+.5,a+.5,r,s)}})),n.select("#"+t).selectAll(".topSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return I(e(t),i,a,s)}})),n.select("#"+t).selectAll(".outerSlice").data(o).transition().duration(750).attrTween("d",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return D(e(t),i-.5,a-.5,r)}})),n.select("#"+t).selectAll(".percent").data(o).transition().duration(750).attrTween("x",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return.6*i*Math.cos(.5*(e(t).startAngle+e(t).endAngle))}})).attrTween("y",(function(t){var e=n.interpolate(this._current,t);return this._current=e(0),function(t){return.6*i*Math.sin(.5*(e(t).startAngle+e(t).endAngle))}})).text(M.getPercent)},M.draw=function(t,e,i,a,r,s,o,l,c,u,h){var d=n.pie().sort(null).value((function(t){return t.value}))(e),p=n.select("#"+t).append("g").attr("transform","translate("+i+","+a+")").attr("class","slices");p.selectAll(".innerSlice").data(d).enter().append("path").attr("class","innerSlice").style("fill",(function(t){return n.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return B(t,r+.5,s+.5,o,l)})).each((function(t){this._current=t})),p.selectAll(".topSlice").data(d).enter().append("path").attr("class","topSlice").style("fill",(function(t){return t.data.color})).style("stroke",(function(t){return t.data.color})).attr("d",(function(t){return I(t,r,s,l)})).each((function(t){this._current=t})),p.selectAll(".outerSlice").data(d).enter().append("path").attr("class","outerSlice").style("fill",(function(t){return n.hsl(t.data.color).darker(.7)})).attr("d",(function(t){return D(t,r-.5,s-.5,o)})).each((function(t){this._current=t}));var g=l||.25,f=p.selectAll(".percent"),m=0;if(c){var y=function(){V(f,d,g,r,s,m,(function(t){return M.getPercent(t)})),m-=20},x=function(){V(f,d,g,r,s,m,(function(t){return h(t.value)})),m-=20};u.value_percentage?(m=20,x(),y()):u.percentage_value?(m=20,y(),x()):(m=10,u.value?x():y())}V(f,d,g,r,s,m,(function(t){return t.data.label}))};var O=M,E=(i(50),i(51),function(){var t=[],e={axisLength:600},i=null,a=null,r=n.timeFormat("%d%b"),s=null,o=null;function l(){}return l.init=function(){i=n.scaleTime().domain([t[0],t[1]]).range([0,e.axisLength]).clamp(!0),a=n.axisBottom(i).tickSize(5).ticks(s,o).tickFormat(r)},l.ticks=function(){return i.ticks(s,o).map((function(t){return i(t)}))},l.position=function(t){return i(t)},l.draw=function(t){t.call(a).selectAll("text").attr("transform","translate(0,0)")},l.getAxisLine=function(){return i},l.getAxis=function(){return a},l.domain=function(e){return arguments.length?(t=e,l):t},l.ticksConfig=function(t){return s=t.ticksSize,o=t.ticksStep,l},l.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return l},l.configValue=function(t,i){return e[t]=i,l},l.tickFormat=function(t){return arguments.length?(r=t,l):r},l}),N=function(){var t,e=1,i=[],a={},n=0,r={axisLength:null,barHeight:15,progressBarPorcHeight:100,barPadding:5,barMargin:5,minTaskBandHeight:30,mileStoneHeight:0};d.init=function(){for(var t,e=0,r=0,l=0;l<i.length;l++){t=i[l];var c=s(t);r=e+c+o(t),a[t]={taskIni:e,taskEnd:e+c,mStoneIni:e+c,mStoneEnd:r},e=r}return n=r,d},d.ticks=function(){for(var t,e,a=[],n=0;n<i.length;n++)t=i[n],e=c(t),a.push(d.scaleValue(e[0]));return null!=e&&a.push(d.scaleValue(e[1])),a},d.position=function(e){if(z(e,"startDate"))var i=t.taskTotalOverlaps(e),a=u(e.category)[0]+r.barMargin+i*(r.barHeight+r.barPadding);else{if(!z(e,"date"))return null;a=h(e.category)[0]+r.mileStoneHeight-6}return d.scaleValue(a)},d.draw=function(t){return t.selectAll("line.axisY").remove(),t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",d.scaleValue(n)).attr("class","axisY").attr("style","stroke:black"),t.selectAll("g").remove(),t.selectAll("g").data(i,(function(t){return t})).enter().append("g").attr("transform",l).append("text").attr("x","-5").attr("style","text-anchor: end").attr("class","tickY-label").text((function(t){return t})),t.selectAll("line.tickY").remove(),t.selectAll("line.tickY").data(d.ticks()).enter().append("line").attr("class","tickY").attr("x1","0").attr("y1",(function(t){return t})).attr("x2","-5").attr("y2",(function(t){return t})),d};var s=function(e){var i=t.categoryMaxOverlaps(e),a=r.minTaskBandHeight;return i>0&&(a=r.barMargin+(i-1)*(r.barHeight+r.barPadding)+r.barHeight+r.barMargin),a},o=function(){return r.mileStoneHeight},l=function(t){var e=c(t),i=e[0]+(e[1]-e[0])/2;return"translate(0,"+d.scaleValue(i)+")"};d.scaleValue=function(t){var e=1;return null!=r.axisLength&&n>0&&(e=r.axisLength/n),t*e};var c=function(t){return[a[t].taskIni,a[t].mStoneEnd]},u=function(t){return[a[t].taskIni,a[t].taskEnd]},h=function(t){return[a[t].mStoneIni,a[t].mStoneEnd]};function d(){}return d.overlappingResolver=function(e){return arguments.length?(t=e,d):t},d.categories=function(t){return arguments.length?(i=t,d):i},d.scale=function(t){return arguments.length?(e=t,d):e},d.config=function(t){if(!arguments.length)return r;for(var e in r)r[e]=t[e];return d},d.configValue=function(t,e){return r[t]=e,d},d.calculatedLength=function(){return n},d},H=function(){var t=[],e=[],i={},a=[];s.categories=function(e){return arguments.length?(t=e,s):t},s.tasks=function(t){return arguments.length?(e=t,i={},a=[],s):e},s.categoryMaxOverlaps=function(t){return a[t]?a[t].length:0},s.taskOverlaps=function(t){return i[t.id]},s.taskTotalOverlapsOld=function(t){var e=[];return function t(e,a){if(!z(i,e))return;for(var n=0;n<i[e].length;n++)t(i[e][n],a),a.push(i[e][n])}(t.id,e),e.filter((function(t,i){return e.indexOf(t)==i}))},s.taskTotalOverlaps=function(t){var e=t.id;return null!=i[e]?i[e].length:0};s.calculateOverlapping=function(){for(var e=0;e<t.length;e++){var i=[];a[t[e]]=i,n(t[e],i)}return s};var n=function(t,i){var a=e.filter((function(e){return e.category==t}));if(null!=a&&a.length>0)for(var n=0;n<a.length;n++)r(a[n],i)},r=function(t,e){for(var a,n,r=e.length,s=0;s<e.length;s++){if(!(t.startDate<e[s].endDate)){r=s;break}a=t,n=e[s],z(i,a.id)||(i[a.id]=[]),i[a.id].push(n.id)}e[r]=t};function s(){return s}return s};function z(t,e){var i=t.__proto__||t.constructor.prototype;return e in t&&(!(e in i)||i[e]!==t[e])}var G=function(t){var e={axisLength:600,barHeight:15,progressBarHeight:5},i=null,a=null,n=function(t){for(var e in a)t.on(e,a[e])};function r(){}return r.draw=function(a){a.append("rect").attr("y",0).attr("height",t.scaleValue(e.barHeight)).attr("width",i).attr("class",(function(t){return z(t,"class")?t.class+"-bar":"task-bar"})).attr("style",(function(t){return t.style})).attr("rx",3).attr("ry",3).call(n),a.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return z(t,"progress")?i(t):0})).attr("style",(function(t){return t.todoStyle})).attr("class","task-progress-bar-total"),a.append("rect").attr("y",t.scaleValue((e.barHeight-e.progressBarHeight)/2)).attr("height",t.scaleValue(e.progressBarHeight)).attr("width",(function(t){return z(t,"progress")?t.progress*i(t):0})).attr("class",(function(t){return z(t,"class")?t.class+"-progress-bar":"task-progress-bar"})).attr("style",(function(t){return t.doneStyle})).call(n),a.append("text").attr("y",(function(i){var a=t.scaleValue(e.barHeight);return null==i.progress?a/2+5:a-3})).attr("x",5).attr("class",(function(t){return z(t,"class")?t.class+"-label":"task-label"})).attr("style",(function(t){return t.labelStyle})).text((function(t){if(!t.label)return"";var e=i(t)-10,a=t.label,n=t.label.length;if(this.textContent=t.label,this.getComputedTextLength())for(;n>0&&this.getSubStringLength(0,n)>e;)n--;return n===t.label.length?a:0===n?"":a.substring(0,n)+"…"}))},r.eventHandlers=function(t){return arguments.length?(a=t,r):a},r.calculateBarWidth=function(t){return arguments.length?(i=t,r):i},r.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return r},r.configValue=function(t,i){return e[t]=i,r},r},W=function(){var t=null,e={mileStoneRadius:2},i=function(e){for(var i in t)e.on(i,t[i])};function a(){}return a.draw=function(t){t.append("polygon").attr("points","10,1 4,19.8 19,7.8 1,7.8 16,19.8").attr("class",(function(t){return z(t,"class")?t.class+"-mark":"milestone-mark"})).attr("style",(function(t){return t.style})).call(i),t.append("text").attr("x",2).attr("y",30).attr("style",(function(t){return t.style+";font-size: 14px"})).attr("class",(function(t){return z(t,"class")?t.class+"-label":"milestone-label"})).text((function(t){return t.label}))},a.eventHandlers=function(e){return arguments.length?(t=e,a):t},a.config=function(t){if(!arguments.length)return e;for(var i in e)e[i]=t[i];return a},a.configValue=function(t,i){return e[t]=i,a},a},R=function(){var t=null,e={chartHeight:100};function i(){}return i.draw=function(t){t.append("line").attr("x1","0").attr("y1","0").attr("x2","0").attr("y2",e.chartHeight).attr("class",(function(t){return z(t,"class")?t.class+"-line":"dateline-line"})).attr("style",(function(t){return t.style}));var i=t.append("text").attr("y",-4).attr("class",(function(t){return z(t,"class")?t.class+"-label":"dateline-label"})).style("text-anchor","middle").text((function(t){return t.label})),a=[];i.each((function(){var t=this.getClientRects();if(0===t.length)return!1;t=t[0];var e=0;a.some((function(i){if(i<t.x)return!0;e++})),a[e]=t.x+t.width,this.setAttribute("y",parseFloat(this.getAttribute("y"))+16*e),e>0&&(a[e]=a[e]+5,this.setAttribute("x",0))}))},i.eventHandlers=function(e){return arguments.length?(t=e,i):t},i.config=function(t){if(!arguments.length)return e;for(var a in e)e[a]=t[a];return i},i.configValue=function(t,a){return e[t]=a,i},i},j=function(t,e,i){t=t;var a=Math.floor(1e6*Math.random()+1),r={top:20,right:40,bottom:140,left:150},s=(e=null,i=null,null),o=null,l="fit",c="%d/%b",u=null,h=null,d=!0,p=[],g=[],f=[],m=[],y=H(),x=N(),v=E(),b=G(x),_=W(),w=R(),S={task:{},milestone:{},dateline:{}},k=function(){return null!=e&&e>0?e:x.calculatedLength()},T=function(){return null!=i&&i>0?i-r.right-r.left-5:document.body.clientWidth-r.right-r.left-5},C=function(t){return"t_"+t.id},P=function(t){return"ms_"+t.id},F=function(t){return"translate("+v.position(t.startDate)+","+x.position(t)+")"},A=function(t){var e=L(t);return"translate("+e.x+","+e.y+")"},L=function(t){var e=v.position(t.date)-10,i=x.position(t),a=$.grep(g,(function(e){return e.category===t.category}));if(a.length){var n=a[0];a.some((function(e){if(!(e.startDate<=t.date))return!0;n=e})),i=x.position(n)+x.scaleValue(15)/2}return{x:e,y:i-10}},M=function(t){return"translate("+v.position(t.date)+",0)"},I=function(){return t.selectAll("svg").data([a],(function(t){return t})).selectAll(".gantt-chart")},D=function(t,e){var i=S[e],a=function(i){t.on(i,(function(t){S[e].hasOwnProperty(i)&&S[e][i](t)}))};for(var n in i)a(n)},B=function(){v.domain([s,o]).tickFormat(c).ticksConfig({ticksSize:u,ticksStep:h}).configValue("axisLength",T()),v.init(),null==p&&(p=function(t){var e={};t.map((function(t){e.hasOwnProperty(e,t.category)||(e[t.category]=!0)}));var i=[];for(var a in e)i.push(a);return i}(g)),x.overlappingResolver(y).categories(p),null!=e&&x.configValue("axisLength",e),x.init()},V=function(){var t=I(),e=t.select("g.yaxis-group");x.draw(e);var i=t.select("g.xaxis-group");i.attr("transform","translate(0, "+k()+")"),v.draw(i),i.selectAll(".tick").classed("minor",(function(t){return t.getMonth()}))},O=function(){var t=I().select("g.grid-group");t.selectAll("line.gridX").remove(),t.selectAll("line.gridX").data(v.ticks(),(function(t){return t})).enter().append("line").attr("class","gridX").attr("x1",(function(t){return t})).attr("x2",(function(t){return t})).attr("y1",0).attr("y2",k()).style("stroke","#ccc");var e=T();t.selectAll("line.gridY").remove(),t.selectAll("line.gridY").data(x.ticks(),(function(t){return t})).enter().append("line").attr("class","gridY").attr("x1",0).attr("x2",e).attr("y1",(function(t){return t})).attr("y2",(function(t){return t})).style("stroke","#ccc")},z=function(){var c;!function(t){if("fit"===l){if(void 0===t||t.length<1)return s=n.timeDay.offset(new Date,-3),void(o=n.timeHour.offset(new Date,3));s=t.reduce((function(t,e){return t.startDate<e.startDate?t:e})).startDate,o=t.reduce((function(t,e){return t.endDate>e.endDate?t:e})).endDate,v.domain([s,o]).init()}}(g),(c=t.selectAll("svg").data([a],(function(t){return t})).enter().append("svg").attr("class","chart").attr("width",i).attr("height",e).append("g").attr("class","gantt-chart").attr("transform","translate("+r.left+", "+r.top+")")).append("g").attr("class","grid-group"),c.append("g").attr("class","gantt-bars"),c.append("g").attr("class","yaxis-group"),c.append("g").attr("class","xaxis-group")},j=function(t){var e=16*(t.length-1);t.forEach((function(t,i){t.forEach((function(t){var a=L(t.d);AJS.$(t.el).attr("transform","translate("+a.x+","+(a.y-e+32*i)+")")}))}))},X=function(t){return t.endDate>s&&t.startDate<o},K=function(t){return t.date>=s&&t.date<=o},Y=function(t){return t.date>=s&&t.date<=o},U=function(t){var e=Math.max(s,t.startDate),i=Math.min(o,t.endDate);return v.position(i)-v.position(e)};function J(){return J}return J.draw=function(){t.selectAll("svg").data([a],(function(t){return t})).empty()?z():t.selectAll("svg").data([a],(function(t){return t})).selectAll("g.gantt-chart").attr("transform","translate("+r.left+", "+r.top+")");var e=g.filter(X);return y.tasks(e).calculateOverlapping(),B(),d&&O(),V(),function(t){var e=t.filter(X),i=I().select(".gantt-bars");i.selectAll("g").remove();var a=i.selectAll("g.g_task").data(e,C).enter().append("g").attr("class","g_task").attr("y",0).attr("transform",F);b.calculateBarWidth(U).eventHandlers(S.task).draw(a)}(g),function(t){var e=t.filter(Y).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),i=I().select(".gantt-bars");i.selectAll("g.g_dateline").remove();var a=i.selectAll("g").data(e,(function(t){return t.date})).enter().append("g").attr("class","g_dateline").attr("y",0).attr("transform",M).call(D,"dateline");w.configValue("chartHeight",k()).eventHandlers(S.dateline).draw(a)}(m),function(t){var e=t.filter(K).sort((function(t,e){return t.date.getTime()-e.date.getTime()})),i=I().select(".gantt-bars");i.selectAll("g.g_mileStone").remove();var a=i.selectAll("g.g_milestone").data(e,P).enter().append("g").attr("class","g_milestone").attr("y",0).attr("transform",A);_.eventHandlers(S.milestone).draw(a);var n=[],r=[];a.each((function(t){var e=this.getClientRects();if(0===e.length)return!1;(e=e[0]).y=Math.round(e.y),n[e.y]||(n[e.y]=[],r[e.y]=[]);var i=0,a=!0,s=!1;n[e.y].some((function(t){if(t<e.x)s=!0;else{if(a=!1,s)return!0;i++}})),a&&(j(r[e.y]),n[e.y]=[],r[e.y]=[]),n[e.y][i]=e.x+e.width,r[e.y][i]||(r[e.y][i]=[]),r[e.y][i].push({el:this,d:t})})),r.forEach((function(t){j(t)}))}(f),n.select("body").select("svg").data([a],(function(t){return t})).style("height",k()+r.top+r.bottom),J},J.init=function(){z(),B()},J.getTimeAxisRenderer=function(){return v},J.margin=function(t){return arguments.length?(r=t,J):r},J.timeDomain=function(t){return arguments.length?(s=+t[0],o=+t[1],J):[s,o]},J.timeDomainMode=function(t){return arguments.length?(l=t,J):l},J.ticks=function(t){return u=t.ticksSize,h=t.ticksStep,J},J.container=function(e){return t=e,J},J.grid=function(t){return d=t,J},J.id=function(t){return arguments.length?(a=t,J):a},J.width=function(t){return arguments.length?(i=t,J):i},J.height=function(t){return arguments.length?(e=t,J):e},J.tickFormat=function(t){return arguments.length?(c=t,J):c},J.categories=function(t){return arguments.length?(p=t,y.categories(p),J):p},J.tasks=function(t){return arguments.length?(g=t,J):g},J.mileStones=function(t){return arguments.length?(f=t,J):f},J.dateLines=function(t){return arguments.length?(m=t,J):m},J.overlappingResolver=function(t){return arguments.length?(y=t,J):y},J.categoryAxisRenderer=function(t){return arguments.length?(x=t,J):x},J.taskRenderer=function(t){return arguments.length?(b=t,J):b},J.msRenderer=function(t){return arguments.length?(_=t,J):_},J.datelineRenderer=function(t){return arguments.length?(w=t,J):w},J.taskEventHandler=function(t,e){return S.task[t]=e,J},J.milestoneEventHandler=function(t,e){return S.milestone[t]=e,J},J.datelineEventHandler=function(t,e){return S.dateline[t]=e,J},J},X={draw:function(t,e,i){var a=this,s={nodeRadius:5,factorLegend:.85,radians:2*Math.PI,opacityArea:.1,padding:{left:20,right:20,top:20,bottom:20},maxValue:0,grid:!0};if(void 0!==i)for(var o in i)void 0!==i[o]&&(s[o]=i[o]);var l={},c={},u=[];e.forEach((function(t){c[t.aggregation]=Math.max(Math.max(t.value,c[t.aggregation]?c[t.aggregation]:0),s.maxValue),l[t.label]||(l[t.label]=[]),l[t.label].push({axis:t.aggregation,value:t.value}),-1===u.indexOf(t.aggregation)&&u.push(t.aggregation)}));var h=u.length;s.chartDimension={w:s.w-s.padding.left-s.padding.right,h:s.h-s.padding.top-s.padding.bottom},s.radius=Math.min(s.chartDimension.w/2,s.chartDimension.h/2),s.center={x:s.chartDimension.w/2+s.padding.left,y:s.radius+s.padding.top},s.angle=s.radians/h;var d=t.append("svg").attr("width",s.w).attr("height",s.center.y+s.radius+s.padding.bottom).append("g");if(s.maxValue>0&&s.grid){var p=[];if(s.scaleStep)for(var g=0;g<=s.maxValue;g=TableUtils.addFloats(g,s.scaleStep))p.push(g);else{var f=n.scaleLinear();f.domain([0,s.maxValue]),p=f.ticks(3)}p.forEach((function(t){if(t>0){var e=s.radius*t/s.maxValue;d.selectAll(".levels").data(u).enter().append("svg:line").attr("x1",(function(t,i){return s.center.x-e*Math.sin(i*s.angle)})).attr("y1",(function(t,i){return s.center.y-e*Math.cos(i*s.angle)})).attr("x2",(function(t,i){return s.center.x-e*Math.sin((i+1)*s.angle)})).attr("y2",(function(t,i){return s.center.y-e*Math.cos((i+1)*s.angle)})).attr("class","line").style("stroke","#d3d3d3").style("stroke-width","1px"),d.append("text").attr("class","axis-text").text(s.formatter(t,u[0])).style("font-size","14px").attr("y",s.center.y-e+19).attr("x",s.center.x+5)}}))}var m=d.selectAll(".axis").data(u).enter().append("g").attr("class","axis");m.append("line").attr("x1",s.center.x).attr("y1",s.center.y).attr("x2",(function(t,e){return s.center.x-s.radius*Math.sin(e*s.angle)})).attr("y2",(function(t,e){return s.center.y-s.radius*Math.cos(e*s.angle)})).attr("class","line").style("stroke","grey").style("stroke-width","1px"),m.append("text").attr("class","axis-text").text((function(t){return t})).style("font-size","14px").attr("text-anchor","middle").attr("transform",(function(t,e){var i=a.calcTextAngle(s,e);return"rotate("+i/Math.PI*180+" "+a.calcAxisTextX(s,e,i)+","+a.calcAxisTextY(s,e,i)+")"})).attr("x",(function(t,e){return a.calcAxisTextX(s,e,a.calcTextAngle(s,e))})).attr("y",(function(t,e){return a.calcAxisTextY(s,e,a.calcTextAngle(s,e))})),Object.keys(l).forEach((function(t,e){var i=l[t],r=[];d.selectAll(".nodes").data(i,(function(t,e){r.push([a.calcCY(s,t,c,e),a.calcCX(s,t,c,e)])})),r.push(r[0]),d.selectAll(".area").data([r]).enter().append("polygon").attr("class","radar-chart-serie"+e).attr("key",t).style("stroke-width","2px").style("stroke",s.color(t)).attr("points",(function(t){for(var e="",i=0;i<t.length;i++)e=e+t[i][0]+","+t[i][1]+" ";return e})).style("fill",(function(){return s.color(t)})).style("fill-opacity",s.opacityArea).on("mouseover",(function(){var t="polygon."+n.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",0),d.selectAll(t).transition(200).style("fill-opacity",.5)})).on("mouseout",(function(){d.selectAll("polygon").transition(200).style("fill-opacity",s.opacityArea)}))}));var y=Object(r.a)().attr("class","d3-tip chart"+s.id).offset([-8,0]).html((function(t){return t.key+" ("+s.formatter(t.data.value,t.data.axis)+")"}));return d.call(y),Object.keys(l).forEach((function(t,e){var i=l[t];d.selectAll(".nodes").data(i).enter().append("svg:circle").attr("class","radar-chart-serie"+e).attr("key",t).attr("r",s.nodeRadius).attr("cx",(function(t,e){return a.calcCY(s,t,c,e)})).attr("cy",(function(t,e){return a.calcCX(s,t,c,e)})).attr("data-id",(function(t){return t.axis})).style("fill",s.color(t)).style("fill-opacity",.9).on("mouseover",(function(e){y.show({key:t,data:e},this);var i="polygon."+n.select(this).attr("class");d.selectAll("polygon").transition(200).style("fill-opacity",.1),d.selectAll(i).transition(200).style("fill-opacity",.7)})).on("mouseout",(function(){y.hide(),d.selectAll("polygon").transition(200).style("fill-opacity",s.opacityArea)}))})),{svg:d,cfg:s}},calcCY:function(t,e,i,a){return t.center.x-t.radius*Math.sin(a*t.angle)*Math.max(e.value,0)/i[e.axis]},calcCX:function(t,e,i,a){return t.center.y-t.radius*Math.cos(a*t.angle)*Math.max(e.value,0)/i[e.axis]},calcAxisTextX:function(t,e,i){var a=e*t.angle;return t.center.x-t.radius*Math.sin(a)-(t.nodeRadius+4+9.5*Math.min(1,a+i))*Math.sin(a)},calcAxisTextY:function(t,e,i){var a=e*t.angle;return t.center.y-t.radius*Math.cos(a)-(t.nodeRadius+4+9.5*Math.min(1,a+i))*Math.cos(a)},calcTextAngle:function(t,e){var i=-e*t.angle;return i<-Math.PI/2&&i>1.5*-Math.PI&&(i+=Math.PI),i}},K=i(22),Y=i(0),U={saveChanges:function(t,e,i,a,n,r,s,o,l,c,u,h,d,p,g,f,m){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart",dataType:"json",data:{pageId:t,id:e,column:i,aggregation:a,type:$.trim(n),height:r,width:s,hide:o,version:p,colors:l,pieKeys:c,interpolation:g,is3D:u,lineSettings:f,innerLabels:m},success:h,error:function(t){TFUtils.showError(t,d)}})},saveDateFormat:function(t,e,i){$.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/save-chart/dateformat",dataType:"json",data:{pageId:t,id:e,dateformat:i}})}},J=i(2),q={SOLID:"solid",DASH:"dash",DOT:"circle"},Z=function(t){this.palette=Y.a.chartColors,this.colors=t.colors?t.colors.split(","):[],this.pieKeys=t.pieKeys?t.pieKeys.split("‚"):[],this.visiblePieKeysLength=this.pieKeys.length,this.colorKeyMap=this.setColorKeyMap({},this.pieKeys,this.colors),this.macroId=t.macroId,this.pageId=t.pageId,this.dateFormat=t.dateFormat||"yy-mm-dd",this.dateFormat=this.dateFormat.replace("yyyy","yy"),this.hasTimeFormat=this.dateFormat.indexOf("hh:mm")>=0,this.localeDateFormat=Y.a.getLocaleDateFormat(this.dateFormat),this.separator=t.separator,this.worklog=Y.a.getWorklog(t.worklog),this.columns=t.columns?t.columns.split("‚"):[],this.aggregation=t.aggregation?t.aggregation.split("‚"):[],this.aggregationCache=this.aggregation.slice(),this.columnsCache=this.columns.slice(),this.transpose="Horizontal"===t.dataorientation,this.grid=t.grid,this.legend=t.legend&&"none"!=t.legend,this.isLegendUnderGraph="under"==t.legend,this.xValueType=null,this.valueType=Y.a.getValueType(t.minvalue,this.separator,this.worklog)||Y.a.getValueType(t.maxvalue,this.separator,this.worklog)||Y.a.getValueType(t.scalestep,this.separator,this.worklog)||null,this.minvalue=Y.a.parseValueByType(this.valueType,t.minvalue,this.separator,this.worklog),this.minvalue=!1===this.minvalue?NaN:this.minvalue,this.maxvalue=Y.a.parseValueByType(this.valueType,t.maxvalue,this.separator,this.worklog),this.maxvalue=!1===this.maxvalue?NaN:this.maxvalue,this.xminvalue=t.xminvalue,this.xmaxvalue=t.xmaxvalue,this.yminvalue=t.minvalue,this.ymaxvalue=t.maxvalue,this.scaleStep=Y.a.parseValueByType(this.valueType,t.scalestep,this.separator,this.worklog),this.scaleStep=!1===this.scaleStep?NaN:this.scaleStep,this.xScaleStep=t.xscalestep,this.yScaleStep=t.scalestep,this.locale=Y.a.getLocale(),this.title=t.title,this.xtitle=t.xtitle,this.ytitle=t.ytitle,this.isLog=t.isLog,this.isXLog=t.isXLog,this.titleHeight=t.title?20:0,this.xtitleHeight=t.xtitle?20:0,this.ytitleHeight=t.ytitle?20:0,this.showTrendLine="string"==typeof t.showTrendLine?"true"==t.showTrendLine:1==t.showTrendLine,this.tabs=t.tabs,this.hide=1==t.hide,this.textWidth=0,this.argumentWidth=0,this.lineSettings=t.lineSettings?t.lineSettings.split(","):{},this.version=3,this.interpolation=t.interpolation?t.interpolation.split(","):["Linear"],this.defaultInterpolation=t.version>=3?"Linear":this.interpolation[0],this.barColoringType=t.barColoringType,t.version>=3?(this.showInnerLabels="None"!==t.showInnerLabels,this.innerLabelsType={percentage:"Percentage"===t.showInnerLabels,value_percentage:"Value (Percentage)"===t.showInnerLabels,percentage_value:"Percentage (Value)"===t.showInnerLabels,value:"Value"===t.showInnerLabels||!t.showInnerLabels}):(this.showInnerLabels="string"==typeof t.showInnerLabels?"false"!=t.showInnerLabels:0!=t.showInnerLabels,this.innerLabelsType={}),bt(this.colors,this.palette),this.colorsCache=this.colors.slice(),this.trimParams(this.columns),this.trimParams(this.aggregation),"editor"!==this.macroId&&(this.initElements(t),this.initFormaters(),this.content.data("rendered")||(this.content.data("rendered",!0),this.isPivot&&(this.separator=this.pivotContent.data("decimalseparator")),this.getOriginalTable(),this.getDimension(),this.getType(),this.bindUpdate(),this.setChosen(),this.bindUI(),this.setControls(),this.draw(),this.bindTips(),this.bindPageResize()))};function Q(t,e,i){return t[e]||(t[e]=[0]),t[e].push(i),t}function tt(t){return"Line"===t||"Time Line"===t}function et(t){var e=t.prop("outerHTML");return!e&&window.XMLSerializer&&t.length&&(e=(e=(e=(new XMLSerializer).serializeToString(t[0])).replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")).substring(0,4)+' xmlns="http://www.w3.org/2000/svg"'+e.substring(4,e.length)),e}function it(t){var e=0;t.forEach((function(t){e+=t.value}));var i=0,a={},n=0,r=[],s=$.grep(t,(function(t){var s,o,l=Math.round(1e3*t.value/e)/10;if(t.percent=l,l>1)return!0;i+=t.value,n++,r.push({label:t.label,value:t.value,percent:l}),s=a,o=t.rowNumber,$.each(o,(function(t,e){s[t]||(s[t]=[]),s[t]=s[t].concat(e)})),a=s}));return i&&n>1&&s.push({label:"Other",value:i,percent:Math.round(1e3*i/e)/10,other:!0,rowNumber:a}),{data:s,smallData:r,count:n}}function at(t,e,i){var a=t;return a=Math.max(e,a),a=Math.min(i,a)}function nt(t,e,i){var a=0,n=0;return e.length===i.length?e.length&&(i[0].absTotal?n=i[0].absTotal:(n=0,i.forEach((function(t){n+=t.total})),i[0].absTotal=n)):i.some((function(e){if(e.label===t.label)return n=e.total,!0})),n&&(a=100*t.value/n),a.toFixed(1)+"%"}function rt(t){var e=ot(t);return(299*e.r+587*e.g+114*e.b)/1e3>=128?"black":"white"}function st(t,e){var i=ot(t);return i.r=Math.min(parseInt(i.r/e),255),i.g=Math.min(parseInt(i.g/e),255),i.b=Math.min(parseInt(i.b/e),255),"#"+i.r.toString(16)+i.g.toString(16)+i.b.toString(16)}function ot(t){return{r:parseInt(t.substr(1,2),16),g:parseInt(t.substr(3,2),16),b:parseInt(t.substr(5,2),16)}}function lt(t,e){for(var i=[],a=Math.ceil(t[0]/e)*e;a<=t[1];a=Y.a.addFloats(a,e))i.push(a);return i}function ct(t,e,i,a,n,r){var s=parseFloat(t);if(0==s)return"";var o=8*r(s).length+4,l=n?pt(e):gt(e);if(o>=l&&(a||o>=i-l)){if(s>0&&s<1e-4||s>99999.999)return s.toExponential(1);var c=5-Math.floor(s).toString().length;return r(parseFloat(s.toFixed(c>0?c:0)))}return r(s)}function ut(t,e,i){var a=$("<span></span>");$("body").append(a);for(var n,r=0,s=0,o=0,l=[],c=i||30,u=0;u<t.length;u++){t[u].length>33&&(t[u]=t[u].substr(0,33)+"...");var h=a.text(t[u]).width();r+=parseInt(h)+c,o=Math.max(o,parseInt(h))}var d=n=r<=e?e/2-r/2:20;for(u=0;u<t.length;u++)n+parseInt(a.text(t[u-1]).width())+c<e?n+=parseInt(a.text(t[u-1]).width())+c:(l.push(u),s+=1);return a.remove(),{rows:s,maxWidth:o,firstInRow:l,posX:d}}function ht(t){var e=t.offset().left,i=pt(t);return{left:e,right:e+i,width:i}}function dt(t){var e=t.offset().top,i=gt(t);return{top:e,bottom:e+i,height:i}}function pt(t){var e=t[0].getClientRects();return e.length?e[0].width:0}function gt(t){var e=t[0].getClientRects();return e.length?e[0].height:0}function ft(t,e){var i=ht(t);0!==i.width&&e.each((function(){for(var t=$(this),e=ht(t),a=13,n=parseFloat(t.attr("x"))||0;(e.left<i.left||e.right>i.right)&&a>0;){t.css("font-size",a--);var r=e.width;(e=ht(t)).left<i.left&&e.right<=i.right?(n=n+r-pt(t),t.attr("x",n)):e.right>i.right&&e.left>=i.left&&(n=n-r+pt(t),t.attr("x",n))}}))}function mt(t,e){var i=0,a=$("<span/>");return $("body").append(a),t.ticks().forEach((function(n){a[0].textContent=(e.tickFormat()||t.tickFormat())(n),i=Math.max(a.width(),i)})),a.remove(),i}function yt(t){return"M"+(t=t.map((function(t){return t.join(",")}))).join("L")+"Z"}function xt(){return $("body").css("font-family")}function vt(t,e,i,a){var n;e.selectAll(i).on("mouseover",(function(e){clearTimeout(n);var a=$(this);a.is(i)||(a=a.parent()),t.show(e,a[0])})).on("mouseout",(function(){n=setTimeout((function(){n=null,a.tipHover||t.hide()}),50)}))}function bt(t,e){e.forEach((function(e){-1===$.inArray(e,t)&&t.push(e)}))}function _t(t,e,i){var a=e.map((function(e,i){return t[e]})),n=a.filter((function(t){return t})),r=n.length;bt(n,i);var s=0;return bt(a=a.slice(0,e.length).map((function(i,a){return i||(i=n[(r+s++)%n.length],t[e[a]]=i),i})),i),a}function wt(t,e){return t.isGantt?t.ganttCatColors:t.multiple?t.chartKeys:t.pieKeys.slice(0,e)}Z.prototype.initElements=function(t){var e=this;e.content=$('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+t.sessionId+'"]'),e.chartBody=e.content.find(".chart-body"),e.chartBody=Y.a.addExcerpt(e.chartBody,"chart-body"),e.chartBody=Y.a.addIframe(e.chartBody,"chart-body",(function(t){e.chartBody=t,e.getOriginalTable(),e.setControls(),e.draw()})),e.wrapper=e.content.find(".chart-wrapper"),e.svgWrapper=e.wrapper.find(".svg-wrapper"),e.chart=n.selectAll('[id="chart'+e.macroId+'"][data-pageid="'+e.pageId+'"][data-sessionid="'+t.sessionId+'"] .svg-wrapper'),e.canvas=e.content.find("canvas"),e.png=e.content.find("#pngdataurl"),e.columnSelect=e.content.find(".chart-column"),e.aggregationSelect=e.content.find(".chart-aggregation"),e.typeSelect=e.content.find(".chart-type"),e.is3DInput=e.content.find(".is3d"),e.is3D=e.is3DInput.is(":checked"),e.heightInput=e.content.find(".chart-height"),e.widthInput=e.content.find(".chart-width"),e.is3DWrapper=e.content.find(".is3d-wrapper"),e.noTableMessage=e.wrapper.find(".no-table-message"),e.badSettings=e.wrapper.find(".bad-settings-message"),e.wrongDateFormat=e.wrapper.find(".wrong-date-message"),e.noDataMessage=e.wrapper.find(".no-data-message"),e.logZeroMessage=e.wrapper.find(".log-zero-message"),e.loader=e.wrapper.find("#chart-loading"),e.controls=e.wrapper.find(".chart-controls"),e.settings=e.controls.find(".chart-settings"),e.menu=e.content.find("#chart-menu-view-"+e.macroId+"-"+e.pageId),e.showRawDataItem=e.menu.find(".chart-showrawdata"),e.hideRawDataItem=e.menu.find(".chart-hiderawdata"),e.selectColors=e.menu.find(".chart-change-color"),e.btn=e.menu.find(".chart-save").not("body.content-preview .chart-save"),e.download=e.menu.find(".save-as-png"),e.dateFormatInput=e.wrongDateFormat.find(".chart-date-format"),e.setInterpolationBtn=e.menu.find(".chart-set-interpolation"),e.changeLineSettingsBtn=e.menu.find(".chart-set-line-settings"),e.checkPivotContent()},Z.prototype.checkPivotContent=function(){this.pivotContent=this.chartBody.find(".pivot-content"),this.isPivot=this.pivotContent.length>0},Z.prototype.initFormaters=function(){var t=this;t.formatNum=L()({mark:t.separator,thousand:" "}),t.formatNumShort=L()({mark:t.separator,thousand:""}),t.formatNumTo=function(e,i){var a=Y.a.formatValueByType(e,i&&t.valueType instanceof Object?t.valueType[i]:t.valueType,(function(e){return e>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog),n=i&&t.valueFormatter instanceof Object?t.valueFormatter[i]:t.valueFormatter;return n?n(a):a},t.formatNumToX=function(e){var i=Y.a.formatValueByType(e,t.xValueType,(function(e){return e>=1e4?t.formatNum.to(e):t.formatNumShort.to(e)}),t.worklog);return t.xValueFormatter?t.xValueFormatter(i):i}},Z.prototype.trimParams=function(t){for(var e=0;e<t.length;e++)t[e]=t[e].replace("‌",""),t.indexOf(t[e])!==e&&t.splice(e--,1)},Z.prototype.getSaveParams=function(t){for(var e=[],i=0;i<t.length;i++)""==t[i]?e.push("‌"):e.push(t[i]);return e.length?e.join("‚"):void 0},Z.prototype.getDimension=function(){if(this.height=this.heightInput.val(),this.width=this.widthInput.val(),this.adaptiveDimensions=!1,Y.a.isNumber(this.width))this.width=parseInt(this.width);else{for(var t=this.content;!t.is(":visible")&&t.length;)t=t.parent();this.width=t.width()-20;var e=$("body.content-preview").length>0;e||"none"===this.controls.css("display")||(this.width-=190),e&&(this.width=this.width>300?this.width:$(window.parent).width()-250),this.adaptiveDimensions=!0}Y.a.isNumber(this.height)?this.height=parseInt(this.height):(this.height=Math.min(.7*window.innerHeight,600),this.height=this.height<300?300:this.height,this.adaptiveDimensions=!0)},Z.prototype.bindPageResize=function(){var t=this;if(t.widthInput.val().trim())t.resizeSensor&&t.resizeSensor.detach();else{var e=$(".wiki-content, .ac-content"),i=e.width();t.resizeSensor=new F.ResizeSensor(e[0],(function(){var a=e.width();Math.abs(a-i)>17&&(i=a,t.getDimension(),t.draw(!0))}))}},Z.prototype.getType=function(){this.type=this.typeSelect.val(),this.isTime=-1!=this.type.indexOf("Time"),this.isSeries="Line"==this.type||"Area"==this.type||"Stacked Area"==this.type,this.isArea=-1!=this.type.indexOf("Area"),this.isBar=this.type.indexOf("Bar")>=0||this.type.indexOf("Column")>=0,this.isGantt=this.type.indexOf("Gantt")>=0,this.isBubblePie="Bubble Pie"===this.type,this.isRadar="Radar"===this.type,this.multiple=this.isBar||this.isSeries||this.isTime||this.isGantt,this.isTime?(this.content.find("label.simple-text, label.series-text, label.bubble-text").hide(),this.content.find("label.time-text").show()):this.isSeries?(this.content.find("label.simple-text, label.time-text, label.bubble-text").hide(),this.content.find("label.series-text").show()):this.isBubblePie?(this.content.find("label.simple-text, label.time-text, label.series-text").hide(),this.content.find("label.bubble-text").show()):(this.content.find("label.time-text, label.series-text, label.bubble-text").hide(),this.content.find("label.simple-text").show()),this.isTime||this.isSeries||this.isGantt||this.isBubblePie||this.isRadar?(this.is3DWrapper.hide(),this.typeSelect.removeClass("short")):(this.is3DWrapper.show(),this.typeSelect.addClass("short"))},Z.prototype.getOriginalTable=function(){var t=this,e=t.tabs&&Y.a.hasTabs(t.chartBody);t.originalTable=Y.a.getTableNodes(t.chartBody).filter((function(){var t=$(this);return!(e&&Y.a.hasInactiveTab(t))})),t.isPivot||(Y.a.normalizeTable(t.originalTable),Y.a.processMergedCells(t.originalTable)),t.originalTable.unbind("sortEnd.tfchart").bind("sortEnd.tfchart",(function(){t.sorting=!1,t.setMutationObserver(),t.getTable(),t.draw(!0)})).unbind("sortStart.tfchart").bind("sortStart.tfchart",(function(){t.sorting=!0,t.setMutationObserver()})),t.resetDateFormats(),Y.a.setPaginationMsg(t.chartBody),t.getTable()},Z.prototype.resetDateFormats=function(){var t=this;t.dateFormats=[],t.originalTable.each((function(){t.dateFormats.push([])}))},Z.prototype.updateSettingsForPivot=function(){this.isPivot&&(this.columnSelect.parent().hide(),this.aggregationSelect.parent().hide(),this.columnHidden=!0,this.aggregationHidden=!0,(Y.a.getRawColumns(this.tables).length>2||this.isGantt)&&(this.aggregationSelect.parent().show(),this.aggregationHidden=!1,this.columnSelect.parent().show(),this.columnHidden=!1))},Z.prototype.bindUpdate=function(){var t=this,e=function(e){e&&(t.getOriginalTable(),t.setControls()),t.draw()},i=[];t.chartBody.find(".pivot-content, .tablefilter-table-wrapper, .table-joiner").each((function(){i.push($(this).attr("id"))}));var a=t.chartBody.filter(".table-excerpt").length;i.length||a?t.chartBody.bind("tf-filtered pt-calculated tj-executed",(function(n,r){if(-1!==i.indexOf(r.id)||a)return e("tf-filtered"!==n.type||t.isPivot),a})):t.chartBody.bind("tf-filtered-charts",(function(){e(!1)}));var n=null;t.chartBody.bind("tf-jira-updated DOMCharacterDataModified changed.chk",(function(){clearTimeout(n),n=setTimeout((function(){e(!0)}),100)}));var r=function(i,a){if(!i.parents(".pivot-table").length)return!Y.a.isIgnoreUpdateNode(i)&&(a.className===t.chartBody[0].className||Y.a.hasRowForUpdate(i)||Y.a.hasTableForUpdate(i)||Y.a.hasCharsForUpdate(i,a))?(clearTimeout(n),n=setTimeout((function(){n=null,e(!0)}),100),!0):void 0};window.MutationObserver?(t.observer=new MutationObserver((function(t){t.some((function(t){if(t.addedNodes.length)return r($(t.addedNodes),t.target)}))})),t.setMutationObserver()):t.chartBody.bind("DOMNodeInserted",(function(t){r($(t.target),t.originalEvent.relatedNode)})),t.tabs&&Y.a.onTabChange(t.chartBody,(function(){e(!0)})),t.chartBody.bind("tf-save",(function(){return t.content.trigger("tf-save"),!1})).bind("tf-export-ready",(function(e,i){return t.macroId===i.macroId}))},Z.prototype.setMutationObserver=function(){var t=this;if(t.observer)if(t.sorting)t.observer.disconnect();else{var e={childList:!0,subtree:!0};t.chartBody.each((function(){t.observer.observe(this,e)}))}},Z.prototype.setChosen=function(){this.setChosenSelect(this.columnSelect,this.columns,this.columnsCache,!0),this.setChosenSelect(this.aggregationSelect,this.aggregation,this.aggregationCache,!1)},Z.prototype.setChosenSelect=function(t,e,i,a){var n=this;t.chosenTF({max_selected_options:a&&n.isBubblePie?2:void 0,no_results_text:"No matches for",placeholder_text_multiple:"Click and start typing...",display_selected_options:!1,width:"178px"}).change((function(r,s){null!=s.selected?(t.find("option").filter((function(){return this.textContent==s.selected})).prop("selected","selected"),e.push(s.selected)):null!=s.deselected&&(t.find("option").filter((function(){return this.textContent==s.deselected})).prop("selected",!1),e.splice($.inArray(s.deselected,e),1)),a&&!n.isGantt&&(n.pieKeys=[],n.visiblePieKeysLength=0),i.length=0,$.merge(i,e),n.aggregationChange=!1,n.columnsChange=!1,n.enableSaveBtn(),n.draw()}));var r=t.parent().find(".chosen-choices");r.sortable({tolerance:"pointer",cursor:"move",helper:"clone",items:".search-choice",stop:function(){var t=e.slice();if(e.length=0,r.find(".search-choice").each((function(){e.push(this.textContent)})),i.length=0,$.merge(i,e),!n.isGantt&&n.multiple){var a=n.colors.slice();t.forEach((function(t,i){var r=$.inArray(t,e);r>=0&&a.length>r&&(n.colors[r]=a[i])})),n.colorsCache=n.colors.slice()}n.btn.prop("disabled",!1),n.enableSaveBtn(),n.draw()}})},Z.prototype.bindUI=function(){var t=this;t.typeSelect.change((function(){t.getType(),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn(),t.enableSaveBtn(),t.draw()}));var e=null;t.heightInput.add(t.widthInput).bind("input",(function(){clearTimeout(e),e=setTimeout((function(){t.getDimension(),t.enableSaveBtn(),t.draw(),t.bindPageResize()}),330)})),t.is3DInput.change((function(){t.is3D=t.is3DInput.is(":checked"),t.enableSaveBtn(),t.draw()})),t.btn.click((function(e){t.btn.toggleClass("tf-disabled-link"),t.controls.add(t.btn).find(".tfac-unsaved").hide();var i,a,n=t.getChartColorLabels();t.type&&(t.type.indexOf("Line")>=0||t.type.indexOf("Area")>=0)&&(i=t.calcInterpolation(),t.type.indexOf("Line")>=0&&(a=t.calcLineSettings())),U.saveChanges(t.pageId,t.macroId,t.getSaveParams(t.columns),t.getSaveParams(t.aggregation),t.type,t.heightInput.val(),t.widthInput.val(),t.hide,t.colors.slice(0,n.length).join(","),t.pieKeys.slice(0,t.visiblePieKeysLength).join("‚"),t.is3D,void 0,t.content,t.version,i,a,t.getInnerLabelsParam()),t.content.trigger("tf-save",t.getExportEventData()),e.preventDefault()})),t.showRawDataItem.click((function(e){t.hide=!1,t.hideRawDataItem.parent().show(),t.showRawDataItem.parent().hide(),t.chartBody.removeClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()})),t.hideRawDataItem.click((function(e){t.hide=!0,t.showRawDataItem.parent().show(),t.hideRawDataItem.parent().hide(),t.chartBody.addClass("chart-hidden"),t.enableSaveBtn(),e.preventDefault()}));var i=t.menu.find(".export-file-pdf"),a=t.menu.find(".export-file-doc");void 0===P.saveAs?(i.hide(),a.hide()):(i.click((function(e){J.a.loadScriptsBeforeExport((function(){Y.a.exportToPdf(t.chartBody.not(".table-excerpt"),!0)})),e.preventDefault()})),a.click((function(e){Y.a.exportToDoc(t.chartBody.not(".table-excerpt"),!0),e.preventDefault()})));var n=K.a.initChartColorsDialog(t),r=K.a.initInterpolationDialog(t),s=K.a.initLineSettingsDialog(t),o=!1;t.menu.find(".chart-change-color").click((function(e){o=!0,n.show(),t.controls.addClass("active"),e.preventDefault()})),t.setInterpolationBtn.click((function(e){o=!0,r.show(),t.controls.addClass("active"),e.preventDefault()})),t.changeLineSettingsBtn.click((function(e){o=!0,s.show(),t.controls.addClass("active"),e.preventDefault()})),t.controls.find(".aui-dropdown2").bind("aui-dropdown2-show",(function(){t.controls.addClass("active")})).bind("aui-dropdown2-hide",(function(){o?o=!1:t.controls.removeClass("active")}));var l=null;t.dateFormatInput.bind("change selected keyup",(function(e){var i=function(){t.dateFormat=t.dateFormatInput.val().trim(),t.resetDateFormats(),t.draw()&&U.saveDateFormat(t.pageId,t.macroId,t.dateFormat)};"keyup"===e.type?13===e.which&&i():(clearTimeout(l),l=setTimeout((function(){i()}),300))})),window.MSInputMethodContext&&document.documentMode&&t.download.click((function(){window.navigator.msSaveBlob(t.canvas[0].msToBlob(),"Chart.jpg")})),t.shiftInterpolationBtn(),t.shiftChangeLineSettingsBtn()},Z.prototype.calcInterpolation=function(){var t=this,e=[];return t.interpolation instanceof Array?t.chartKeys.forEach((function(i,a){e.push(a<t.interpolation.length?t.interpolation[a]:t.defaultInterpolation)})):t.chartKeys.forEach((function(i,a){e.push(t.interpolation[i]?t.interpolation[i]:t.defaultInterpolation)})),e.join(",")},Z.prototype.calcLineSettings=function(){var t=this,e=[];return t.lineSettings instanceof Array?t.chartKeys.forEach((function(i,a){e.push(a<t.lineSettings.length?t.lineSettings[a]:"solid-1.5")})):t.chartKeys.forEach((function(i,a){e.push(t.lineSettings[i]?t.lineSettings[i].type+"-"+t.lineSettings[i].width:"solid-1.5")})),e.join(",")},Z.prototype.getChartColorLabels=function(){return wt(this,this.visiblePieKeysLength)},Z.prototype.getAllChartColorLabels=function(){return wt(this,this.pieKeys.length)},Z.prototype.getTable=function(){var t=Y.a.getTablesAndRowsFromTables(this.originalTable,Y.a.mixedType,null,this.transpose);this.rows=t.rows,this.tables=t.tables},Z.prototype.setControls=function(){var t=this;t.updateSettingsForPivot();var e=Y.a.getRawColumns(t.tables),i=e.slice().sort();if(t.columnSelect.empty(),t.aggregationSelect.empty(),i.length){t.tableColumnsCache&&($(t.tableColumnsCache).not(i).length>0||$(i).not(t.tableColumnsCache).length>0)&&(t.aggregationChange&&(t.aggregation.length=0,$.merge(t.aggregation,t.aggregationCache),t.multiple&&!t.isGantt&&(t.colors=t.colorsCache.slice())),t.columnsChange&&(t.columns.length=0,$.merge(t.columns,t.columnsCache))),t.tableColumnsCache=i.slice();var a=document.createDocumentFragment(),n=document.createDocumentFragment();$.each(i,(function(i,r){var s=$.inArray(r,t.columns)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.columns)>=0||$.inArray(r.replace(" "+"Total",""),t.columns)>=0)||!t.isPivot&&0==t.columns.length&&0==$.inArray(r,e)?'selected="selected"':"";a.appendChild($("<option "+s+"></option>").text(r)[0]),s=$.inArray(r,t.aggregation)>=0||t.isPivot&&($.inArray(r+" "+"Total",t.aggregation)>=0||$.inArray(r.replace(" "+"Total",""),t.aggregation)>=0)||!t.isPivot&&0==t.aggregation.length&&1==$.inArray(r,e)?'selected="selected"':"",n.appendChild($("<option "+s+"></option>").text(r)[0])})),t.columnSelect.append(a),t.aggregationSelect.append(n),$.each(t.columns.slice(),(function(e,a){-1!=$.inArray(a,i)||t.isPivot&&(-1!=$.inArray(a+" "+"Total",i)||-1!=$.inArray(a.replace(" "+"Total",""),i))||(t.columns.splice($.inArray(a,t.columns),1),t.columnsChange=!0)})),$.each(t.aggregation.slice(),(function(e,a){if(-1==$.inArray(a,i)&&(!t.isPivot||-1==$.inArray(a+" "+"Total",i)&&-1==$.inArray(a.replace(" "+"Total",""),i))){var n=$.inArray(a,t.aggregation);t.aggregation.splice(n,1),t.aggregationChange=!0,t.multiple&&!t.isGantt&&t.colors.splice(t.aggregationCache.length-1,0,t.colors.splice(n,1)[0])}})),t.isPivot?(0==t.columns.length&&void 0!==e[0]&&(t.columns.push(e[0]),t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&void 0!==e[e.length-1]&&(t.aggregation.push(e[e.length-1]),t.aggregationSelect.find("option").filter((function(){return this.textContent===e[e.length-1]})).prop("selected",!0))):(0==t.columns.length&&(t.columns.push(e[0]),t.transpose&&e[0]&&t.columnSelect.find("option").filter((function(){return this.textContent===e[0]})).prop("selected",!0)),0==t.aggregation.length&&(t.aggregation.push(e[1]),t.transpose&&e[1]&&t.aggregationSelect.find("option").filter((function(){return this.textContent===e[1]})).prop("selected",!0)))}t.columnSelect.trigger("chosen:updated"),t.aggregationSelect.trigger("chosen:updated"),Y.a.sortSelectedOptions(t.columnSelect,t.columns),Y.a.sortSelectedOptions(t.aggregationSelect,t.aggregation)},Z.prototype.getDateFormat=function(t,e){return Y.a.setDateFormatForColumn(this.dateFormats[t],this.dateFormat,this.localeDateFormat,e,this.rows[t],this.hasTimeFormat),this.workingDateFormat=this.dateFormats[t][e],this.dateFormats[t][e]},Z.prototype.calculateBubblePieData=function(t){var e=this,i=[];if(2!==e.columns.length||0===e.aggregation.length)return i;e.bubblePieSetting={},e.bubblePieSetting.axisX={title:e.columns[0],order:[]},e.bubblePieSetting.axisY={title:e.columns[1],order:[]},e.bubblePieSetting.indicator={valueType:null},e.bubblePieSetting.sameValuesCount={},e.bubblePieSetting.filterAggregation=[];var a=[],n=[];e.tables.forEach((function(r,s){r.forEach((function(r,o){if(0===o)a=r.slice(0);else if(t[s][o]){for(var l,c,u,h,d={},p=[],g=0,f=r.length;g<f;g++){var m=e.getDateFormat(s,g);if(a[g]===e.bubblePieSetting.axisX.title&&r[g])null===e.xValueType&&(e.xValueType=Y.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,e.locale)),null!==e.xValueType?(l=Y.a.parseAnyValueByType(e.xValueType,r[g],e.separator,e.worklog,!0,m,e.locale),Y.a.isNumber(l)&&e.xValueType===Y.a.number&&!e.xValueFormatter&&(e.xValueFormatter=Y.a.getNumberFormatter(r[g])),(void 0===e.bubblePieSetting.axisX.maxValue||e.bubblePieSetting.axisX.maxValue<l)&&(e.bubblePieSetting.axisX.maxValue=l),(void 0===e.bubblePieSetting.axisX.minValue||e.bubblePieSetting.axisX.minValue>l)&&(e.bubblePieSetting.axisX.minValue=l)):l=r[g],e.bubblePieSetting.axisX.order.includes(l)||e.bubblePieSetting.axisX.order.push(l);else if(a[g]===e.bubblePieSetting.axisY.title&&r[g])null===e.valueType&&(e.valueType=Y.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,e.locale)),n.push(r[g]),null!==e.valueType?(c=Y.a.parseAnyValueByType(e.valueType,r[g],e.separator,e.worklog,!0,m,e.locale),Y.a.isNumber(c)&&e.valueType===Y.a.number&&!e.valueFormatter&&(e.valueFormatter=Y.a.getNumberFormatter(r[g])),(void 0===e.bubblePieSetting.axisY.maxValue||e.bubblePieSetting.axisY.maxValue<c)&&(e.bubblePieSetting.axisY.maxValue=c),(void 0===e.bubblePieSetting.axisY.minValue||e.bubblePieSetting.axisY.minValue>c)&&(e.bubblePieSetting.axisY.minValue=c)):c=r[g],e.bubblePieSetting.axisY.order.includes(c)||e.bubblePieSetting.axisY.order.push(c);else{if(!e.aggregation.includes(a[g])||!r[g])continue;null===e.bubblePieSetting.indicator.valueType&&(e.bubblePieSetting.indicator.valueType=Y.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,e.locale)),[Y.a.number,Y.a.worklog,Y.a.duration].includes(e.bubblePieSetting.indicator.valueType)&&(h=Y.a.getAnyValueType(r[g],e.separator,e.worklog,!0,m,e.locale))===e.bubblePieSetting.indicator.valueType&&(u=Y.a.parseAnyValueByType(h,r[g],e.separator,e.worklog,!0,m,e.locale),e.bubblePieSetting.filterAggregation.includes(a[g])||e.bubblePieSetting.filterAggregation.push(a[g]),p.push({indicator:a[g],value:u>0?u:null}))}}p.length>0&&l&&c&&p.forEach((function(t){d[e.bubblePieSetting.axisX.title]=l,d[e.bubblePieSetting.axisY.title]=c,d.indicator=t.indicator,d.value=t.value,d.tableI=s,d.rowI=o,i.push(JSON.parse(JSON.stringify(d))),e.valueType!==Y.a.number&&e.xValueType!==Y.a.number&&e.valueType!==Y.a.duration&&e.xValueType!==Y.a.duration||(l=JSON.parse(JSON.stringify(l)),c=JSON.parse(JSON.stringify(c)),e.bubblePieSetting.sameValuesCount[l+"_"+c]>0?e.bubblePieSetting.sameValuesCount[l+"_"+c]+=1:e.bubblePieSetting.sameValuesCount[l+"_"+c]=1)}))}}))})),e.bubblePieSetting.filterAggregation.sort((function(t,i){return e.aggregation.indexOf(t)-e.aggregation.indexOf(i)})),e.pieKeys=e.bubblePieSetting.filterAggregation.slice(0),e.visiblePieKeysLength=e.pieKeys.length,e.colors=_t(e.colorKeyMap,e.pieKeys,e.palette),e.colorsCache=e.colors.slice(),e.calcBubbleChartExtremum(),e.filterBubbleChartData(i);var r=$("<span/>");return $("body").append(r),e.bubblePieSetting.axisY.longestTitle=r.text(Y.a.getLongestWordInArr(n)).width()+9,r.remove(),i},Z.prototype.filterBubbleChartData=function(t){for(var e=this.bubblePieSetting.axisX.title,i=this.bubblePieSetting.axisY.title,a=this.bubblePieSetting.axisX.minValue,n=this.bubblePieSetting.axisX.maxValue,r=this.bubblePieSetting.axisY.minValue,s=this.bubblePieSetting.axisY.maxValue,o=t.length-1;o>=0;){var l=t[o][i],c=t[o][e],u=this.valueType===Y.a.date?Y.a.toDateObject(l):l,h=this.xValueType===Y.a.date?Y.a.toDateObject(c):c;n&&h>n||a&&h<a?t.splice(o,1):s&&u>s||r&&u<r?t.splice(o,1):(this.valueType!==Y.a.number&&this.valueType!==Y.a.duration||(t[o]["orig_"+i]=l,t[o][i]=parseFloat(l/this.bubblePieSetting.sameValuesCount[c+"_"+l])),this.xValueType!==Y.a.number&&this.xValueType!==Y.a.duration||(t[o]["orig_"+e]=c,t[o][e]=parseFloat(c/this.bubblePieSetting.sameValuesCount[c+"_"+l]))),o-=1}},Z.prototype.calculate=function(){var t=this,e=[],i={};t.ganttCategories=[],t.ganttCatColors=[],t.textWidth=0,t.argumentWidth=0,t.aggregationWidth=0,t.valueType=t.isRadar?{}:null,t.xValueType=null,t.valueFormatter=t.isRadar?{}:null,t.xValueFormatter=null,t.chartKeys=[];var a=$("<span></span>");a.appendTo("body"),t.columnWidth=0;var n=Y.a.getRelevantRows(t.rows,t.transpose);if(t.isBubblePie)return t.calculateBubblePieData(n);var r=t.columnHidden,s=t.aggregationHidden;(t.isSeries||t.isTime)&&(r=t.aggregationHidden,s=t.columnHidden);var o=t.isSeries||t.isTime?t.aggregation:t.columns,l=t.isSeries||t.isTime?t.columns:t.aggregation;if($.each(o,(function(e,n){a.text(n),i[n]=[],t.columnWidth=Math.max(t.columnWidth,a.width())})),$.each(l,(function(e,n){a.text(n),i[n]=[],t.aggregationWidth=Math.max(t.aggregationWidth,a.width())})),t.tables.forEach((function(c,u){var h=[],d=[];$.each(o,(function(e,i){var a=r?t.isSeries||t.isTime?1:0:Y.a.getCellPosition(c,i);h.push(a)})),$.each(l,(function(e,i){var a=s?t.isSeries||t.isTime?0:1:Y.a.getCellPosition(c,i);d.push(a)})),h.length&&d.length&&c.forEach((function(r,s){s>0&&n[u][s]&&h.some((function(n,c){if(null!==n){var p=o[c],g=r[n];if(t.isGantt){var f={id:e.length,category:g,label:h.length>1?p:"",hint:g,rowNumber:Q({},u,s)},m=0,y=!1,x=t.textWidth;-1===$.inArray(g,t.ganttCategories)&&(t.ganttCategories.push(g),y=!0,t.ganttCatColors.push(g),d.length>2&&(t.ganttCatColors.push(g+" - Done"),t.ganttCatColors.push(g+" - Todo")))}if(d.forEach((function(n,o){if(null!=n){var c=l[o],y=r[n];if(t.isGantt){if(2==m)y=Y.a.parseNumber(y,t.separator),Y.a.isNumber(y)&&(y=y>1?y/100:y,f.progress=y);else try{if(!y)return!0;f.text=y,y=Y.a.parseDate(y,t.getDateFormat(u,n),t.locale),0==m?f.startDate=y:f.endDate=y}catch(t){return AJS.log("Error while parsing date '"+y+"': "+t),!0}m++}else{var x;t.isTime||t.isSeries?(x=p,d.length>1&&(x=h.length>1?x+" - "+c:c)):(x=c,!t.isRadar&&h.length>1&&(x=d.length>1?x+" - "+p:p)),i[x]||(i[x]=[]);var v=t.isRadar?g:x;if(-1===t.chartKeys.indexOf(v)&&t.chartKeys.push(v),t.isTime)try{if(!y)return!0;g&&null==t.valueType&&(t.valueType=Y.a.getValueType(g,t.separator,t.worklog));var b=g;if(g=Y.a.parseValueByType(t.valueType,g,t.separator,t.worklog),y=Y.a.parseDate(y,t.getDateFormat(u,n),t.locale),!Y.a.isNumber(g))return!0;t.valueType!==Y.a.number||t.valueFormatter||(t.valueFormatter=Y.a.getNumberFormatter(b))}catch(t){return AJS.log("Error while parsing date '"+y+"': "+t),!0}else if(t.isSeries){g&&null==t.valueType&&(t.valueType=Y.a.getValueType(g,t.separator,t.worklog)),y&&null==t.xValueType&&(t.xValueType=Y.a.getValueType(y,t.separator,t.worklog));b=g;var _=y;if(g=Y.a.parseValueByType(t.valueType,g,t.separator,t.worklog),y=Y.a.parseValueByType(t.xValueType,y,t.separator,t.worklog),Y.a.isNumber(g)&&t.valueType===Y.a.number&&!t.valueFormatter&&(t.valueFormatter=Y.a.getNumberFormatter(b)),Y.a.isNumber(y)&&t.xValueType===Y.a.number&&!t.xValueFormatter&&(t.xValueFormatter=Y.a.getNumberFormatter(_)),!Y.a.isNumber(g)||!Y.a.isNumber(y))return!0}else if(t.isRadar){y&&null==t.valueType[x]&&(t.valueType[x]=Y.a.getValueType(y,t.separator,t.worklog));_=y;y=Y.a.parseValueByType(t.valueType[x],y,t.separator,t.worklog),Y.a.isNumber(y)?t.valueType[x]!==Y.a.number||t.valueFormatter[x]||(t.valueFormatter[x]=Y.a.getNumberFormatter(_)):y=0}else{y&&null==t.valueType&&(t.valueType=Y.a.getValueType(y,t.separator,t.worklog));_=y;if(y=Y.a.parseValueByType(t.valueType,y,t.separator,t.worklog),!Y.a.isNumber(y))return!0;t.valueType!==Y.a.number||t.valueFormatter||(t.valueFormatter=Y.a.getNumberFormatter(_))}t.isTime||t.isSeries?-1===i[x].indexOf(y.valueOf())?(e.push({label:g,value:y,key:x,aggregation:c,rowNumber:Q({},u,s)}),i[x].push(y.valueOf())):e.forEach((function(t){t.key===x&&t.value.valueOf()===y.valueOf()&&(t.label+=g,Q(t.rowNumber,u,s))})):-1===i[x].indexOf(g)?(e.push({label:g,value:y,key:p,aggregation:x,rowNumber:Q({},u,s)}),i[x].push(g)):e.forEach((function(t){t.aggregation===x&&t.label===g&&(t.value+=y,Q(t.rowNumber,u,s))}))}t.isTime||t.isSeries||(a.text(g),t.textWidth=Math.max(t.textWidth,a.width()))}})),t.isGantt){if(f.startDate){var v;for(e.push(f),f.endDate||(f.label=""),v=c+1;v<h.length;v++)if(null!==h[v]&&r[h[v]]){if(f.label)f.label+="‌: ";else if(!y){var b=f.category+": "+r[h[v]];t.ganttCatColors.push(b)}f.label+=r[h[v]],f.hint=(f.hint?f.hint+" - ":"")+r[h[v]],c=v;break}for(v=c+1;v<h.length;v++)null!==h[v]&&r[h[v]]&&(f.hint=(f.hint?f.hint+" - ":"")+r[h[v]]);if(!f.endDate&&!f.label&&!y){var _=f.category+": milestone";-1===t.ganttCatColors.indexOf(_)&&t.ganttCatColors.push(_)}}return!y||f.endDate&&f.startDate||(t.ganttCategories.splice(-1,1),t.textWidth=x),!y||f.endDate||f.startDate||t.ganttCatColors.splice(-1,1),!(y&&d.length>2)||void 0!==f.progress&&f.startDate&&f.endDate||(t.ganttCatColors.splice(-1,1),t.ganttCatColors.splice(-1,1)),!0}}}))}))})),a.remove(),(t.isSeries||t.isTime)&&e.sort((function(t,e){return t.value>e.value?1:-1})),t.isGantt&&"mono"===t.barColoringType)t.ganttCatColors=["Task","Task - Done","Task - Todo","Milestone","Event"];else if(!t.multiple||t.isGantt){var c=[];t.isGantt?c=t.ganttCatColors:$.each(i,(function(t,e){e.forEach((function(t){-1===c.indexOf(t)&&c.push(t)}))})),c&&(t.visiblePieKeysLength=c.length,t.pieKeys=c.concat(t.pieKeys.filter((function(t){return-1===c.indexOf(t)}))),t.colors=_t(t.colorKeyMap,t.pieKeys,t.palette),t.colorsCache=t.colors.slice())}else t.columns.forEach((function(e){var i=t.chartKeys.indexOf(e);i>=0&&t.chartKeys.push(t.chartKeys.splice(i,1)[0]),t.aggregation.forEach((function(i){var a=t.chartKeys.indexOf(i);a>=0&&t.chartKeys.push(t.chartKeys.splice(a,1)[0]);var n=i+" - "+e,r=t.chartKeys.indexOf(n);r>=0&&t.chartKeys.push(t.chartKeys.splice(r,1)[0])}))}));return e},Z.prototype.draw=function(t){var e=this;e.preventExport=t;var i=Y.a.hasLoadingContent(e.chartBody);if(0===e.originalTable.length||i)return e.badSettings.hide(),e.logZeroMessage.hide(),void(e.chartBody.data("hasFrame")||i?(e.noTableMessage.hide(),e.loader.show()):(e.noTableMessage.show(),e.loader.hide()));if(!Y.a.hasAnyTFACUnfinishedContent(e.originalTable,e.chartBody)){if(clearTimeout(e.timeoutDatePicker),!e.isTime&&!e.isGantt||$.datepicker){e.logZeroMessage.hide(),e.noTableMessage.hide(),e.badSettings.hide(),e.wrongDateFormat.hide(),e.noDataMessage.hide();var a=e.calculate();return e.calculatedData=a,e.clearTableHighlight(),e.svgWrapper.css({height:"",width:""}),e.svgWrapper.html(""),$("body").find("div.d3-tip.chart"+e.macroId+e.pageId).remove(),0===a.length?(0==e.columns.length||0==e.aggregation.length?e.badSettings.show():e.isTime||e.isGantt?(e.wrongDateFormat.show(),e.dateFormatInput.hasClass("autocomplete")||(Y.a.dateFormatAutocomplete(e.dateFormatInput),e.dateFormatInput.addClass("autocomplete"))):e.noDataMessage.show(),e.loader.hide(),e.selectColors.hide(),e.setInterpolationBtn.hide(),e.changeLineSettingsBtn.hide(),e.download.hasClass("tf-disabled-link")||e.download.toggleClass("tf-disabled-link"),void e.controls.animate({opacity:1},100)):(e.loader.hide(),e.selectColors.show(),e.shiftInterpolationBtn(),e.shiftChangeLineSettingsBtn(),e.download.hasClass("tf-disabled-link")&&e.download.toggleClass("tf-disabled-link"),e.controls.css("opacity",""),e.drawChart(a),!0)}e.timeoutDatePicker=setTimeout((function(){e.draw()}),100)}},Z.prototype.drawChart=function(t){var e=this;clearTimeout(e.chartTimer),e.content.is(":visible")?("Donut"!==e.type||e.is3D?e.type.indexOf("Column")>=0?e.drawColumn(t):"Pie"!==e.type||e.is3D?e.type.indexOf("Bar")>=0?e.drawBar(t):-1!==e.type.indexOf("Area")||-1!==e.type.indexOf("Line")?e.drawSeries(t):"Donut"===e.type&&e.is3D?e.drawDonut3D(t,.4):"Pie"===e.type&&e.is3D?e.drawDonut3D(t,0):e.isGantt?e.drawGantt(t):e.isBubblePie?e.drawBubblePie(t):e.isRadar&&e.drawRadar(t):e.drawPie(t,0):e.drawPie(t,"40%"),e.isLog&&e.multiple&&e.svgWrapper.find('[y="NaN"], [x="NaN"], [d*="NaN"]').length&&(e.logZeroMessage.show(),e.svgWrapper.html("")),(e.is3D||"Donut"!==e.type&&"Pie"!==e.type)&&setTimeout((function(){e.convertToImage()}),100)):e.chartTimer=setTimeout((function(){e.drawChart(t)}),200)},Z.prototype.drawBubblePie=function(t){var e=this,i=o.a.newSvg(e.svgWrapper[0],e.width,e.height),a=new o.a.chart(i,t),n=e.setBubbleAxisX(a),r=e.setBubbleAxisY(a);e.bubblePieSetting.filterAggregation.map((function(t){a.assignColor(t,e.colorKeyMap[t],e.colorKeyMap[t],1)})),e.setBubbleAxisXScale(n),e.setBubbleAxisYScale(r),e.settingBubbleAxis(n,r),a.addMeasureAxis("p","value"),a.addMeasureAxis("z","value");var s=a.addSeries([e.bubblePieSetting.axisX.title,e.bubblePieSetting.axisY.title,"indicator"],o.a.plot.pie);null===e.xValueType&&n.addOrderRule(e.bubblePieSetting.axisX.order),null===e.valueType&&r.addOrderRule(e.bubblePieSetting.axisY.order),s.addOrderRule(e.bubblePieSetting.filterAggregation),s.tooltipFontSize="14px",e.calculateBubbleLegendSize();var l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight};a.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),a.draw(),e.formatExtremumAxesX(n,s,l,a),a.draw();var c,u,h=(c=0,n.shapes.selectAll("text").each((function(){c=Math.max(gt($(this)),c)})),c);l={top:20+e.titleHeight,right:20+(e.isLegendUnderGraph||!e.legend?0:10+e.bubblePieSetting.legendWidth),bottom:40+h+e.xtitleHeight+(e.isLegendUnderGraph?5+e.bubblePieSetting.legendHeight+(e.xtitleHeight?10:0):5),left:25+e.bubblePieSetting.axisY.longestTitle+e.ytitleHeight},e.addTitle(i,e.width+l.left-l.right,{top:0}),e.legend&&((u=a.addLegend(e.isLegendUnderGraph?l.left+e.bubblePieSetting.posX:e.width-l.right+10,e.isLegendUnderGraph?e.height-e.bubblePieSetting.legendHeight-20+(e.xtitleHeight?5:0):l.top,e.bubblePieSetting.legendWidth||e.width-l.left,e.bubblePieSetting.legendHeight,"left"))._getEntries=function(){var t=[];return e.bubblePieSetting.filterAggregation.forEach((function(e){t.push({key:e,fill:a.getColor(e).fill,stroke:a.getColor(e).stroke,opacity:a.getColor(e).opacity,series:s,aggField:[e]})}),this),t}),a.setBounds(l.left,l.top,e.width-l.left-l.right,e.height-l.top-l.bottom),a.draw(),e.formatExtremumAxesY(r,s,l,a),a.draw(),e.settingSeriesTooltip(s),e.eventHandlerSeries(s,t),e.formatDimpleAxisX(n),e.legend&&(e.formatBubbleLegend(u),e.eventHandleLegendClick(a,u,t)),s.shapes.style("opacity",(function(t){return null===t.angle?0:1}))},Z.prototype.drawPie=function(t,e){var i=this,a=i.calcGroupSize(i.chartKeys.length);i.addGroupTitle();var r=n.scaleOrdinal().range(i.colors);r.domain(i.pieKeys);var s=0,o=[];i.chartKeys.forEach((function(n){var l=$.grep(t,(function(t){return t.aggregation==n})),c=l,u=it(l);u.count>1&&(l=u.data);var h=[];c.forEach((function(t){-1!=$.inArray(t,l)&&t.value&&h.push(r(t.label))})),h.push("#a3acb2");var d={};(i.title||i.chartKeys.length>1)&&(d={title:{text:i.chartKeys.length>1?n:i.title,color:"#333333",fontSize:16,font:"arial"},location:"top-center"});var p=new C(i.svgWrapper[0],{header:d,data:{content:l},size:{canvasHeight:a.height,canvasWidth:a.width,pieInnerRadius:e},labels:{mainLabel:{fontSize:14},percentage:{color:function(t,e){return rt(h[e%h.length])},decimalPlaces:1,fontSize:14},value:{color:function(t,e){return rt(h[e%h.length])},fontSize:14},inner:{format:i.innerLabelsType.value_percentage?"value-percentage":i.innerLabelsType.percentage_value?"percentage-value":i.innerLabelsType.value?"value":"percentage",hideWhenLessThanPercentage:i.showInnerLabels?4:100},formatter:function(t){var e=t.label;return"inner"===t.section&&("percentage"===t.part?e+="%":"value"===t.part&&(e=i.formatNumTo(t.value))),e}},tooltips:{enabled:!0,type:"placeholder",string:"{label}: {value} ({percentage}%)",placeholderParser:function(t,e){e.value=i.formatNumTo(e.value)},styles:{color:"white",backgroundColor:"black",backgroundOpacity:.8,padding:12,fontSize:14}},callbacks:{onload:function(){var t=$(p.svg._groups[0]),e=t.find('[class$="_segmentMainLabel-outer"]').css({fill:"#333","font-size":"14px","font-weight":"normal"});u.count>1&&e.last().css("font-style","italic"),s++,function(t,e){var i=ht(t);e.each((function(){var t=$(this),e=ht(t),a=parseFloat(t.attr("y"))||0;if(e.left<i.left||e.right>i.right){var n=e.width,r=Math.max(e.left,i.left),s=Math.min(e.right,i.right)-r,o=n-s;if(e.left<i.left){var l=parseFloat(t.attr("x"))||0;l+=o,t.attr("x",l)}var c=t.text(),u=Math.floor(c.length*s/n);if(u>0)for(var h=[];c.length>u;){t.text(c.substring(0,u)),c=c.substring(u);var d=t.clone();a+=7,d.text(c).attr("y",a),t.after(d),h.push(t),t=d,h.forEach((function(t){t.attr("y",(t.attr("y")||0)-7)}))}}}))}(t,e);var a=t.find('[class$="_segmentPercentage-inner"],[class$="_segmentValue-inner"]'),n=t.find('g[class$="_arc"]'),r=a.length/n.length;a.each((function(t){ft(n.eq(t/r),$(this))})),s==i.chartKeys.length&&i.convertToImage()},onClickSegment:function(t){i.clearTableHighlight(),t.expanded||i.highlightTable({rowNumber:t.data.rowNumber,column:t.data.aggregation.replace(" - "+t.data.key,"")}),o.forEach((function(e){if(p!==e){var a=e.getOpenSegment();a&&i.highlightTable({rowNumber:a.data.rowNumber,column:a.data.aggregation.replace(" - "+t.data.key,"")})}}))}},misc:{colors:{segments:h},canvasPadding:{top:20,right:20,bottom:20,left:20}}});o.push(p)}))},Z.prototype.drawDonut3D=function(t,e){var i=this,a=i.calcGroupSize(i.chartKeys.length),s=i.chartKeys.length>1?20:i.titleHeight,o=Math.min(a.width,a.height-s)/2;i.addGroupTitle();var l=n.scaleOrdinal().range(i.colors);l.domain(i.pieKeys);var c=[];i.hideTips=function(){for(var t=0;t<c.length;t++)c[t].hide()},i.chartKeys.forEach((function(u,h){var d=$.grep(t,(function(t){return t.aggregation===u})),p=d,g=it(d);g.count>1&&(d=g.data);var f=[];p.forEach((function(t){-1!==$.inArray(t,d)&&f.push(l(t.label))})),f.push("#a3acb2");var m=i.chart.append("svg").attr("width",a.width).attr("height",a.height);m.append("g").attr("id","donut3d"+i.macroId+i.pageId+h);var y=n.scaleOrdinal().range(f),x=d.map((function(t){return{label:t.label,value:t.value,color:y(t.label),textColor:rt(y(t.label)),other:t.other,rowNumber:t.rowNumber,name:u}}));O.draw("donut3d"+i.macroId+i.pageId+h,x,a.width/2,a.height/2,o,.7*o,.2*o,e,i.showInnerLabels,i.innerLabelsType,i.formatNumTo);var v,b=Object(r.a)().attr("class","d3-tip chart"+i.macroId+i.pageId).offset([-5,0]).html((function(t){var e=t.data.label+": "+i.formatNumTo(t.value)+" ("+O.getPercent(t)+")";return t.data.other&&g.smallData.forEach((function(t){e+="<br>"+t.label+": "+i.formatNumTo(t.value)+" ("+t.percent+"%)"})),e}));c.push(b),i.chartKeys.length>1?i.addTitle(m,a.width,{top:0},{title:u,titleHeight:s}):i.addTitle(m,a.width,{top:0}),m.call(b),m.selectAll(".topSlice, .percent").on("mouseover",(function(t){clearTimeout(v);var e=_.find(".percent").filter((function(){return this.textContent===t.data.label}));b.show(t,e[0]),e[0].__data__.data.other?b.style("font-style","italic"):b.style("font-style","normal")})).on("mouseout",(function(){v=setTimeout((function(){v=null,i.tipHover||b.hide()}),50)})),i.bindElementSelect(m,".topSlice",(function(t){return{rowNumber:t.__data__.data.rowNumber,column:i.getColumnNameForHighlight(t.__data__.data.name)}})),g.count>1&&i.svgWrapper.find("#donut3d"+i.macroId+i.pageId+h+".percent").last().css("font-style","italic");var _=$(m._groups[0]),w=_.find(".percent"),S=_.find(".topSlice");w.each((function(t){var e=$(this),i=S.eq(t%S.length);ft(i,e),function(t,e){var i=dt(t);if(0===i.height)return;e.each((function(){for(var t=$(this),e=dt(t),a=parseInt(t.css("font-size")),n=parseFloat(t.attr("y"))||0,r=parseFloat(t.attr("x"))||0;(e.top<i.top||e.bottom>i.bottom)&&a>0;){var s=pt(t);t.css("font-size",a--);var o=e.height;(e=dt(t)).top<i.top&&e.bottom<=i.bottom?(n=n+o-gt(t),t.attr("y",n),r+=(s-pt(t))/2,t.attr("x",r)):e.bottom>i.bottom&&e.top>=i.top&&(n=n-o+gt(t),t.attr("y",n),r-=(s-pt(t))/2,t.attr("x",r))}}))}(i,e)}))}))},Z.prototype.drawColumn=function(t){var e=this,i=0,a=e.type.indexOf("Stacked")>=0,s=e.convertData(t),o=e.isLog?n.scaleLog():n.scaleLinear(),l=n.axisLeft(o);e.isLog||l.tickFormat(e.formatNumTo);var c=n.min(a&&!e.isLog?s:t,(function(t){return a&&!e.isLog?t.min:t.value})),u=n.max(a?s:t,(function(t){return a?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,u<0&&(e.minvalue*=-1)),e.isLog&&(c=Math.pow(10,Math.floor(Math.log(c)/Math.LN10))),o.domain([isNaN(e.minvalue)?e.isLog?c:Math.min(0,c):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),isNaN(e.scaleStep)||l.tickValues(lt(o.domain(),e.scaleStep));var h=e.chart.append("svg"),d=h.append("g");e.argumentWidth=mt(o,l);var p=s.length*n.max(s,(function(t){return t.values.length})),g=ut(a?e.chartKeys.slice().reverse():e.chartKeys.slice(),Math.min(e.width,e.argumentWidth+20+e.ytitleHeight+20+200*p)-(e.argumentWidth+20+e.ytitleHeight)-20),f={top:20+e.titleHeight+(e.titleHeight&&e.is3D?10:0),right:e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+g.maxWidth:20,bottom:20+e.xtitleHeight+(e.isLegendUnderGraph?20*(g.rows+1)+10:0),left:e.argumentWidth+20+e.ytitleHeight},m=Math.min(e.width,f.left+f.right+200*p)-f.left-f.right,y=e.height-f.top-f.bottom;h.attr("width",m+f.left+f.right).attr("height",e.height),d.attr("transform","translate("+f.left+","+f.top+")");var x=n.scaleBand().rangeRound([0,m]).padding(.1),v=n.scaleBand();o.range([y,0]);var b=n.scaleOrdinal().range(e.colors),_=n.axisBottom(x),w=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.name+" ("+e.formatNumTo(t.value)+")"}));e.addTitle(d,m,f),d.call(w),b.domain(e.chartKeys),x.domain(s.map((function(t){return t.label}))),v.domain(e.chartKeys).rangeRound([0,x.bandwidth()]);var S=isNaN(e.minvalue)?e.isLog?c:0:Math.max(0,e.minvalue);if(S=isNaN(e.maxvalue)?S:Math.min(e.maxvalue,S),e.xtitle)var k=d.append("text").attr("x",m/2).attr("y",y+f.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var T=d.append("text").attr("transform","rotate(-90)").attr("y",15-f.left).attr("class","axis-title").attr("x",-y/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var C,P=d.selectAll(".bar").data(s).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate("+x(t.label)+",0)"}));e.hideTips=function(){w.hide()};var F=P.selectAll("rect").data((function(t){return t.values})).enter(),A=function(t){return at(t.value,o.domain()[0],o.domain()[1])},L=function(t){return a?0:v(t.name)},M=function(t){if(a)return o(at(t.y1,o.domain()[0],o.domain()[1]));var e=A(t);return o(e)-o(Math.min(S,e))+o(S)},I=function(t){if(a)return o(at(t.y0,o.domain()[0],o.domain()[1]))-M(t);var e=A(t);return Math.abs(o(e)-o(S))},D=a?x.bandwidth():v.bandwidth();if(e.addBarTrendLine(d,a,t,s,x,o,b,D),e.is3D){D=parseInt(.8*D);var B=parseInt(D/4),V=function(t){if(!t.value)return yt([[0,0]]);var e=L(t)+D,i=M(t),a=i+I(t);return yt([[e,parseInt(i)],[e+B,i-20],[e+B,a-20],[e,a]])},O=function(t){if(!t.value)return yt([[0,0]]);var e=L(t),i=e+D,a=Math.ceil(M(t));return yt([[e,a],[e+B,a-20],[i+B,a-20],[i,a]])};F.append("path").attr("class","bar-top").attr("key",(function(t){return t.name})).attr("d",O).style("fill",(function(t){return st(b(t.name),.8)})),F.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",V).style("fill",(function(t){return st(b(t.name),.9)}))}if(F.append("rect").attr("class",e.is3D?"bar 3d":"bar").attr("width",D).attr("x",L).attr("y",M).attr("height",I).attr("key",(function(t){return t.name})).style("fill",(function(t){return b(t.name)})),!e.isLog)var E=d.append("g").attr("class","y axis").append("line").attr("y1",o(S)).attr("y2",o(S)).attr("x2",m);if(d.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").call(_).selectAll("text"),d.append("g").attr("class","y axis").call(l).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),e.showInnerLabels){var N=$("<span id='inner-value-label-for-bar'></span>");$("body").append(N);var H=function(i,n,r){return e.formatBarInnerLabel((function(){return nt(i,t,s)}),(function(){return ct(i.value,$(r).parent().find(".bar").eq(n),y,a,!1,e.formatNumTo)}))};F.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var i=N.text(H(t,e,this)).width(),n=I(t);return i>n-5?a?0:5-M(t):-M(t)-n/2-i/2})).attr("y",(function(t){return a?x.bandwidth()/2:v(t.name)+v.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return H(t,e,this)})).style("font-size",(function(t,e){var i=N.text(H(t,e,this)).width(),n=I(t);return D<12||a&&i>n-5?0:14})).style("fill",(function(t,e){return N.text(H(t,e,this)).width()>I(t)-5?"black":rt(b(t.name))})).attr("transform",(function(){return"rotate(-90)"})),N.remove()}d.selectAll(".bar, .inner-value-label").on("mouseover",(function(t){clearTimeout(C);var e=$(this);e.is(".inner-value-label")&&(e=e.parent().find(".bar[key]").filterByAttr("key",t.name));var i=t;if(!t.name){var a=this.getAttribute("key");i=$.grep(t.values,(function(t){return t.name===a}))[0]}w.show(i,e[0])})).on("mouseout",(function(){C=setTimeout((function(){C=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(d,".bar");var z,G,W=parseFloat(e.svgWrapper.find("svg").attr("height")),R=function(t){e.textWidth>x.bandwidth()?(z="end",i=e.textWidth+10,G="translate(-14, 7) rotate(-90)",h.transition().duration(t).attr("height",W+e.textWidth),e.xtitle&&k.transition().duration(t).attr("y",y+f.bottom-15+e.textWidth-(e.isLegendUnderGraph?20*(g.rows+1):0))):(z="middle",i=22,G="translate(0, 0)",h.transition().duration(t).attr("height",W),e.xtitle&&k.transition().duration(t).attr("y",y+f.bottom-10-(e.isLegendUnderGraph?20*(g.rows+1):0))),d.selectAll(".x.axis text").transition().duration(t).attr("transform",G).style("text-anchor",z)};R(0);if(e.legend&&e.chartKeys.length>1){var j=e.chartKeys.slice();e.addLegend(d,m,y+e.xtitleHeight+i,f.top,b,a?j.reverse():j,e.isLegendUnderGraph,(function(i,r){var s=[];t.forEach((function(t){t.aggregation==i&&(t.hidden=!r),t.hidden||-1!=$.inArray(t.aggregation,s)||s.push(t.aggregation)}));var p=$.grep(t,(function(t){return!t.hidden}));if(p.length){var g=e.convertData(p);x.domain(g.map((function(t){return t.label}))),v.domain(s).rangeRound([0,x.bandwidth()]),c=e.isLog?c:n.min(a?g:p,(function(t){return a?t.min:t.value})),u=n.max(a?g:p,(function(t){return a?t.total:t.value})),o.domain([isNaN(e.minvalue)?e.isLog?c:Math.min(0,c):e.minvalue,isNaN(e.maxvalue)?Math.max(u,0):e.maxvalue]),D=a?x.bandwidth():v.bandwidth(),e.is3D&&(D*=.8,B=parseInt(D/4)),isNaN(e.scaleStep)||l.tickValues(lt(o.domain(),e.scaleStep));var w=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");g.forEach((function(t){var i=d.selectAll("[label]").filterByAttr("label",t.label),n=function(){i.transition().duration(300).attr("transform",(function(t){return"translate("+x(t.label)+",0)"}))};r||n(),t.values.forEach((function(t){var n=M(t),r=I(t);if(i.selectAll(".bar[key]").filterByAttr("key",t.name).transition().duration(300).attr("width",D).attr("x",L(t)).attr("y",n).attr("height",r),e.is3D&&(i.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",V(t)),i.selectAll(".bar-top[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",O(t))),e.showInnerLabels){var s=i.selectAll("text[key]").filterByAttr("key",t.name),o=function(t,i){return e.formatBarInnerLabel((function(){return nt(t,p,g)}),(function(){return ct(t.value,$(i._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),y,a,!1,e.formatNumTo)}))}(t,s),l=w.text(o).width();s.transition().duration(300).attr("x",a?-n-(r/2+l/2):-n-(l>r?-5:r/2+l/2)).attr("y",a?D/2:v(t.name)+D/2).style("font-size",D<12||a&&l>r-5?0:14).style("fill",l>r-5?"black":rt(b(t.name))).text(o)}})),r&&n()})),w.remove(),d.selectAll(".x.axis").transition().duration(300).on("start",(function(){R(300)})).call(_).selectAll(".x.axis text").style("text-anchor",z).attr("transform",G),d.selectAll(".y.axis").transition().duration(300).on("start",(function(){f.left-=e.argumentWidth,e.argumentWidth=mt(o,l),f.left+=e.argumentWidth,h.transition().duration(300).attr("width",m+f.left+f.right),d.transition().duration(300).attr("transform","translate("+f.left+","+f.top+")"),e.ytitle&&T.transition().duration(300).attr("y",15-f.left)})).call(l),e.isLog||E.transition().duration(300).attr("y1",o(S)).attr("y2",o(S)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},Z.prototype.drawBar=function(t){var e=this,i=e.type.indexOf("Stacked")>=0,a=e.convertData(t),s=e.isLog?n.scaleLog():n.scaleLinear(),o=n.axisTop(s);e.isLog||o.tickFormat(e.formatNumTo);var l=n.min(i&&!e.isLog?a:t,(function(t){return i&&!e.isLog?t.min:t.value})),c=n.max(i?a:t,(function(t){return i?t.total:t.value}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,c<0&&(e.minvalue*=-1)),e.isLog&&(l=Math.pow(10,Math.floor(Math.log(l)/Math.LN10))),s.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),isNaN(e.scaleStep)||o.tickValues(lt(s.domain(),e.scaleStep));var u=e.chart.append("svg"),h=u.append("g");e.argumentWidth=mt(s,o);var d=ut(i?e.chartKeys.slice().reverse():e.chartKeys.slice(),e.width-(e.textWidth+10+e.ytitleHeight)-40),p=e.is3D?20:0,g={top:e.argumentWidth+30+e.titleHeight+e.xtitleHeight,right:p+(e.legend&&!e.isLegendUnderGraph&&e.chartKeys.length>1?25+d.maxWidth:40),bottom:10+(e.isLegendUnderGraph?20*(d.rows+1)+10:0),left:e.textWidth+10+e.ytitleHeight},f=e.width-g.left-g.right,m=e.height-g.top-g.bottom;s.range([0,f]);var y=n.scaleBand().rangeRound([0,m]).padding(.2),x=n.scaleBand(),v=n.scaleOrdinal().range(e.colors),b=n.axisLeft(y),_=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.name+" ("+e.formatNumTo(t.value)+")"}));u.attr("width",e.width).attr("height",e.height),h.attr("transform","translate("+g.left+","+g.top+")");var w=e.addTitle(h,f,g);if(h.call(_),v.domain(e.chartKeys),y.domain(a.map((function(t){return t.label}))),x.domain(e.chartKeys).rangeRound([0,y.bandwidth()]),e.xtitle)var S=h.append("text").attr("x",f/2).attr("y",e.titleHeight+20-g.top).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);e.ytitle&&h.append("text").attr("transform","rotate(-90)").attr("y",15-g.left).attr("class","axis-title").attr("x",-m/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var k=isNaN(e.minvalue)?e.isLog?l:0:Math.max(0,e.minvalue);k=isNaN(e.maxvalue)?k:Math.min(k,e.maxvalue);var T,C=h.selectAll(".bar").data(a).enter().append("g").attr("class","g").attr("label",(function(t){return t.label})).attr("transform",(function(t){return"translate(0,"+y(t.label)+")"}));e.hideTips=function(){_.hide()};var P,F,A=C.selectAll("rect").data((function(t){return t.values})).enter(),L=function(t){return s(i?at(t.y0,s.domain()[0],s.domain()[1]):Math.min(k,at(t.value,s.domain()[0],s.domain()[1])))},M=function(t){return i?0:x(t.name)},I=function(t){return i?s(at(t.y1,s.domain()[0],s.domain()[1]))-L(t):Math.abs(s(at(t.value,s.domain()[0],s.domain()[1]))-s(k))},D=i?y.bandwidth():x.bandwidth();if(e.addBarTrendLine(h,i,t,a,y,s,v,D,!0),e.is3D){D=parseInt(.8*D);var B=parseInt(D/4),V=function(t){if(!t.value)return yt([[0,0]]);var e=L(t),i=e+I(t),a=M(t)+D;return yt([[e,a],[i,a],[i+p,a+B],[e+p,a+B]])},O=function(t){if(!t.value)return yt([[0,0]]);var e=L(t)+I(t),i=M(t),a=i+D;return yt([[e,i],[e+p,i+B],[e+p,a+B],[e,a]])};A.append("path").attr("class","bar-right").attr("key",(function(t){return t.name})).attr("d",O).style("fill",(function(t){return st(v(t.name),.8)})),A.append("path").attr("class","bar-bottom").attr("key",(function(t){return t.name})).attr("d",V).style("fill",(function(t){return st(v(t.name),.9)}))}if(A.append("rect").attr("class","bar").attr("width",I).attr("x",L).attr("y",M).attr("height",D).attr("key",(function(t){return t.name})).style("fill",(function(t){return v(t.name)})),e.showInnerLabels){var E=$("<span id='inner-value-label-for-bar'></span>");$("body").append(E);var N=function(n,r){return e.formatBarInnerLabel((function(){return nt(n,t,a)}),(function(){return ct(n.value,r,f,i,!0,e.formatNumTo)}))};A.append("text").attr("class","inner-value-label").attr("key",(function(t){return t.name})).attr("x",(function(t,e){var a=$(this).parent().find(".bar").eq(e),n=E.text(N(t,a)).width(),r=pt(a);return s(at(i?Math.min(t.y0,t.y1):Math.min(t.value,k),s.domain()[0],s.domain()[1]))+(n>r-5?r+5:(r-n)/2)})).attr("y",(function(t){return i?y.bandwidth()/2:x(t.name)+x.bandwidth()/2})).attr("dy",".35em").text((function(t,e){return N(t,$(this).parent().find(".bar").eq(e))})).style("font-size",(function(t,e){var a=$(this).parent().find(".bar").eq(e),n=E.text(N(t,a)).width(),r=pt(a);return(i?y.bandwidth()<14||n>r-5:x.bandwidth()<14)?0:14})).style("fill",(function(t){return rt(v(t.name))})),E.remove()}h.selectAll(".bar, .inner-value-label").on("mouseover",(function(t){T&&(clearTimeout(T),T=null);var e=$(this);e.is(".inner-value-label")&&(e=e.parent().find(".bar[key]").filterByAttr("key",t.name));var i=t;if(!t.name){var a=this.getAttribute("key");i=$.grep(t.values,(function(t){return t.name==a}))[0]}_.show(i,e[0])})).on("mouseout",(function(){T=setTimeout((function(){T=null,e.tipHover||e.hideTips()}),50)})),e.bindElementSelect(h,".bar"),h.append("g").attr("class","x axis").call(o);var H=function(t,i){g.top-=e.argumentWidth,e.argumentWidth=mt(s,o),g.top+=e.argumentWidth,t>e.width/(e.argumentWidth+30)?(P="start",F="translate(12, -4) rotate(-65)",u.transition().duration(i).attr("height",e.height).selectAll("svg > g").attr("transform","translate("+g.left+","+g.top+")"),w&&w.transition().duration(i).attr("y",e.titleHeight-g.top),S&&S.transition().duration(i).attr("y",e.titleHeight+20-g.top)):(P="middle",F="translate(0, 0)",u.transition().duration(i).attr("height",e.height-e.argumentWidth).selectAll("svg > g").attr("transform","translate("+g.left+","+(g.top-e.argumentWidth)+")"),w&&w.transition().duration(i).attr("y",e.titleHeight-g.top+e.argumentWidth),S&&S.transition().duration(i).attr("y",e.titleHeight+20-g.top+e.argumentWidth)),h.selectAll(".x.axis text").transition().duration(i).style("text-anchor",P).attr("transform",F)};H(h.selectAll(".x.axis text").size(),0),h.append("g").attr("class","y axis").call(b);var z=h.append("g").attr("class","y axis").append("line").attr("x1",s(k)).attr("x2",s(k)).attr("y2",m);if(e.legend&&e.chartKeys.length>1){var G=e.chartKeys.slice();e.addLegend(h,f+p,m,g.top,v,i?G.reverse():G,e.isLegendUnderGraph,(function(a,r){var u=[];t.forEach((function(t){t.aggregation==a&&(t.hidden=!r),t.hidden||-1!=$.inArray(t.aggregation,u)||u.push(t.aggregation)}));var d=$.grep(t,(function(t){return!t.hidden}));if(d.length){var p=e.convertData(d);l=e.isLog?l:n.min(i?p:d,(function(t){return i?t.min:t.value})),c=n.max(i?p:d,(function(t){return i?t.total:t.value})),s.domain([isNaN(e.minvalue)?e.isLog?l:Math.min(0,l):e.minvalue,isNaN(e.maxvalue)?Math.max(c,0):e.maxvalue]),y.domain(p.map((function(t){return t.label}))),x.domain(u).rangeRound([0,y.bandwidth()]),isNaN(e.scaleStep)||o.tickValues(lt(s.domain(),e.scaleStep)),D=i?y.bandwidth():x.bandwidth(),e.is3D&&(D=parseInt(.8*D),B=parseInt(D/4));var g=$("body").append("<span id='inner-value-label-for-bar'></span>").find("#inner-value-label-for-bar");p.forEach((function(t){var a=h.selectAll("[label]").filterByAttr("label",t.label),n=function(){a.transition().duration(300).attr("transform",(function(t){return"translate(0,"+y(t.label)+")"}))};r||n(),t.values.forEach((function(t){var n=a.selectAll(".bar[key]").filterByAttr("key",t.name),r=a.selectAll("text[key]").filterByAttr("key",t.name),o=I(t);if(n.transition().duration(300).attr("width",o).attr("x",L(t)).attr("y",M(t)).attr("height",D),e.is3D&&(a.selectAll(".bar-right[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",O(t)),a.selectAll(".bar-bottom[key]").filterByAttr("key",t.name).transition().duration(300).attr("d",V(t))),e.showInnerLabels){var l=$(r._groups[0]).parent().find(".bar[key]").filterByAttr("key",t.name),c=function(t){return e.formatBarInnerLabel((function(){return nt(t,d,p)}),(function(){return ct(t.value,l,f,i,!0,e.formatNumTo)}))},u=c(t),h=g.text(c(t)).width(),m=s(at(i?Math.min(t.y0,t.y1):Math.min(t.value,k),s.domain()[0],s.domain()[1]));r.transition().duration(300).attr("x",m+(h>o-5?o+5:(o-h)/2)).attr("y",i?y.bandwidth()/2:x(t.name)+x.bandwidth()/2).style("font-size",(i?y.bandwidth()<14||h>o-5:x.bandwidth()<14)?0:14).style("fill",h>o-5?"black":rt(v(t.name))).text(u)}})),r&&n()})),g.remove();var m=h.append("g").attr("class","xaxis-tmp").call(o),_=h.selectAll(".xaxis-tmp .tick").size();m.remove(),h.selectAll(".x.axis").transition().duration(300).on("start",(function(){H(_,300)})).call(o).selectAll(".x.axis text").style("text-anchor",P).attr("transform",F),h.selectAll(".y.axis").transition().duration(300).call(b),z.transition().duration(300).attr("x1",s(k)).attr("x2",s(k)),setTimeout((function(){e.convertToImage({noExport:!0})}),400)}}))}},Z.prototype.drawSeries=function(t){var e=this,i=null,a=null,r=0,s=-1!==e.type.indexOf("Stacked"),o=e.chartKeys,l=Y.a.parseValueByType(e.xValueType,e.xScaleStep,e.separator,e.worklog);if(l=isNaN(l)||!1===l?null:l,s&&e.convertSeriesDataStacked(t,o),e.isTime){try{i=Y.a.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){i=null}try{a=Y.a.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){a=null}var c=e.xScaleStep.indexOf("h")>-1?n.timeHour:e.xScaleStep.indexOf("w")>-1?n.timeWeek:e.xScaleStep.indexOf("m")>-1?n.timeMonth:e.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay;if(null==l){var u=t[t.length-1].value-t[0].value;u<864e6&&-1===e.workingDateFormat.indexOf("hh:mm")?(c=n.timeDay,l=1):e.workingDateFormat.indexOf("i")>=0?(c=n.timeMonth,l=3):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&u<31536e7?(c=n.timeYear,l=1):-1===e.workingDateFormat.indexOf("d")&&u<2592e7?(c=n.timeMonth,l=1):e.workingDateFormat.indexOf("w")>=0&&u<6048e6&&(c=n.timeWeek,l=1)}else l=Math.floor(l)}else i=Y.a.parseValueByType(e.xValueType,e.xminvalue,e.separator,e.worklog),a=Y.a.parseValueByType(e.xValueType,e.xmaxvalue,e.separator,e.worklog),i=isNaN(i)||!1===i?null:i,a=isNaN(a)||!1===a?null:a;if(0!==(t=$.grep(t,(function(t){return(null==i||t.value>=i)&&(null==a||t.value<=a)}))).length){var h=e.isTime?n.scaleTime():e.isXLog?n.scaleLog():n.scaleLinear(),d=e.isLog?n.scaleLog():n.scaleLinear(),p=n.axisBottom(h);if(e.isTime){var g=e.getTimeFormat();p.tickFormat(g),g}else e.isXLog||(p.tickFormat(e.formatNumToX),e.formatNumToX);var f=n.axisLeft(d);e.isLog||f.tickFormat(e.formatNumTo);var m=n.min(t,(function(t){return t.value})),y=n.max(t,(function(t){return t.value}));!e.isTime&&e.isXLog&&0==i&&(i=Number.MIN_VALUE,y<0&&(i*=-1)),h.domain([null==i?m:i,null==a?y:a]);var x=n.min(t,(function(t){return t.label})),v=n.max(t,(function(t){return s?t.y1:t.label}));e.isLog&&0==e.minvalue&&(e.minvalue=Number.MIN_VALUE,v<0&&(e.minvalue*=-1)),d.domain([isNaN(e.minvalue)?e.isLog?x:Math.min(0,x):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),ot(p),isNaN(e.scaleStep)||f.tickValues(lt(d.domain(),e.scaleStep));var b=e.chart.append("svg"),_=b.append("g");e.argumentWidth=mt(h,p),e.textWidth=Math.max(mt(d,f),e.argumentWidth/2);var w,S,k=ut(s?o.slice().reverse():o.slice(),e.width-(e.textWidth+20+e.ytitleHeight)-40),T={top:20+e.titleHeight,right:e.legend&&!e.isLegendUnderGraph&&o.length>1?k.maxWidth+25:40,bottom:e.argumentWidth+25+e.xtitleHeight+(e.isLegendUnderGraph?20*(k.rows+1)+10:0),left:e.textWidth+20+e.ytitleHeight},C=e.width-T.left-T.right;if(h.range([0,C]),d.range([e.height,0]),b.attr("oncontextmenu","return false;").attr("width",e.width).attr("height",e.height+T.top+T.bottom),_.attr("transform","translate("+T.left+","+T.top+")"),e.addTitle(_,C,T),e.xtitle)var P=_.append("text").attr("x",C/2).attr("y",e.height+T.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);if(e.ytitle)var F=_.append("text").attr("transform","rotate(-90)").attr("y",20-T.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);var A=function(t,i){T.bottom-=e.argumentWidth,e.argumentWidth=mt(h,p),T.bottom+=e.argumentWidth;var a=e.height+T.top+T.bottom;return t>C/(e.argumentWidth+10)?(w="end",r=e.argumentWidth+10,S="translate(-14, 7) rotate(-65)",e.xtitle&&P.transition().duration(i).attr("y",e.height+T.bottom-15-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))):(w="middle",r=22,S="translate(0, 0)",a-=e.argumentWidth,e.xtitle&&P.transition().duration(i).attr("y",e.height+T.bottom-e.argumentWidth-(e.isLegendUnderGraph?20*(k.rows+1)+5:0))),_.selectAll(".x.axis text").transition().duration(i).style("text-anchor",w).attr("transform",S),a};_.append("clipPath").attr("id","clip"+e.macroId+e.pageId).append("rect").attr("x",1).attr("width",C).attr("height",e.height);var L,M,I=_.append("g").attr("clip-path","url(#clip"+e.macroId+e.pageId+")");_.append("path").datum(t),e.grid&&!e.isArea&&(L=_.append("g"),M=_.append("g"));var D=function(t){var i=$.inArray(t,o);return e.colors[i%e.colors.length]},B=n.nest().key((function(t){return t.key})).entries(t),V=e.isArea?"area":"line",O=1,E={};if(o.forEach((function(t){var i,a=$.grep(B,(function(e){return e.key===t}));if(i=e.isArea?n.area().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y0((function(t){return t.y0?d(t.y0):e.height})).y1((function(t){return d(s?t.y1:t.label)})):n.line().curve(e.getInterpolation(t)).x((function(t){return h(t.value)})).y((function(t){return d(t.label)})),E[t]=i,a.length>0){if(a=a[0],tt(e.type)&&e.getLineType(a.key)===q.DOT)!function(t){var i=n.symbol().type(n.symbolCircle).size(100*e.getLineWidth(t.key));I.selectAll('path[key="'+t.key+'"]').data(t.values).enter().append("path").attr("key",t.key).attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})).attr("d",i()).style("fill",D(t.key))}(a);else{var r=I.append("path").attr("class",V).attr("d",i(a.values)).attr("key",a.key);e.isArea?r.style("fill",D(a.key)).style("opacity",O):(r.style("stroke",D(a.key)).style("stroke-width",e.getLineWidth(a.key)+"px"),tt(e.type)&&e.getLineType(a.key)===q.DASH&&r.style("stroke-dasharray","9, 6"))}s||(O*=.8),e.addTrendLine(a,_,h,d,D(a.key))}})),e.grid&&e.isArea&&(L=_.append("g"),M=_.append("g")),e.grid){var N=n.axisLeft(d).tickSize(-C,0,0).tickFormat(""),H=n.axisBottom(h).tickSize(e.height,0,0).tickFormat("");ot(H),isNaN(e.scaleStep)||N.tickValues(lt(d.domain(),e.scaleStep)),L.attr("class","grid").call(N).selectAll("line, .domain").attr("stroke",""),M.attr("class","grid").call(H).selectAll("line, .domain").attr("stroke","")}_.append("g").attr("class","x axis").attr("transform","translate(0,"+e.height+")").call(p).selectAll("text"),_.append("g").attr("class","y axis").call(f).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),b.attr("height",A(_.selectAll(".x.axis text").size(),0));var z=n.bisector((function(t){return t.value})).left,G={},W={};B.forEach((function(t){var i=_.append("g").attr("class","focus").style("display","none");i.append("circle").attr("r",4.5).style("fill",D(t.key));var a=$('<div class="d3-tip n chart'+e.macroId+e.pageId+'" style="position: absolute; pointer-events: all; box-sizing: border-box; display: none"></div>');e.svgWrapper.append(a),W[t.key]=a,G[t.key]=i}));var R=null;e.hideTips=function(){for(var t in G)G[t].style("display","none"),W[t].hide()};var j=n.drag(),X=!1;_.append("rect").attr("class","overlay").attr("width",C).attr("height",e.height).style("fill","none").on("mouseover",(function(){if(!X)for(var t in clearTimeout(R),G)G[t].style("display",""),W[t].show()})).on("mouseout",(function(){R=setTimeout((function(){R=null,e.tipHover||e.hideTips()}),50)})).on("mousemove",(function(){if(!X)if(n.event.altKey||n.event.ctrlKey||n.event.shiftKey)e.hideTips();else{var t=this,i=[];B.forEach((function(a){var r=G[a.key],o=h.invert(n.mouse(t)[0]),l=z(a.values,o,1),c=a.values[l-1],u=a.values[l],p=u&&o-c.value>u.value-o?u:c,f=h(p.value),m=d(s?p.y1:p.label);if(!isNaN(f)){if(f<0||f>C||m<0||m>e.height)return W[a.key].hide(),void r.style("display","none");r.style("display",""),r.attr("transform","translate("+f+","+m+")");var y=e.isTime?g(p.value):e.formatNumToX(p.value);W[a.key].show().text(e.formatNumTo(p.label)+" ("+y+")");var x=$(r._groups[0]).offset();x.top-=W[a.key].outerHeight()+6,x.left-=W[a.key].outerWidth()/2-4,i.push({key:a.key,offset:x,y:d(at(s?p.y1:p.label,d.domain()[0],d.domain()[1]))})}})),i.sort((function(t,e){return t.y-e.y}));var a=0;i.forEach((function(t){a>t.offset.top?(t.offset.top+=60,W[t.key].removeClass("n").addClass("s").offset(t.offset)):W[t.key].removeClass("s").addClass("n").offset(t.offset),a=t.offset.top+45}))}})).on("wheel",(function(){if(n.event.altKey||n.event.ctrlKey){n.event.preventDefault(),n.event.stopPropagation();var t=n.event.deltaY,i=n.mouse(this),a=C/10,r=i[0]/C*a,s=(1-i[0]/C)*a,o=e.height/10,l=i[1]/e.height*o,c=(1-i[1]/e.height)*o;t<0?(J.x1=h.invert(r),J.x2=h.invert(C-s),J.y2=d.invert(l),J.y1=d.invert(e.height-c)):(J.x1=Math.max(h.invert(-r),Z.x1),J.x2=Math.min(h.invert(C+s),Z.x2),J.y2=Math.min(d.invert(-l),Z.y2),J.y1=Math.max(d.invert(e.height+c),Z.y1)),nt()}})).call(j);var K=h.domain(),U=d.domain(),J={x1:K[0],y1:U[0],x2:K[1],y2:U[1]},Z={x1:K[0],y1:U[0],x2:K[1],y2:U[1]};e.legend&&o.length>1&&e.addLegend(_,C,e.height+r+5+e.xtitleHeight,T.top,D,s?o.slice().reverse():o,e.isLegendUnderGraph,(function(r,l){t.forEach((function(t){t.key==r&&(t.hidden=!l,W[r].css("visibility",l?"":"hidden"),G[r].style("visibility",l?"":"hidden"))}));var c=$.grep(t,(function(t){return!t.hidden}));c.length&&(s&&e.convertSeriesDataStacked(c,o),m=!e.isTime&&e.isXLog?m:n.min(c,(function(t){return t.value})),y=n.max(c,(function(t){return t.value})),h.domain([null==i?m:i,null==a?y:a]),K=h.domain(),h.domain([K[0]>J.x1?K[0]:J.x1,K[1]<J.x2?K[1]:J.x2]),x=n.min(c,(function(t){return t.label})),v=n.max(c,(function(t){return s?t.y1:t.label})),d.domain([isNaN(e.minvalue)?e.isLog?x:Math.min(0,x):e.minvalue,isNaN(e.maxvalue)?v:e.maxvalue]),U=d.domain(),d.domain([Math.max(U[0],J.y1),Math.min(U[1],J.y2)]),st($.grep(B,(function(t){return t.key==r&&(t.hidden=!l),!t.hidden}))))}));var Q=_.append("rect").attr("width",0).attr("height",0).attr("x",0).attr("y",0).attr("class","band"),et=[-1,-1];j.on("end",(function(){if(X=!1,0==n.event.sourceEvent.button&&!(n.event.sourceEvent.altKey||n.event.sourceEvent.ctrlKey||n.event.sourceEvent.shiftKey)){var t=n.mouse(this),e=-1==et[0]||et[0]==t[0]||et[1]==t[1];J.x1=h.invert(et[0]),J.x2=h.invert(t[0]),J.y1=d.invert(t[1]),J.y2=d.invert(et[1]);var i=et[0]>t[0];et=[-1,-1],Q.transition().attr("width",0).attr("height",0).attr("x",et[0]).attr("y",et[1]),e||(i?rt():nt())}})),j.on("drag",(function(){if(X=!0,e.hideTips(),0==n.event.sourceEvent.button){if(n.event.sourceEvent.altKey||n.event.sourceEvent.ctrlKey)return t=n.event.dx,i=n.event.dy,J.x1=h.invert(-t),J.x2=h.invert(C-t),J.y2=d.invert(-i),J.y1=d.invert(e.height-i),void nt(0);var t,i;if(n.event.sourceEvent.shiftKey)!function(t,i){J.x1=h.invert(t),J.x2=h.invert(C-t),J.y2=d.invert(-i),J.y1=d.invert(e.height+i),nt(0)}(n.event.dx,n.event.dy);else{var a=n.mouse(this);a[0]<et[0]?Q.attr("stroke","#14892c").attr("transform","translate("+a[0]+","+et[1]+")"):Q.attr("stroke","#707070"),a[1]<et[1]&&Q.attr("transform","translate("+a[0]+","+a[1]+")"),a[1]<et[1]&&a[0]>et[0]&&Q.attr("transform","translate("+et[0]+","+a[1]+")"),-1==et[0]&&(et=a,Q.attr("transform","translate("+et[0]+","+et[1]+")")),Q.transition().duration(1).attr("width",Math.abs(et[0]-a[0])).attr("height",Math.abs(et[1]-a[1]))}}}));var it=null}function nt(t){J.x1!=J.x2&&(J.x1>J.x2?rt():(h.domain([J.x1,J.x2]),J.y1>J.y2?d.domain([J.y2,J.y1]):d.domain([J.y1,J.y2]),st(B,t)))}function rt(){J={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2},h.domain(K),d.domain(U),st(B)}function st(t,i){i=null==i?300:i;var a=_.transition().duration(i);if(t.forEach((function(t){a.selectAll(".line[key], .area[key]").filterByAttr("key",t.key).attr("d",E[t.key](t.values)),tt(e.type)&&e.getLineType(t.key)==q.DOT&&a.selectAll('path[key="'+t.key+'"]').attr("transform",(function(t){return"translate("+h(t.value)+","+d(t.label)+")"})),e.showTrendLine&&a.selectAll(".trendline[key]").filterByAttr("key",t.key).attr("x1",h(t.trendData.x1)).attr("y1",d(t.trendData.y1)).attr("x2",h(t.trendData.x2)).attr("y2",d(t.trendData.y2))})),null!=l&&e.isSeries){var n=lt(h.domain(),l);p.tickValues(n),e.grid&&H.tickValues(n)}if(!isNaN(e.scaleStep)){n=lt(d.domain(),e.scaleStep);f.tickValues(n),e.grid&&N.tickValues(n)}var r=_.append("g").attr("class","xaxis-tmp").call(p),s=_.selectAll(".xaxis-tmp .tick").size();r.remove(),a.selectAll(".x.axis").call(p).selectAll(".x.axis text").style("text-anchor",w).attr("transform",S),a.selectAll(".y.axis").on("start",(function(){var t=e.textWidth;e.textWidth=Math.max(mt(d,f),e.argumentWidth/2),t-=e.textWidth,T.left-=t,e.width-=t,b.transition().duration(i).attr("width",e.width).attr("height",A(s,i)),_.transition().duration(i).attr("transform","translate("+T.left+","+T.top+")"),e.ytitle&&F.transition().duration(i).attr("y",20-T.left)})).call(f),e.grid&&(L.transition().duration(i).call(N).selectAll("line").attr("stroke",""),M.transition().duration(i).call(H).selectAll("line").attr("stroke","")),clearTimeout(it),it=setTimeout((function(){e.convertToImage({noExport:!0})}),i+100)}function ot(t){null!=l&&(e.isSeries?t.tickValues(lt(h.domain(),l)):c===n.timeDay&&1!==l?t.ticks(c.filter((function(t){return n.timeDay.count(0,t)%l==0}))):t.ticks(c.every(l)))}},Z.prototype.drawGantt=function(t){var e=this,i=n.scaleOrdinal().range(e.colors);i.domain(e.ganttCatColors);var a=[],s=[],o=[],l=[],c=[],u=[];if(t.forEach((function(t,n){if(t.endDate){var r="mono"===e.barColoringType?"Task":t.category;if(t.style="fill:"+i(r),t.doneStyle="fill:"+i(r+" - Done"),t.todoStyle="fill:"+i(r+" - Todo"),t.labelStyle="fill:"+rt(i(r)),t.label){var h=t.label.split("‌: ")[0];-1===o.indexOf(h)&&o.push(h)}e.hasTimeFormat||t.endDate.setHours(23,59,59);var d="";if(t.label){var p=t.label.split("‌: ");p.length>1&&(d="("+t.label.replace(p[0],"").replace("‌: ","")+")")}var g=Math.round((t.endDate-t.startDate)/864e5),f=t.progress>=0?" "+Math.round(100*t.progress)+"%":"";t.hint=t.category+" "+d+": "+g+" "+"days"+f,a.push(t)}else{var m=-1!==e.ganttCategories.indexOf(t.category),y=-1!==e.ganttCategories.indexOf(t.label);if(m||y){if(y&&u.push(t.label+"-"+t.startDate.getTime()),y||-1===u.indexOf(t.category+"-"+t.startDate.getTime())){var x=m?t.label:t.category,v=m?t.category:t.label,b=new RegExp("^"+v+" - ","g"),_="mono"===e.barColoringType?"Milestone":y?x:v+": "+(x||"milestone");l.push({id:n,category:v,label:x,date:t.startDate,style:"fill:"+i(_),hint:t.hint.replace(b,"")}),c.push(x)}}else{var w="mono"===e.barColoringType?"Event":t.category;s.push({date:t.startDate,style:"stroke:"+i(w),label:t.category||t.label,hint:t.hint,text:t.text})}}})),0!==a.length){if(1==o.length&&a.forEach((function(t){t.label=t.label.replace(o[0],"").replace("‌: ","")})),c.length){var h=s.slice();s=[],h.forEach((function(t,e){-1===c.indexOf(t.label)&&s.push(t)}))}a.sort((function(t,e){return t.startDate-e.startDate||(t.label>e.label?1:0)}));var d=null,p=null;try{d=Y.a.parseDate(e.xminvalue,e.dateFormat,e.locale)}catch(t){}try{p=Y.a.parseDate(e.xmaxvalue,e.dateFormat,e.locale)}catch(t){}if(d||(d=n.min([n.min(a,(function(t){return t.startDate})),n.min(l,(function(t){return t.date})),n.min(s,(function(t){return t.date}))])),!p){var g=$.grep(s,(function(t){return-1===["today","heute"].indexOf(t.text.toLowerCase())}));p=n.max([n.max(a,(function(t){return t.endDate})),n.max(l,(function(t){return t.date})),n.max(g,(function(t){return t.date}))]);var f=Y.a.parseDate("today");if(g.length<s.length&&f>p)if(.25*(p-d)>f-p)p=f;else{var m=.25*(p-d)+p.getTime();(p=new Date).setTime(m),s.filter((function(t){return-1!==["today","heute"].indexOf(t.text.toLowerCase())}))[0].date=p}}var y=null,x=null,v=Y.a.parseNumber(e.xScaleStep,e.separator);if(null!=(v=isNaN(v)||!1===v?null:v))y=e.xScaleStep.indexOf("h")>-1?n.timeHour:e.xScaleStep.indexOf("w")>-1?n.timeWeek:e.xScaleStep.indexOf("m")>-1?n.timeMonth:e.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,x=Math.floor(v);else{var b=a[a.length-1].endDate-a[0].startDate;b<864e6&&-1===e.workingDateFormat.indexOf("hh:mm")?(y=n.timeDay,x=1):e.workingDateFormat.indexOf("i")>=0?(y=n.timeMonth,x=3):-1===e.workingDateFormat.toLowerCase().indexOf("m")&&b<31536e7?(y=n.timeYear,x=1):-1===e.workingDateFormat.indexOf("d")&&b<2592e7?(y=n.timeMonth,x=1):e.workingDateFormat.indexOf("w")>=0&&b<6048e6&&(y=n.timeWeek,x=1)}var _=j(e.chart).height(e.height).width(e.width).grid(e.grid).categories(e.ganttCategories).tasks(a).dateLines(s).mileStones(l).tickFormat(e.getTimeFormat()).ticks({ticksSize:y,ticksStep:x}).timeDomain([d,p]).timeDomainMode("fixed");_.init();var w=e.chart.selectAll("svg");e.argumentWidth=mt(_.getTimeAxisRenderer().getAxisLine(),_.getTimeAxisRenderer().getAxis());var S={top:20+e.titleHeight,right:40,bottom:e.argumentWidth+25+e.ytitleHeight,left:e.textWidth+20+e.xtitleHeight};_.margin(S).draw();var k=e.width-S.left-S.right,T=w.selectAll(".gantt-chart");if(e.addTitle(T,k,S),e.ytitle)var C=T.append("text").attr("x",k/2).attr("y",e.height+S.bottom-10).attr("class","axis-title").style("text-anchor","middle").style("font-weight","bold").text(e.ytitle);e.xtitle&&T.append("text").attr("transform","rotate(-90)").attr("y",20-S.left).attr("class","axis-title").attr("x",-e.height/2).style("text-anchor","middle").style("font-weight","bold").text(e.xtitle);!function(t,i){if(t>k/(e.argumentWidth+10)){var a="end",n="translate(-14, 7) rotate(-65)",r=e.height+S.top+S.bottom;w.transition().duration(i).attr("height",r).style("height",r+"px"),e.ytitle&&C.transition().duration(i).attr("y",e.height+S.bottom-10)}else{a="middle",n="translate(0, 0)";r=e.height+S.top+S.bottom-e.argumentWidth;w.transition().duration(i).attr("height",r).style("height",r+"px"),e.ytitle&&C.transition().duration(i).attr("y",e.height+S.bottom-10-e.argumentWidth)}w.selectAll(".xaxis-group text").transition().duration(i).style("text-anchor",a).attr("transform",n)}(w.selectAll(".xaxis-group text").size(),0);var P=Object(r.a)().attr("class","d3-tip chart"+e.macroId+e.pageId).offset([-5,0]).html((function(t){return t.hint}));e.hideTips=function(){P.hide()},w.call(P),vt(P,w,".g_task",e),vt(P,w,".g_dateline",e),vt(P,w,".g_milestone",e),e.bindElementSelect(w,".g_task")}},Z.prototype.drawRadar=function(t){var e=n.scaleOrdinal().range(this.colors);e.domain(this.chartKeys);var i=ut(this.chartKeys.slice(),this.width-40),a={id:this.macroId+""+this.pageId,w:this.width,h:this.height,scaleStep:isNaN(this.scaleStep)?void 0:this.scaleStep,formatter:this.formatNumTo,color:e,padding:{left:20,right:this.legend&&!this.isLegendUnderGraph&&this.chartKeys.length>1?50+i.maxWidth:20,top:20+2*this.titleHeight,bottom:this.isLegendUnderGraph&&this.chartKeys.length>1?30+20*(i.rows+1):20},maxValue:isNaN(this.maxvalue)?0:this.maxvalue,grid:this.grid},r=X.draw(this.chart,t,a);if(this.addTitle(r.svg,2*r.cfg.center.x,{top:0}),this.legend&&this.chartKeys.length>1){var s=this.chartKeys.slice();this.addLegend(r.svg,r.cfg.center.x+r.cfg.radius+a.padding.left,r.cfg.center.y+r.cfg.radius+20,a.padding.top,e,s,this.isLegendUnderGraph,(function(){}))}},Z.prototype.addLegend=function(t,e,i,a,n,r,s,o){var l=$("<span></span>");$("body").append(l);for(var c=0,u=0,h=-1,d=r.slice(),p=0,g=0;g<d.length;g++)d[g].length>33&&(d[g]=d[g].substr(0,33)+"..."),c+=parseInt(l.text(d[g]).width())+30,p=Math.max(p,parseInt(l.text(d[g]).width()));var f=t.selectAll(".legend").data(s?d:d.slice(0,(this.svgWrapper.find("svg").attr("height")-a)/20)).enter().append("g").attr("class","legend").attr("transform",(function(t,a){return s&&(0!=a&&u+parseInt(l.text(d[a-1]).width())+30<e?u+=parseInt(l.text(d[a-1]).width())+30:(h+=1,u=c<=e?e/2-c/2:20)),"translate("+(s?u:p+26)+","+(s?i+10+20*h:20*a)+")"})).on("click",(function(e,i){var a=t.selectAll("[key]").filterByAttr("key",r[i]),n="hidden"==a.style("visibility")?1:0;$(this).css("opacity",0==n?.5:1),n||a.style("visibility","hidden"),o(r[i],n),n&&setTimeout((function(){t.selectAll("[key]").filterByAttr("key",r[i]).style("visibility","")}),330)}));f.append("title").text("Click to hide/show this data"),f.append("rect").attr("x",s?0:e-18).attr("width",18).attr("height",18).style("fill",(function(t,e){return n(r[e])})),f.append("text").attr("x",(function(t){return s?parseInt(l.text(t).width())+22:e-21})).attr("y",9).attr("dy",".35em").style("text-anchor","end").text((function(t){return t})),l.remove()},Z.prototype.formatBarInnerLabel=function(t,e){return this.innerLabelsType.percentage?t():this.innerLabelsType.value_percentage?e()+" ("+t()+")":this.innerLabelsType.percentage_value?t()+" ("+e()+")":e()},Z.prototype.addTitle=function(t,e,i,a){if(this.title||a&&a.title)return t.append("text").attr("x",e/2).attr("y",(a&&a.titleHeight?a.titleHeight:this.titleHeight)-i.top).attr("class","title").attr("text-anchor","middle").style("font-size","16px").style("font-weight","bold").style("fill","#333").text(a&&a.title?a.title:this.title)},Z.prototype.addGroupTitle=function(){var t=0;if(this.title&&this.chartKeys.length>1){var e=$(document.createElementNS("http://www.w3.org/2000/svg","text")).attr("class","_title").attr("x",this.width/2).attr("y",16).attr("text-anchor","middle").text(this.title).css({"font-size":"16px","font-family":xt(),"font-weight":"bold"}),i=$(document.createElementNS("http://www.w3.org/2000/svg","svg")).attr("width",this.width).attr("height",17).append(e);this.svgWrapper.prepend(i),t=i.outerHeight()}this.svgWrapper.height(this.height+t+5).width(this.width)},Z.prototype.convertToImage=function(t){var e=this;if(document.hidden)$(document).one("visibilitychange",(function(){setTimeout((function(){e.convertToImage(t)}),1e3)}));else{e.svgWrapper.find(".axis").css("font-size","10"),e.svgWrapper.find(".axis path, .axis line, .xaxis-group path, .xaxis-group line").css({fill:"none",stroke:"#000","shape-rendering":"crispEdges"}),e.svgWrapper.find(".line").css({fill:"none"}),e.svgWrapper.find("text").css({"font-family":xt()}),e.svgWrapper.find(".axis-title").css({"font-size":"14px"}),e.svgWrapper.find(':not([class$="_tooltip"]) > text:not(.legend):not(.title):not(.percent):not(.axis-title):not(.milestone-label):not([class$="_title"]):not([class$="_segmentPercentage-inner"]):not([class$="_segmentValue-inner"]):not(.inner-value-label):not([class$="_segmentMainLabel-outer"]):not(.task-label)').css({fill:"#333","font-size":"14px","font-weight":"normal"}),e.svgWrapper.find(".grid .tick").css({stroke:"lightgrey","stroke-opacity":.7,"shape-rendering":"crispEdges"}),e.svgWrapper.find(".grid .path").css({"stroke-width":0}),e.svgWrapper.find('[class$="_title"]').css("font-weight","bold"),e.svgWrapper.find('[class$="_tooltips"], .focus').hide(),e.svgWrapper.find(".tickY, .axisY").css({stroke:"black","shape-rendering":"crispEdges"}),e.svgWrapper.find(".gridX").css({"shape-rendering":"crispEdges"}),e.svgWrapper.find(".tick").css("opacity","");var i=e.svgWrapper.find("svg");i.find("#p0_footer").remove(),i.attr("version",1.1).attr("xmlns","http://www.w3.org/2000/svg");var a=et(i);if("undefined"==typeof btoa||!a||$("body").hasClass("edit")||$("body").hasClass("content-preview"))e.download.hide();else{var n=e.canvas.attr("width",e.svgWrapper.width()).attr("height",e.svgWrapper.height())[0],r=e.svgWrapper.offset();i.each((function(s){var o=$(this),l=o.offset();if(a=et(o),c()(n,a,{offsetX:l.left-r.left,offsetY:l.top-r.top,ignoreDimensions:!0,ignoreClear:!0}),s===i.length-1){var u=n.getContext("2d");u.globalCompositeOperation="destination-over",u.fillStyle="#ffffff",u.fillRect(0,0,n.width,n.height);var h=n.toDataURL("image/jpeg",1),d='<img src="'+h+'">';e.png.html(d),e.download.attr("href",h),e.preventExport||t&&t.noExport||(clearTimeout(e.exportTimer),e.exportTimer=setTimeout((function(){e.content.trigger("tf-export-ready",e.getExportEventData())}),300))}})),e.svgWrapper.find('[class$="_tooltips"]').show()}}},Z.prototype.getExportEventData=function(){return{macroId:this.macroId,adaptiveDimensions:this.adaptiveDimensions,data:this.calculatedData,params:[this.type,this.columns,this.aggregation,this.hide,this.grid,this.legend,this.minvalue,this.maxvalue,this.xminvalue,this.xmaxvalue,this.scalestep,this.xscalestep,this.title,this.xtitle,this.ytitle,this.isLog,this.isXLog,this.colors,this.pieKeys,this.showInnerLabels,this.showTrendLine,this.worklog,this.interpolation,this.lineSettings]}},Z.prototype.convertData=function(t){var e=this,i=[],a=[];t.forEach((function(t){-1==$.inArray(t.label,a)&&a.push(t.label),i[t.label]||(i[t.label]={label:t.label,values:[]}),i[t.label].values[e.chartKeys.indexOf(t.aggregation)]={name:t.aggregation,value:t.value,label:t.label,rowNumber:t.rowNumber}}));var n=[];return a.forEach((function(t){n.push(i[t])})),n.forEach((function(t){for(var i=e.isLog?Number.MIN_VALUE:0,a=i,n=0;n<t.values.length;n++){var r=t.values[n];r?r.value>=0?(r.y0=i,i+=r.value,r.y1=i):(r.y1=a,a+=r.value,r.y0=a):t.values.splice(n--,1)}t.total=i,t.min=a})),n},Z.prototype.convertSeriesDataStacked=function(t,e){var i=[];e.forEach((function(e){t.forEach((function(t){t.key===e&&(i[t.value]||(i[t.value]=0),t.y0=i[t.value],t.y1=t.y0+t.label,i[t.value]+=t.label)}))}))},Z.prototype.calcGroupSize=function(t){var e=this.width/this.height,i=Math.ceil(Math.sqrt(t*e)),a=Math.ceil(t/i),n=this.width/i,r=this.height/a,s=Math.min(n,r),o=i-1,l=Math.ceil(t/o);return s<=Math.min(this.width/o,this.height/l)&&(n=this.width/o,r=this.height/l),{width:n,height:r}},Z.prototype.addBarTrendLine=function(t,e,i,a,n,r,s,o,l){var c=this;if(c.showTrendLine){var u={};e?(u._total_={key:"",values:[]},a.forEach((function(t){u._total_.values.push({value:t.label,label:t.total})}))):i.forEach((function(t){u[t.aggregation]||(u[t.aggregation]={key:t.aggregation,values:[]}),u[t.aggregation].values.push({value:t.label,label:t.value})}));var h=0;$.each(u,(function(e,i){c.addTrendLine(i,t,n,r,s(i.key),o*(.5+h++),l)}))}},Z.prototype.addTrendLine=function(t,e,i,a,n,r,s){if(this.showTrendLine){var o=t.values.map((function(t){return t.value})),l=o.map((function(t){return i(t)})),c=function(t,e){var i=function(t,e){return t+e},a=1*t.reduce(i)/t.length,n=1*e.reduce(i)/e.length,r=t.map((function(t){return Math.pow(t-a,2)})).reduce(i),s=e.map((function(t){return Math.pow(t-n,2)})).reduce(i),o=t.map((function(t,i){return(t-a)*(e[i]-n)})).reduce(i),l=o/r,c=n-a*l,u=Math.pow(o,2)/(r*s);return[l,c,u]}(l,t.values.map((function(t){return parseFloat(t.label)}))),u=i.domain()[i.domain().length-1];t.trendData={x1:o[0],y1:c[0]*l[0]+c[1],x2:u,y2:c[0]*i(u)+c[1]};var h=i(t.trendData.x1),d=a(t.trendData.y1),p=i(t.trendData.x2),g=a(t.trendData.y2);if(!(isNaN(d)||isNaN(g)||isNaN(h)||isNaN(p)))r=r||0,e.selectAll(".trendline[key]").filterByAttr("key",t.key).data([{}]).enter().append("line").attr("class","trendline").attr("clip-path","url(#clip"+this.macroId+this.pageId+")").attr("key",t.key).attr(s?"y1":"x1",h+r).attr(s?"x1":"y1",d).attr(s?"y2":"x2",p+r).attr(s?"x2":"y2",g).attr("stroke",n).attr("stroke-dasharray","10,10").attr("stroke-width",1)}},Z.prototype.enableSaveBtn=function(){this.btn.removeClass("tf-disabled-link"),this.controls.add(this.btn).find(".tfac-unsaved").show()},Z.prototype.shiftInterpolationBtn=function(){!this.type||-1===this.type.indexOf("Line")&&-1===this.type.indexOf("Area")?this.setInterpolationBtn.hide():this.setInterpolationBtn.show()},Z.prototype.shiftChangeLineSettingsBtn=function(){this.type&&-1!==this.type.indexOf("Line")?this.changeLineSettingsBtn.show():this.changeLineSettingsBtn.hide()},Z.prototype.bindTips=function(){var t=this;$("body").delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseover",(function(){t.tipHover=!0})).delegate(".d3-tip.chart"+t.macroId+t.pageId,"mouseout",(function(){t.tipHover=!1,t.hideTips()}))},Z.prototype.getTimeFormat=function(){var t=this;if(-1===t.workingDateFormat.indexOf("hh:mm"))return function(e){return Y.a.formatDate(e,t.workingDateFormat,t.locale)};var e=t.workingDateFormat.replace("hh:mm","").replace(":ss","");return function(i){return 0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()?Y.a.formatDate(i,e,t.locale):Y.a.formatTime(i,t.workingDateFormat)}},Z.prototype.getInterpolation=function(t){return this.interpolation instanceof Array&&this.updateInterpolation(),this.interpolation[t]||(this.interpolation[t]=this.defaultInterpolation),function(t){switch(t){case"Linear":return n.curveLinear;case"Step":return n.curveStep;case"Natural cubic":return n.curveNatural;case"Monotone X cubic":return n.curveMonotoneX;case"Monotone Y cubic":return n.curveMonotoneY;case"Cubic Catmull–Rom":return n.curveCatmullRom;case"Cubic cardinal":return n.curveCardinal;case"Cubic basis":case"Straightened cubic basis":return n.curveBasis;default:return n.curveLinear}}(this.interpolation[t])},Z.prototype.getLineWidth=function(t){return this.lineSettings instanceof Array&&this.updateLineSettings(),this.lineSettings[t]&&this.lineSettings[t].width||1.5},Z.prototype.getLineType=function(t){return this.lineSettings instanceof Array&&this.updateLineSettings(),this.lineSettings[t]&&this.lineSettings[t].type||"solid"},Z.prototype.updateInterpolation=function(){var t=this,e={};t.chartKeys.forEach((function(i,a){e[i]=a<t.interpolation.length?t.interpolation[a]:t.defaultInterpolation})),t.interpolation=e},Z.prototype.updateLineSettings=function(){var t=this,e={};t.chartKeys.forEach((function(i,a){e[i]=a<t.lineSettings.length?{type:t.lineSettings[a].split("-")[0],width:parseFloat(t.lineSettings[a].split("-")[1])}:{type:"solid",width:1.5}})),t.lineSettings=e},Z.prototype.getInnerLabelsParam=function(){return this.showInnerLabels?this.innerLabelsType.value_percentage?"Value (Percentage)":this.innerLabelsType.percentage_value?"Percentage (Value)":this.innerLabelsType.percentage?"Percentage":this.innerLabelsType.value?"Value":"Donut"===this.type||"Pie"===this.type?"Percentage":"":"None"},Z.prototype.clearTableHighlight=function(){this.originalTable.removeClass("tf-chart-highlight"),this.rows.forEach((function(t){t.removeClass("tf-chart-highlight")})),this.originalTable.trigger("tf-chart-highlight-off")},Z.prototype.highlightTable=function(t){var e=this;e.originalTable.addClass("tf-chart-highlight"),$.each(t.rowNumber,(function(i,a){var n=e.rows[i];a.forEach((function(t){n.eq(t).addClass("tf-chart-highlight")})),e.originalTable.eq(i).trigger("tf-chart-highlight-on",{rowNumbers:a,column:t.column})}))},Z.prototype.bindElementSelect=function(t,e,i){var a=this;function r(t){a.clearTableHighlight();var r=n.select(t);r.classed("highlighted",!r.classed("highlighted")),a.svgWrapper.find(e+".highlighted").each((function(){a.highlightTable(i?i(this):{rowNumber:this.__data__.rowNumber,column:a.getColumnNameForHighlight(this.__data__.name)})}))}t.selectAll(e).on("click",(function(){r(this)})),t.selectAll("text.inner-value-label, text.percent").on("click",(function(){var t=$(this.parentNode),i=t.find(e);r(i.eq(t.find("text.inner-value-label, text.percent").index(this)%i.length)[0])}))},Z.prototype.getColumnNameForHighlight=function(t){return t?this.columns.length<2?t:t.substring(0,t.lastIndexOf(" - ")):""},Z.prototype.triggerSettingsButtonInvoke=function(){this.settings.trigger("aui-button-invoke"),this.settings.is(".active")&&this.settings.trigger("aui-button-invoke")},Z.prototype.formatBubbleLegend=function(t){var e=this,i=$("<span></span>");$("body").append(i);var a=[];t.shapes._groups[0].forEach((function(t,n){var r=$(t).children("text"),s=$(t).children("rect"),o=r.text();s.attr("height",18).attr("width",18),o.length>33&&(o=o.substr(0,33)+"...",r.text(o));var l=s.width()+5+i.text(o).width(),c=0,u=0;e.isLegendUnderGraph?(0===n||(e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?(0!==n&&(s.attr("y",a[n-1].signaturePosY+5+18),r.attr("y",a[n-1].signaturePosY+5+18)),c=+s.attr("x"),u=+s.attr("y"),r.attr("x",+r.attr("x")+3)):(c=a[n-1].signaturePosX+a[n-1].width+10,u=a[n-1].signaturePosY,s.attr("y",u)),r.attr("y",u+13),a.push({width:l,signaturePosX:c,signaturePosY:u}),0!==n&&((e.bubblePieSetting.indexFirstLegendInRow||[]).includes(n)?0:(1,r.attr("x",+c+23),s.attr("x",+c)))):0!==n?(r.attr("y",+r.attr("y")+3+9*n),s.attr("y",+s.attr("y")+9*n)):r.attr("y",+r.attr("y")+3)})),i.remove()},Z.prototype.calcBubbleChartExtremum=function(){var t,e;if(this.xminvalue){var i=Y.a.getAnyValueType(this.xminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);i===this.xValueType&&(this.bubblePieSetting.axisX.minValue=Y.a.parseAnyValueByType(i,this.xminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.xmaxvalue){var a=Y.a.getAnyValueType(this.xmaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);a===this.xValueType&&(this.bubblePieSetting.axisX.maxValue=Y.a.parseAnyValueByType(a,this.xmaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.bubblePieSetting.axisX.maxValue<this.bubblePieSetting.axisX.minValue){var n=this.bubblePieSetting.axisX.minValue,r=this.bubblePieSetting.axisX.maxValue;this.bubblePieSetting.axisX.minValue=r,this.bubblePieSetting.axisX.maxValue=n}this.bubblePieSetting.axisX.maxValue===this.bubblePieSetting.axisX.minValue&&(this.xValueType===Y.a.date?t=15768e6:this.xValueType===Y.a.worklog?t=Y.a.parseAnyValueByType(this.xValueType,"8h",this.separator,this.worklog,!0,this.dateFormat,this.locale):this.xValueType===Y.a.number?t=Y.a.parseAnyValueByType(this.xValueType,.5*this.bubblePieSetting.axisX.maxValue,this.separator,this.worklog,!0,this.dateFormat,this.locale):this.xValueType===Y.a.duration&&(t=Y.a.parseAnyValueByType(this.xValueType,"8:00",this.separator,this.worklog,!0,this.dateFormat,this.locale)),this.bubblePieSetting.axisX.maxValue=+this.bubblePieSetting.axisX.maxValue+t,this.bubblePieSetting.axisX.minValue=this.bubblePieSetting.axisX.minValue-t);if(this.yminvalue){var s=Y.a.getAnyValueType(this.yminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);s===this.valueType&&(this.bubblePieSetting.axisY.minValue=Y.a.parseAnyValueByType(s,this.yminvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.ymaxvalue){var o=Y.a.getAnyValueType(this.ymaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale);o===this.valueType&&(this.bubblePieSetting.axisY.maxValue=Y.a.parseAnyValueByType(o,this.ymaxvalue,this.separator,this.worklog,!0,this.dateFormat,this.locale))}if(this.bubblePieSetting.axisY.maxValue<this.bubblePieSetting.axisY.minValue){var l=this.bubblePieSetting.axisY.minValue,c=this.bubblePieSetting.axisY.maxValue;this.bubblePieSetting.axisY.minValue=c,this.bubblePieSetting.axisY.maxValue=l}this.bubblePieSetting.axisY.maxValue===this.bubblePieSetting.axisY.minValue&&(this.valueType===Y.a.date?e=15768e6:this.valueType===Y.a.worklog?e=Y.a.parseAnyValueByType(this.valueType,"8h",this.separator,this.worklog,!0,this.dateFormat,this.locale):this.valueType===Y.a.number?e=Y.a.parseAnyValueByType(this.valueType,.5*this.bubblePieSetting.axisY.maxValue,this.separator,this.worklog,!0,this.dateFormat,this.locale):this.valueType===Y.a.duration&&(e=Y.a.parseAnyValueByType(this.valueType,"8:00",this.separator,this.worklog,!0,this.dateFormat,this.locale)),this.bubblePieSetting.axisY.maxValue=+this.bubblePieSetting.axisY.maxValue+e,this.bubblePieSetting.axisY.minValue=this.bubblePieSetting.axisY.minValue-e)},Z.prototype.setBubbleAxisX=function(t){var e,i=this;if(i.xValueType===Y.a.date){i.workingDateFormat=i.dateFormat;var a=i.getTimeFormat();(e=t.addTimeAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return a}}else i.xValueType===Y.a.worklog?(e=t.addTimeAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return i.formatNumToX}:i.xValueType===Y.a.number||i.xValueType===Y.a.duration?(e=t.addMeasureAxis("x",i.bubblePieSetting.axisX.title))._getFormat=function(){return function(t){return i.formatNumToX(t)}}:(e=t.addCategoryAxis("x",i.bubblePieSetting.axisX.title),null!==i.xValueType&&(e._getFormat=function(){return i.formatNumToX}));return e},Z.prototype.setBubbleAxisY=function(t){var e,i=this;if(i.valueType===Y.a.date){i.workingDateFormat=i.dateFormat;var a=i.getTimeFormat();(e=t.addTimeAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return a}}else i.valueType===Y.a.worklog?(e=t.addTimeAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return i.formatNumTo}:i.valueType===Y.a.number||i.valueType===Y.a.duration?(e=t.addMeasureAxis("y",i.bubblePieSetting.axisY.title))._getFormat=function(){return function(t){return i.formatNumTo(t)}}:(e=t.addCategoryAxis("y",i.bubblePieSetting.axisY.title),null!==i.valueType&&(e._getFormat=function(){return i.formatNumTo}));return e},Z.prototype.setBubbleAxisXScale=function(t){if(this.bubblePieSetting.axisX.maxValue&&this.bubblePieSetting.axisX.minValue&&this.bubblePieSetting.axisX.maxValue>this.bubblePieSetting.axisX.minValue&&(t.overrideMax=this.bubblePieSetting.axisX.maxValue,t.overrideMin=this.bubblePieSetting.axisX.minValue,this.xScaleStep||this.xValueType!==Y.a.date||this.bubblePieSetting.axisX.maxValue-this.bubblePieSetting.axisX.minValue<864e6&&(this.xScaleStep="1d"),this.xScaleStep)){var e=Y.a.parseNumber(this.xScaleStep.toString(),this.separator);this.xValueType===Y.a.date&&(t.timePeriod=this.xScaleStep.indexOf("h")>-1?n.timeHour:this.xScaleStep.indexOf("w")>-1?n.timeWeek:this.xScaleStep.indexOf("m")>-1?n.timeMonth:this.xScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,t.timeInterval=e),this.xValueType===Y.a.worklog&&(t.timePeriod=this.xScaleStep.indexOf("h")>-1?n.timeHour:this.xScaleStep.indexOf("w")>-1?n.timeWeek:n.timeDay,t.timeInterval=e)}},Z.prototype.setBubbleAxisYScale=function(t){if(this.bubblePieSetting.axisY.maxValue&&this.bubblePieSetting.axisY.minValue&&this.bubblePieSetting.axisY.maxValue>this.bubblePieSetting.axisY.minValue&&(t.overrideMax=this.bubblePieSetting.axisY.maxValue,t.overrideMin=this.bubblePieSetting.axisY.minValue,this.yScaleStep||this.valueType!==Y.a.date||this.bubblePieSetting.axisY.maxValue-this.bubblePieSetting.axisY.minValue<864e6&&(this.yScaleStep="1d"),this.yScaleStep)){var e=Y.a.parseNumber(this.yScaleStep.toString(),this.separator);this.valueType===Y.a.date&&(t.timePeriod=this.yScaleStep.indexOf("h")>-1?n.timeHour:this.yScaleStep.indexOf("w")>-1?n.timeWeek:this.yScaleStep.indexOf("m")>-1?n.timeMonth:this.yScaleStep.indexOf("y")>-1?n.timeYear:n.timeDay,t.timeInterval=e),this.valueType===Y.a.worklog&&(t.timePeriod=this.yScaleStep.indexOf("h")>-1?n.timeHour:this.yScaleStep.indexOf("w")>-1?n.timeWeek:n.timeDay,t.timeInterval=e)}},Z.prototype.settingBubbleAxis=function(t,e){t.showGridlines=this.grid,e.showGridlines=this.grid,t.title=this.xtitle||"",e.title=this.ytitle||"",t.fontSize="14px",e.fontSize="14px"},Z.prototype.calculateBubbleLegendSize=function(){if(this.isLegendUnderGraph){var t=ut(this.bubblePieSetting.filterAggregation.slice(),this.width-(20+this.bubblePieSetting.axisY.longestTitle+5+this.ytitleHeight),36);this.bubblePieSetting.legendHeight=25*(t.rows+1),this.bubblePieSetting.indexFirstLegendInRow=t.firstInRow,this.bubblePieSetting.posX=t.posX}else{var e=$("<span></span>");$("body").append(e);var i=Y.a.getLongestWordInArr(this.bubblePieSetting.filterAggregation);this.bubblePieSetting.legendWidth=23+e.text(i).width(),this.bubblePieSetting.legendHeight=22*this.bubblePieSetting.filterAggregation.length,e.remove()}},Z.prototype.formatDimpleAxisX=function(t){t.shapes.selectAll("text").each((function(){if(!$(this).attr("transform"))return!1;var t=$(this).attr("transform").replace("rotate(90","rotate(-90").replace("translate(-5","translate("+(5-gt($(this))));$(this).attr("transform",t)})),this.xtitleHeight&&t.titleShape.attr("y",+t.titleShape.attr("y")+5)},Z.prototype.eventHandlerSeries=function(t,e){var i=this,a={},n={},r={};t.shapes.on("click",(function(t){var s="push",o=t.aggField[0],l=t.aggField[1],c=t.cy,u=t.cx,h=t.aggField[2];this.classList.contains("highlighted")?(this.classList.remove("highlighted"),s="remove"):this.classList.add("highlighted"),e.forEach((function(t){if(n[t.tableI]||(n[t.tableI]=[0]),-1===n[t.tableI].indexOf(t.rowI)&&n[t.tableI].push(t.rowI),t.indicator===h){if(i.valueType===Y.a.number||i.valueType===Y.a.duration){if(t["orig_"+i.bubblePieSetting.axisY.title]!==c)return}else if(t[i.bubblePieSetting.axisY.title]!==l)return;if(i.xValueType===Y.a.number||i.xValueType===Y.a.duration){if(t["orig_"+i.bubblePieSetting.axisX.title]!==u)return}else if(t[i.bubblePieSetting.axisX.title]!==o)return;"push"===s?(a[t.tableI]||(a[t.tableI]=[0],r[t.tableI]=[]),-1===a[t.tableI].indexOf(t.rowI)&&a[t.tableI].push(t.rowI),r[t.tableI].push(t.rowI)):(r[t.tableI].indexOf(t.rowI)>-1&&r[t.tableI].splice(r[t.tableI].indexOf(t.rowI),1),a[t.tableI].indexOf(t.rowI)>-1&&-1===r[t.tableI].indexOf(t.rowI)&&a[t.tableI].splice(a[t.tableI].indexOf(t.rowI),1),1===a[t.tableI].length&&delete a[t.tableI])}})),i.clearTableHighlight(),i.highlightTable({rowNumber:$.isEmptyObject(a)?n:a})}))},Z.prototype.eventHandleLegendClick=function(t,e,i){var a=this;t.legends=[];var r=o.a.getUniqueValues(i,"indicator");e.shapes.selectAll("rect").on("click",(function(e){var s=!1,l=[];r.forEach((function(t){t===e.aggField.slice(-1)[0]?s=!0:l.push(t)})),s?n.select(this).style("opacity",.2):(l.push(e.aggField.slice(-1)[0]),n.select(this).style("opacity",1)),r=l;var c=a.bubblePieSetting.axisX.title,u=a.bubblePieSetting.axisY.title;a.bubblePieSetting.sameValuesCount={},i.forEach((function(t){r.includes(t.indicator)&&(a.valueType!==Y.a.number&&a.valueType!==Y.a.duration&&a.xValueType!==Y.a.number&&a.xValueType!==Y.a.duration||(a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]>0?a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]+=1:a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+(t["orig_"+u]||t[u])]=1))}));var h=o.a.filterData(i,"indicator",r);h.forEach((function(t){a.valueType!==Y.a.number&&a.valueType!==Y.a.duration||(t[u]=parseFloat(t["orig_"+u]/a.bubblePieSetting.sameValuesCount[(t["orig_"+c]||t[c])+"_"+t["orig_"+u]])),a.xValueType!==Y.a.number&&a.xValueType!==Y.a.duration||(t[c]=parseFloat(t["orig_"+c]/a.bubblePieSetting.sameValuesCount[t[c]+"_"+(t["orig_"+c]||t[c])]))})),t.data=h,t.draw()}))},Z.prototype.settingSeriesTooltip=function(t){var e=this;t.getTooltipText=function(t){var i=function(t,i){return Y.a.formatAnyValueByType(t,i,(function(t){return t>=1e4?e.formatNum.to(t):e.formatNumShort.to(t)}),e.worklog,e.dateFormat,e.locale)},a=null!==e.xValueType?i(t.cx,e.xValueType):t.cx,n=null!==e.valueType?i(t.cy,e.valueType):t.cy,r=null!==e.bubblePieSetting.indicator.valueType?i(t.cz,e.bubblePieSetting.indicator.valueType):t.cz;switch(e.getInnerLabelsParam()){case"Value (Percentage)":r+=" ("+Math.round(100*t.piePct)+"%)";break;case"Percentage (Value)":r=Math.round(100*t.piePct)+"% ("+r+")";break;case"Percentage":r=Math.round(100*t.piePct)+"%"}return[e.bubblePieSetting.axisX.title+": "+a,e.bubblePieSetting.axisY.title+": "+n,t.aggField[2]+": "+r]}},Z.prototype.formatExtremumAxesX=function(t,e,i,a){if(null!==this.xValueType||null!==this.valueType){var n=ht($(a.svg._groups[0])),r={left:0,right:0,tickXSize:0},s=0,o=0,l=0;t.shapes.selectAll("g").each((function(){s+=1})),r.left=n.left+i.left,r.right=n.right-i.right,r.tickXSize=n.width/s,e.shapes.each((function(){var t=ht($(this));t.left<r.left&&(l=Math.max(l,r.left-t.left)),t.right>r.right&&(o=Math.max(o,t.right-r.right))})),l>0&&null!==this.xValueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(l/r.tickXSize)),o>0&&null!==this.xValueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(o/r.tickXSize))}},Z.prototype.formatExtremumAxesY=function(t,e,i,a){if(null!==this.xValueType||null!==this.valueType){var n=dt($(a.svg._groups[0])),r={top:0,bottom:0,tickYSize:0},s=0,o=0,l=0;t.shapes.selectAll("g").each((function(){s+=1})),r.top=n.top+i.top,r.bottom=n.bottom-i.bottom,r.tickYSize=n.height/s,e.shapes.each((function(){var t=dt($(this));t.top<r.top&&(o=Math.max(o,r.top-t.top)),t.bottom>r.bottom&&(l=Math.max(l,t.bottom-r.bottom))})),o>0&&null!==this.valueType&&(t.overrideMax=+t.overrideMax+(t.overrideMax-t.overrideMin)/s*Math.ceil(o/r.tickYSize)),l>0&&null!==this.valueType&&(t.overrideMin-=(t.overrideMax-t.overrideMin)/s*Math.ceil(l/r.tickYSize))}},Z.prototype.setColorKeyMap=function(t,e,i){return e.forEach((function(e,a){t[e]=i[a]})),t};e.a=Z},4:function(t,e){if(window.TFACInlineDialogTemplates=window.TFACInlineDialogTemplates||{},void 0===i)var i={};i.inlineDialog=function(t,e){var a='<form class="aui top-label inline-dialog-form tf-inline-dialog-form '+soy.$$escapeHtml(t.clazz)+'" id="'+soy.$$escapeHtml(t.name)+"-"+soy.$$escapeHtml(t.dialogId)+'">';if(""!=t.inputs){a+="<fieldset>";for(var n=t.inputs,r=n.length,s=0;s<r;s++){var o=n[s];a+='<div class="field-group"><label for="input-'+soy.$$escapeHtml(o.field)+"-"+soy.$$escapeHtml(s)+'">'+soy.$$escapeHtml(o.field)+(o.help?'<a href="'+soy.$$escapeHtml(o.help)+'" target="_blank"><span class="aui-icon aui-icon-small aui-iconfont-help tf-macro-editor-help"></span></a>':"")+"</label>"+i.field({input:o,index:s})+"</div>"}a+='</fieldset><div class="buttons-container"><div class="buttons"><input class="aui-button" type="button" value="'+soy.$$escapeHtml("Save")+'" id="apply-'+soy.$$escapeHtml(t.dialogId)+'"/><a class="cancel" id="cancel-'+soy.$$escapeHtml(t.dialogId)+'">'+soy.$$escapeHtml("Cancel")+"</a></div></div>"}else a+='<div class="aui-message info aui-message-info"><p>'+soy.$$escapeHtml("Filters are not specified")+'</p></div><div class="buttons-container"><div class="buttons"><a class="cancel" id="cancel-'+soy.$$escapeHtml(t.dialogId)+'">'+soy.$$escapeHtml("Cancel")+"</a></div></div>";return a+="</form>"},goog.DEBUG&&(i.inlineDialog.soyTemplateName="TFACInlineDialogTemplates.inlineDialog"),i.field=function(t,e){var i="";if("checkbox"==t.input.variant)i+='<input class="checkbox inverse-input" type="checkbox" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' checked="checked"':"")+"/>";else if("text"==t.input.variant)i+='<input type="text" class="text simple-input" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'"':"")+"/>";else if("number"==t.input.variant)i+='<input type="number" min="'+soy.$$escapeHtml(t.input.min)+'" max="'+soy.$$escapeHtml(t.input.max)+'" class="text simple-input" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'"':"")+"/>";else if("single_select"==t.input.variant){i+='<select class="select" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="'+soy.$$escapeHtml(t.input.type)+'"'+(t.input.isMultiple?"multiple":"")+(t.input.isIcon?' data-html="true"':"")+">";for(var a=t.input.selects,n=a.length,r=0;r<n;r++){var s=a[r];i+='<option value="'+soy.$$escapeHtml(s)+'"';for(var o=t.input.value,l=o.length,c=0;c<l;c++){i+=o[c]==s?' selected="selected"':""}i+=">"+soy.$$escapeHtml(s)+"</option>"}for(var u=t.input.fakeSelects,h=u.length,d=0;d<h;d++){var p=u[d];i+='<option value="'+soy.$$escapeHtml(p)+'" selected="selected">'+soy.$$escapeHtml(p)+"</option>"}i+="</select>"}else if("line_settings"==t.input.variant)i+='<select class="select line-settings-type" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-name="'+soy.$$escapeHtml(t.input.field)+'"><option value="solid"'+("solid"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Solid")+'</option><option value="dash"'+("dash"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Dash")+'</option><option value="circle"'+("circle"==t.input.value.type?'selected="selected"':"")+">"+soy.$$escapeHtml("Dot")+'</option></select><input class="line-settings-width text simple-input" type="number" min="0" max="100000" name="'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'" data-type="number"'+(t.input.value.width?'value="'+soy.$$escapeHtml(t.input.value.width)+'"':"")+"/>px";else if("interpolation_select"==t.input.variant)i+='<select class="select" data-name="'+soy.$$escapeHtml(t.input.field)+'" name="input-'+soy.$$escapeHtml(t.input.field)+"-"+soy.$$escapeHtml(t.index)+'"><option value="Linear"'+("Linear"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Linear")+'</option><option value="Step"'+("Step"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Step")+'</option><option value="Natural cubic"'+("Natural cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Natural cubic")+'</option><option value="Monotone X cubic"'+("Monotone X cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Monotone X cubic")+'</option><option value="Monotone Y cubic"'+("Monotone Y cubic"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Monotone Y cubic")+'</option><option value="Cubic Catmull–Rom"'+("Cubic Catmull–Rom"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic Catmull\ufffdRom")+'</option><option value="Cubic cardinal"'+("Cubic cardinal"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic cardinal")+'</option><option value="Cubic basis"'+("Cubic basis"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Cubic basis")+'</option><option value="Straightened cubic basis"'+("Straightened cubic basis"==t.input.value?'selected="selected"':"")+">"+soy.$$escapeHtml("Straightened cubic basis")+"</option></select>";else if("colors"==t.input.variant){i+='<button class="aui-button aui-dropdown2-trigger" aria-owns="tf-chart-colors-'+soy.$$escapeHtml(t.index)+"-"+soy.$$escapeHtml(t.input.id)+'" aria-haspopup="true"><a class="tfc-color selected" data-color="'+soy.$$escapeHtml(t.input.color)+'" style="background: '+soy.$$escapeHtml(t.input.color)+';"></a></button><div id="tf-chart-colors-'+soy.$$escapeHtml(t.index)+"-"+soy.$$escapeHtml(t.input.id)+'" class="aui-style-default aui-dropdown2 tfc-color-dd"><ul>';for(var g=["#8eb021","#d04437","#3572b0","#f6c342","#654982","#f691b2","#2484c1","#65a620","#7b6888","#d8d23a","#e98125","#6ada6a","#0c6197","#e4a14b","#8cc3e9","#a3acb2","#69a6f9","#cc1010","#31383b"],f=g.length,m=0;m<f;m++){var y=g[m];i+='<li class="tfc-li-color"><a class="tfc-color" data-color="'+soy.$$escapeHtml(y)+'" style="background: '+soy.$$escapeHtml(y)+';" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li>'}i+='<li class="tfc-li-color"><a class="tfc-color" data-color="#000000" style="background: #000000;" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li><li class="tfc-li-color"><a class="tfc-color" data-color="#ffffff" style="background: #ffffff;" data-index="'+soy.$$escapeHtml(t.index)+'"></a></li></ul></div>'}else if("range"==t.input.variant){var x=t.input.isDate?"date":"number";i+='<div class="'+soy.$$escapeHtml(x)+'s range" data-type="'+soy.$$escapeHtml(t.input.type)+'">'+soy.$$escapeHtml("from")+'<input type="text" class="text '+soy.$$escapeHtml(x)+' from" name="'+soy.$$escapeHtml(t.input.field)+"-from-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-from-"+soy.$$escapeHtml(t.index)+'" '+(t.input.value?' value="'+soy.$$escapeHtml(t.input.value)+'" ':"")+(t.input.isDate?' placeholder="'+soy.$$escapeHtml("Pick date")+'" ':"")+"/>"+soy.$$escapeHtml("to")+'<input type="text" class="text '+soy.$$escapeHtml(x)+' to" name="'+soy.$$escapeHtml(t.input.field)+"-to-"+soy.$$escapeHtml(t.index)+'" id="input-'+soy.$$escapeHtml(t.input.field)+"-to-"+soy.$$escapeHtml(t.index)+'" '+(t.input.valueTo?' value="'+soy.$$escapeHtml(t.input.valueTo)+'" ':"")+(t.input.isDate?' placeholder="'+soy.$$escapeHtml("Pick date")+'" ':"")+"/></div>"}return i},goog.DEBUG&&(i.field.soyTemplateName="TFACInlineDialogTemplates.field"),t.exports=i},46:function(t,e,i){},50:function(t,e,i){},51:function(t,e,i){}}]);
}catch(e){WRMCB(e)};