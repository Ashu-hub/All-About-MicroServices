WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.stiltsoft.confluence.plugin.tablefilter.tablefilter:macro-inserter-resources', location = 'build/macro-inserter.js' */
!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a(a.s=88)}({44:function(e,t){if(window.TFInserterTamplate=window.TFInserterTamplate||{},void 0===a)var a={};a.panel=function(e,t){for(var n='<div class="tfac-macro-inserter">',r=e.macros,o=r.length,i=0;i<o;i++){var l=r[i];n+='<span class="aui-icon aui-icon-small '+soy.$$escapeHtml(l.name)+'-inserter" title="'+a.title({macro:l.id})+'" data-macro="'+soy.$$escapeHtml(l.name)+'"></span>'}return n+='<a target="_blank" '+(e.isAdmin?' href="'+soy.$$escapeHtml(AJS.contextPath())+'/admin/plugins/tfac/config.action" ':' href="'+soy.$$escapeHtml(AJS.contextPath())+'/users/tfac-settings.action" ')+'><span class="aui-icon aui-icon-small aui-iconfont-configure" title="'+soy.$$escapeHtml("Configure visibility")+'"></span></a></div>'},goog.DEBUG&&(a.panel.soyTemplateName="TFInserterTamplate.panel"),a.title=function(e,t){return""+("tf"==e.macro?soy.$$escapeHtml("Filter table data"):"pivot"==e.macro?soy.$$escapeHtml("Create a pivot table"):soy.$$escapeHtml("Create a chart from data series"))},goog.DEBUG&&(a.title.soyTemplateName="TFInserterTamplate.title"),e.exports=a},78:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var n,r,o=a(44),i=a.n(o);n=AJS.$,r={ignoreMacros:[".quiz-settings-content",".code",".profile-macro",".gallery","#course-content",".calendar"],tfacSources:[{name:"table-joiner",class:"tj-source"},{name:"pivot-table",class:"original-table"},{name:"table-chart",class:"chart-body"}],tfacMacros:[{name:"table-filter",class:"tablefilter-outer-wrapper",id:"tf"},{name:"pivot-table",class:"pivot-content",id:"pivot"},{name:"table-joiner",class:"table-joiner",id:"tj"},{name:"table-chart",class:"table-chart-contents",id:"chart"}],macrosWithBody:["json-table","csv","vote","survey","report-table","confiform-table"],macroDuplications:[".pocketquery-dynamic-load-container"],init:function(){var e=this;e.content=n("#main-content"),e.tables=e.content.find("table"),e.tables.each((function(){e.initTable(n(this))})),e.content.delegate("table","mouseover.tf-init",(function(){var t=n(this);t.undelegate("mouseover.tf-init"),-1===e.tables.index(t)&&e.initTable(t)}))},initTable:function(e){var t=r;if(!e.parents(t.ignoreMacros.join(",")).length){var a={table:e,containerType:"macro",macros:JSON.parse(JSON.stringify(t.tfacMacros))};e.parents("."+t.tfacMacros.map((function(e){return e.class})).concat(t.tfacSources.map((function(e){return e.class}))).join(",.")).each((function(){var e=n(this);if(e.is("."+t.tfacSources.map((function(e){return e.class})).join(",.")))return t.setMacroUsage(t.tfacSources,e,a),a.containerType="macro-body",!1;t.setMacroUsage(t.tfacMacros,e,a)}));var o=a.macros.filter((function(e){return!e.present&&"table-joiner"!==e.name}));o.length&&e.bind("mouseover.tf",(function(){clearTimeout(t.timer),e.is(t.activeTable)||(t.timer=setTimeout((function(){t.panel&&t.panel.remove(),t.activeTable=e,t.panel=n(i.a.panel({macros:o,isAdmin:AJS.params.isConfluenceAdmin})),t.content.append(t.panel);var r=e.offset(),l=e.parent();t.panel.offset({top:r.top,left:Math.max(r.left,l.offset().left)+Math.min(e.width(),l.width())+5}),t.bindPanel(a),e.unbind("mouseleave.tf").bind("mouseleave.tf",t.removePanel)}),150))}))}},bindPanel:function(e){var t=r;t.panel.bind("mouseenter.tf",(function(){clearTimeout(t.timer)})).bind("mouseleave.tf",t.removePanel),t.panel.children("span").click((function(){if(!t.panel.hasClass("disabled")){t.panel.addClass("disabled");var a,r,o,i=n(this).data("macro"),l=-1,c=e.table.parents('[data-macro-name="table-excerpt-include"]');if(c.length)r="table-excerpt-include",a="macro",o=t.content.find('[data-macro-name="table-excerpt-include"]').index(c);else if(e.owner)r=e.owner.name,a=e.containerType,o=t.filterTEI(t.content.find("."+e.owner.class)).index(e.owner.node);else{var s=e.table.parents(".conf-macro, .jira-table").eq(0);e.table.attr("data-macro-name")?(a="macro",r=e.table.data("macro-name"),o=t.filterTEI(t.content.find('[data-macro-name="'+r+'"]')).index(e.table)):s.length?(s.hasClass("jira-table")?(r="jira",o=t.filterTEI(t.content.find(".jira-table")).index(s)):(r=s.data("macro-name"),o=t.filterTEI(t.content.find('[data-macro-name="'+r+'"]').not(t.macroDuplications.join(","))).index(s)),"true"===s.attr("data-hasbody")&&-1===t.macrosWithBody.indexOf(r)?(a="macro-body",l=s.find(":not(.conf-macro) table").index(e.table)):a="macro"):e.table.hasClass("appfire-table-plus-parms")?(a="macro",r="json-table|csv|sql-query",o=t.content.find("div.table-wrap > table.confluenceTable.appfire-table-plus-parms").filter((function(){return-1===t.content.find("table.confluenceTable.appfire-table-plus-parms table.confluenceTable.appfire-table-plus-parms").index(this)})).index(e.table)):(a="table",o=t.content.find("div.table-wrap > table.confluenceTable:not(.appfire-table-plus-parms)").filter((function(){return 0===n(this).parents(".conf-macro").length})).index(e.table))}n.ajax({contentType:"application/x-www-form-urlencoded; charset=utf-8",type:"POST",async:!1,cache:!1,url:Confluence.getContextPath()+"/rest/table-filter/1.0/service/insert",dataType:"json",data:{pageId:t.getPageId(),pageVersion:n('meta[name="page-version"]').attr("content"),macroName:i,containerType:a,container:r,number:o,tableNumber:l},success:function(){location.reload()},error:function(e){var a=-1!==e.responseText.indexOf("com.atlassian.confluence.api.service.exceptions.ReadOnlyException"),r=n('<div id="tfac-inserter-message"></div>');t.content.append(r),AJS.messages.error(r,{body:a?"This Confluence site is temporarily in the read-only mode. You cannot make any changes right now.":"Oops! It seems that the macro cannot be added. Please edit the page and add this macro",closeable:!0}),setTimeout((function(){r.remove()}),5e3),t.panel.removeClass("disabled")}})}}))},removePanel:function(){var e=r;clearTimeout(e.timer),e.timer=setTimeout((function(){e.activeTable=null,e.panel&&e.panel.fadeOut(50,(function(){e.panel.remove(),e.panel=null}))}),300)},setMacroUsage:function(e,t,a){e.some((function(e){if(t.hasClass(e.class))return a.macros.filter((function(t){return t.name===e.name}))[0].present=!0,a.owner={name:e.name,node:t,class:e.class},!0}))},filterTEI:function(e){return e.filter((function(){return 0===n(this).parents('[data-macro-name="table-excerpt-include"]').length}))},getPageId:function(){return AJS.params.contentId||AJS.Meta.get("content-id")||AJS.params.pageId||AJS.Meta.get("page-id")}},AJS.toInit((function(){n("#editPageLink").length&&r.init()}));a(78)}});
}catch(e){WRMCB(e)};